<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--  -->
	<meta property="og:site_name" content="Meu Pix">
	<meta property="article:author" content="@DaviMaTaeus">
  <meta property="og:description" content="Acesse o link para copiar o qr ou chave pix e pague pelo seu banco.">
  <meta property="og:image" content="pagamentos.files/imagens/metaTag.png">
  <meta property="og:locale" content="pt_BR">
  <meta property="og:type" content="website">
  <meta name="robots" content="index, follow">
  <!-- Meta Tags do PWA -->
<meta name="theme-color" content="#ffa200e0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Meu Pix">
<meta name="mobile-web-app-capable" content="yes">
<!-- Link do Manifesto (Ser√° preenchido dinamicamente pelo JS) -->
<link rel="manifest" id="dynamic-manifest">
<!--  -->

  <link href="pagamentos.files/imagens/favicon.png" rel="shortcut icon" type="image/png">
	<script src="pagamentos.files/script/jquery.min.js"></script>
	<script src="pagamentos.files/script/qr-code-styling.js"></script> 
	<script src="pagamentos.files/script/html2canvas.min.js"></script>
  <script src="pagamentos.files/script/clipboard.min.js"></script>
	
	<title>Meu Pix - Gerador de Pix de c√≥digo aberto</title>
	
<style>
/* =================================================================== */
/* --- 1. CONFIGURA√á√ïES GLOBAIS, VARI√ÅVEIS E FUNDO --- */
/* =================================================================== */
:root {
    --cor-primaria: #ffa000;
    --cor-secundaria: #05a581;
    --cor-destaque: #0081ff;
    --cor-erro: #ff0000;
    --fundo-vidro-escuro: rgba(10, 10, 10, 0.65);
    --fundo-vidro-claro: rgba(255, 255, 255, 0.1);
    --sombra-padrao: 0 4px 20px rgba(0, 0, 0, 0.5);
    --blur-padrao: 10px;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html, body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    color: #fff;
    background-image: url(pagamentos.files/imagens/capa-pix.png);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    min-height: 100vh;
    width: 100%;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    padding: 5px;
}

h1, h2, h3 {
    text-align: center;
    font-weight: bold;
}

h1 { font-size: 1.8rem; margin-bottom: 20px; }
h2 { font-size: 1.5rem; margin-bottom: 15px; }

.dados {
    text-align: center;
    color: #fff;
    width: 500px;
    margin-bottom: 20px;
    margin-right: 10px;
    margin-left: 10px;
}

.hidden {
      display: none;
}
.CarrengandoQR{
    animation: spin 2s ease-in-out infinite;
    width: 9.5rem;
	max-width: 100%; /* Garante que a imagem n√£o ultrapasse a largura da div pai */
    height: auto; /* Mant√©m a propor√ß√£o da imagem */
}
.loading-img {
    text-align: center;
    margin-bottom: 0.7rem;
    display: flex;
    justify-content: space-evenly;
    align-content: stretch;
    flex-wrap: nowrap;
    flex-direction: row;
    align-items: stretch;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.hidden { display: none; }

/* Anima√ß√£o de Carregamento */
.loading-img { display: flex; justify-content: center; }
.CarrengandoQR{ animation: spin 2s linear infinite; width: 9rem; height: auto; }
@keyframes spin { 100% { transform: rotate(360deg); } }

/* =================================================================== */
/* --- 2. CONT√äINERES PRINCIPAIS (FORMUL√ÅRIO, LINKS) --- */
/* =================================================================== */
.dados, .qrcriado {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.caixatex, 
#minhavenda, 
#links-container {
    background: var(--fundo-vidro-escuro);
    padding: 20px;
    border-radius: 15px;
    box-shadow: var(--sombra-padrao);
    backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid var(--cor-primaria);
    max-width: 600px;
    width: 100%;
}
ul {
    list-style-type: none;
    padding: 0;
}

/* =================================================================== */
/* --- 3. MODAIS E OVERLAYS --- */
/* =================================================================== */
.modal, .modal-salva, #modal-editar, .modal-vendas, .modalagendamento {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 15px;
    backdrop-filter: blur(5px);
    overflow: auto;
    padding-top: 163px;
}

.modal-content, .modal-content-salva, .modal-content-editar, .modal-contentvenda {
    padding: 30px 25px;
    border-radius: 15px;
    width: 100%;
    max-width: 450px;
    border-left: 3px solid var(--cor-primaria);
    box-shadow: var(--sombra-padrao);
    background: var(--fundo-vidro-escuro);
    backdrop-filter: blur(10px);
    position: relative;
    display: inline-block;
    text-align: center;
}

.close-button, .modalagendamento-close-button {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 35px;
    font-weight: bold;
    color: rgba(255, 255, 255, 0.7);
    cursor: pointer;
    line-height: 1;
    transition: all 0.2s;
}
.close-button:hover, .modalagendamento-close-button:hover {
    color: #fff;
    transform: scale(1.1);
}

/* Estilo para o container do QR Code no modal de pr√©-visualiza√ß√£o */
#qr-code-preview {
    margin: 20px auto;
}

/* =================================================================== */
/* --- 4. FORMUL√ÅRIOS E INPUTS --- */
/* =================================================================== */
.floating-label, .floating-placa, .floating-label-clienteNome {
    position: relative;
    margin-bottom: 25px;
}

.floating-label input, .floating-placa input, .floating-label-clienteNome input{
    width: 100%;
    padding: 12px 10px;
    border: none;
    border-bottom: 2px solid var(--cor-primaria);
    background-color: transparent;
    color: #fff;
    font-size: 16px;
    transition: all 0.3s ease;
}

.floating-label label, .floating-placa label, .floating-label-clienteNome label {
    position: absolute;
    left: 10px;
    top: -20px;
    color: #ff6000;
    pointer-events: none;
    transition: all 0.3s ease;
    font-size: 11px;
    font-family: sans-serif;
}

.infor { font-style: italic; font-size: 12px; color: rgb(255, 0, 0); }

/* =================================================================== */
/* --- 5. BOT√ïES --- */
/* =================================================================== */
@keyframes glowing {
    0% { background-position: 0 0; }
    50% { background-position: 400% 0; }
    100% { background-position: 0 0; }
}

/* Bot√£o principal */
.cliqueBtn, .Btnvendas {
    display: block; width: 100%;
    padding: 14px 20px; margin-bottom: 15px;
    font-size: 18px; font-weight: bold; color: #fff;
    background: linear-gradient(45deg, var(--cor-primaria), #ff5d00);
    border: none; border-radius: 10px; cursor: pointer;
    position: relative; z-index: 1; overflow: hidden;
    transition: all 0.3s ease; text-transform: uppercase;
}
.cliqueBtn:last-of-type, .Btnvendas:last-of-type { margin-bottom: 17; }
.cliqueBtn:hover, .Btnvendas:hover {
    box-shadow: 0 0 15px var(--cor-secundaria), 0 0 25px var(--cor-secundaria);
    transform: translateY(-2px);
}
.cliqueBtn:before, .Btnvendas:before {
    content: ''; background: linear-gradient(45deg, var(--cor-secundaria), #206958, var(--cor-secundaria));
    position: absolute; top: -2px; left: -2px;
    background-size: 400%; z-index: -1;
    width: calc(100% + 4px); height: calc(100% + 4px);
    animation: glowing 20s linear infinite;
    opacity: 0; transition: opacity .4s ease-in-out; border-radius: 10px;
}
.cliqueBtn:hover:before, .Btnvendas:hover:before { opacity: 1; }

/* Bot√µes de A√ß√£o */
.open-link, .share-link, .delete-link, .confirm-payment, .atualizar-produto, .edit-product, .modalConfirm, .cancelar-editar, .cancel-products, .botao-compartilhar-vendas, .modal-btn {
    font-size: 14px;
    font-weight: bold;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    margin-right: 5px;
}

.open-link, .share-link, .confirm-payment, .atualizar-produto, .edit-product, .modalConfirm, .botao-compartilhar-vendas { background: linear-gradient(45deg, var(--cor-destaque), #4800ff); }
.open-link:hover, .share-link:hover, .confirm-payment:hover, .atualizar-produto:hover, .edit-product:hover, .modalConfirm:hover, .botao-compartilhar-vendas:hover {
    background: linear-gradient(45deg, var(--cor-secundaria), #206958);
    transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.delete-link, .cancelar-editar, .cancel-products, .modal-btn { background: linear-gradient(45deg, var(--cor-erro), #c00000); }
.delete-link:hover, .cancelar-editar:hover, .cancel-products:hover, .modal-btn:hover {
    transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.aba {
  margin-bottom: 28px;
  animation: fadeIn .25s ease;
}

.titulo-aba {
  font-size: 1.2rem;
  font-weight: 700;
  margin-bottom: 12px;
  color: var(--accent-2);
  text-shadow: 0 1px 4px rgba(0,0,0,0.25);
}

.botoes-navegacao {
  display: flex;
  justify-content: center;
  gap: 14px;
  margin: 20px 0;
}

.botoes-navegacao button {
  padding: 10px 18px;
  border-radius: var(--radius);
  border: none;
  font-weight: 600;
  cursor: pointer;
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(110,231,183,0.06));
  color: var(--accent-2);
  transition: transform .1s ease, background .2s ease;
}

.botoes-navegacao button:hover {
  transform: translateY(-3px);
  background: linear-gradient(135deg, rgba(96,165,250,0.2), rgba(110,231,183,0.1));
}

.sem-links {
  text-align: center;
  padding: 20px;
  color: var(--muted);
  font-style: italic;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(5px); }
  to   { opacity: 1; transform: translateY(0); }
}


.botoes-navegacao { display: flex; justify-content: center; margin-top: 20px; gap: 10px; }
.botoes-navegacao button { background: var(--cor-secundaria); border: none; color: #fff; padding: 8px 16px; border-radius: 8px; cursor: pointer; }

/* =================================================================== */
/* --- 7. TELA DE PAGAMENTO (QR CRIADO) --- */
/* =================================================================== */
.container-principal {
    display: flex;
    flex-direction: column;
    max-width: 1000px;
    width: 100%;
    gap: 2rem;
}

.secao-esquerda { text-align: center; }
.secao-direita { width: 100%; }

.botao-voltar-mobile {
    padding: 1rem;
}

.botao-voltar-desktop {
    margin-bottom: 2rem;
}

@media (min-width: 768px) {
    .botao-voltar-mobile { display: none; }
}
@media (max-width: 767px) {
    .botao-voltar-desktop { display: none; }
}

.titulo-principal {
    font-size: 1.8rem;
    line-height: 1.3;
    background: var(--fundo-vidro-escuro);
    padding: 25px;
    border-radius: 15px;
    box-shadow: var(--sombra-padrao);
    backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid #05a581;
    text-align: center;
}

#qr-data {
    background: var(--fundo-vidro-escuro);
    padding: 25px;
    border-radius: 15px;
    box-shadow: var(--sombra-padrao);
    backdrop-filter: blur(var(--blur-padrao));
    -webkit-backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid var(--cor-secundaria);
    text-align: center;
}

/* Estilo para o container do QR Code */
#qr-code, #qr-minha-venda, #qr-code-preview  {
    display: flex;
    justify-content: center;
    align-items: center;
    /* background: linear-gradient(243deg, #ff75004a, #ff76007a); */
    /* box-shadow: 0 0 15px #ff7100c2; */
    border-radius: 8px;
    padding: 6px;
    margin: 0 auto;
}
#qr-minha-venda {
	margin: 1rem auto;
}

.instrucao { color: rgba(255, 255, 255, 0.8); margin: 10px 0 20px 0; }

.detalhes-pix { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.2); }
.info-linha { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(244, 245, 247, 0.1); }
.info-linha:last-child { border-bottom: none; }
.info-label { font-weight: bold; }
.info-valor { color: rgba(255, 255, 255, 0.8); }

.copy-icon-chave { background: var(--cor-secundaria); padding: 6px 12px; border-radius: 8px; cursor: pointer; transition: background 0.3s; }
.copy-icon-chave:hover { background: #048b6d; }

.copy-button, .comprovante-button {
    width: 100%;
    margin-top: 20px;
    padding: 14px;
    border-radius: 10px;
    background: var(--cor-secundaria);
    font-weight: bold;
    border: none;
    color: #fff;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
}
.logo-what { width: 20px; height: 20px; }

.botao-voltar-mobile {
font-size: 16px;
background: linear-gradient(231deg, #ffa200e0, #ff5d00e0);
    box-shadow: 0 0 15px #ff6700;
    transform: skewX(0deg);
    border: none;
    border-radius: 15px;
    cursor: pointer;
    min-height: 56px;
    display: flex;
    width: 50px;
    justify-content: center;
    position: absolute;
    left: 20px;
}

.botao-voltar-desktop {
    background: linear-gradient(231deg, #ffa200e0, #ff5d00e0);
    box-shadow: 0 0 15px #ff6700;
    transform: skewX(0deg);
    border: none;
    border-radius: 15px;
    cursor: pointer;
    min-height: 56px;
    display: flex;
    width: 56px;
    justify-content: center;
    align-items: center;
}

/* =================================================================== */
/* --- 8. MODAL DE COMPARTILHAMENTO --- */
/* =================================================================== */

.show-share .StickyBox {
    opacity: 1;
    visibility: visible;
    transform: translate3d(0,0,0);
}
#compartilhar {
display: none;
}

.StickyBoxsfa {
    display: flex; align-items: center; justify-content: center;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    opacity: 0; visibility: hidden;
    transition: opacity 0.3s ease;
}
.StickyBox {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transform: translate3d(0, 72%, 0);
    transition: all .2s ease;
    z-index: 15151515;
}

#compartilhar .StickyBox {
    opacity: 1;
    visibility: visible;
}

.StickyDemo {
    width: 98%;
    max-width: 394px;
    padding: 15px;
    border-radius: 15px;
    background: rgba(32, 105, 88, 0.85);
    box-shadow: var(--sombra-padrao);
    border-left: 3px solid var(--cor-primaria);
    backdrop-filter: blur(10px);
    transition: transform 0.3s ease;
}

#compartilhar .StickyDemo {
    transform: scale(1);
}

.StickyTab {
    align-items: center;
    padding-bottom: 15px;
}

.share-wrapper-icons {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
    gap: 10px; list-style: none; margin-bottom: 20px;
}

.share-wrapper-icons li a {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 10px 5px; font-size: 12px; color: #fff;
    background: var(--fundo-vidro-claro); border-radius: 8px;
    transition: background 0.3s; height: 100%;
}
.share-wrapper-icons li a:hover { background: rgba(255,255,255,0.3); }
.share-wrapper-icons a:before { content: ''; width: 24px; height: 24px; margin-bottom: 5px; background-size: contain; background-repeat: no-repeat; background-position: center; }

.copy-section { max-height: 30vh; overflow-y: auto; }
.copy-section .title { font-weight: bold; margin: 15px 0 5px 0; text-align: left; }
.copy-post input {
    width: 100%; padding: 10px;
    background: var(--fundo-vidro-claro); border: 1px solid rgba(255, 160, 0, 0.4);
    border-radius: 8px; color: #fff; font-size: 14px;
}

/* =================================================================== */
/* --- 9. RODAP√â --- */
/* =================================================================== */

.rodape {
    width: 100%;
    max-width: 1000px;
    margin-top: 30px;
    padding: 20px;
    text-align: center;
    background: var(--fundo-vidro-escuro);
    border-radius: 15px;
    box-shadow: var(--sombra-padrao);
    backdrop-filter: blur(var(--blur-padrao));
    -webkit-backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid var(--cor-primaria);
    color: #fff; /* Garante que o texto dentro do rodap√© seja branco */
}

.rodape-div {
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 15px;
}

.rodape-div > div {
    min-width: 150px;
    text-align: center;
}

.rodape span { font-weight: bold; font-size: 1.1rem; display: block; margin-bottom: 5px; } /* Adicionado display: block e margin-bottom */
.rodape p { font-size: 0.9rem; line-height: 1.4; } /* Estilo para par√°grafos no rodap√© */
.rodape-direitos { margin-top: 15px; font-size: 0.9rem; opacity: 0.8; color: rgba(255, 255, 255, 0.8); } /* Corrigido para usar rgba para consist√™ncia */

/* Estilos espec√≠ficos para as divs dentro de rodape-div, se necess√°rio */
.rodape-div-1 img {
    max-width: 130px; /* Garante que a imagem n√£o exceda o tamanho */
    height: auto;
}

.rodape-div-2 a,
.rodape-div-3 a {
    color: #fff; /* Cor do link */
    text-decoration: none; /* Remove sublinhado padr√£o */
    transition: color 0.3s ease;
}

.rodape-div-2 a:hover,
.rodape-div-3 a:hover {
    color: var(--cor-primaria); /* Muda a cor ao passar o mouse */
}

/* Estilo para o bloco de aten√ß√£o */
.rodape > div:nth-of-type(2) { /* Seleciona a segunda div diretamente sob .rodape */
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid rgba(255, 255, 255, 0.1); /* Linha divis√≥ria sutil */
}

/* =================================================================== */
/* --- 10. RESPONSIVIDADE E AJUSTES FINAIS --- */
/* =================================================================== */
@media (min-width: 768px) {
    .container-principal {
        flex-direction: row;
        align-items: flex-start;
    }
    .secao-esquerda { width: 45%; text-align: left; }
    .secao-direita { width: 55%; }
    .botao-voltar-mobile { display: none; }
}
@media (max-width: 767px) {
    .botao-voltar-desktop { display: none; }
}

/* √çcones de compartilhamento */
.share-wrapper-icons .twitter a:before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="white"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>'); }
.share-wrapper-icons .telegram a:before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" fill="white"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142.3 89.4-61.2-19.1c-13.3-4.2-13.5-13.3 2.8-19.7l239.1-92.2c11.1-4.2 20.8 2.7 17.2 15.1z"/></svg>'); }
.share-wrapper-icons .whatsapp a:before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="white"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.8 0-67.6-9.5-97.8-26.7l-7-4.1-72.5 19.1 19.4-71.3-4.5-7.4c-18.5-30.7-29.9-66.5-29.9-103.3 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>'); }
.share-wrapper-icons .facebook-f a:before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="white"><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"/></svg>'); }
.share-wrapper-icons .email a:before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="white"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>'); }
.logoencurtador { content: url(https://www.encurtador.dev/assets/icons/icon-144x144.png); }
.Compartilhamentos {
    content: url(pagamentos.files/imagens/Compartilhamentos.png);
    display: block;
    width: 20px;
    height: 20px;
    margin: 6px auto;
    text-align: center;
    cursor: pointer;
}
.logois { content: url(https://is.gd/isgd_favicon.ico); }

#valordopagamentos {
    font-size: 0.7em;
    font-weight: bold;
    color: #fff;
    margin: 20px auto;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
}

.keypad {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin: 20px 0;
}
.keypad-button {
  padding: 20px;
    font-size: 1.5em;
    background: linear-gradient(47deg, #ffa200e0, #ff5d00e0);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    color: #fff;
}

.keypad-button.backspace, .c, .Limpar {
  background: linear-gradient(50deg, #560000, #ff0000, #4b0000);
  box-shadow: 0 0 8px #c00000;
}

.keypad-button:hover {
  background: linear-gradient(47deg, #206958, #05a581, #206958);
  box-shadow: 0 0 9px #05a581;
}


.keypad-button.enter { background: linear-gradient(47deg, #206958, #05a581, #206958); grid-column: span 2; color: white; }
.botao-comprovante-mobile, .botao-pedido-mobile {
    width: 100%;
    padding: 0 1rem;
    box-sizing: border-box;
}

.botao-comprovante-desktop, .botao-pedido-desktop {
    width: 100%;
    margin-top: 1rem;
}


@media (min-width: 768px) {
    .botao-comprovante-mobile, .botao-pedido-mobile { display: none; }
}

@media (max-width: 767px) {
    .botao-comprovante-desktop, .botao-pedido-desktop { display: none; }
}
.svg-container {
    width: 38.5px;
}
	/* botao whatsapp */
	
.whatswidget-widget-wrapper {
            font-family: "Helvetica Neue","Apple Color Emoji",Helvetica,Arial,sans-serif !important;
            font-size: 16px !important;
            position: fixed !important;
            bottom: 20px !important;
            right: 30px !important;
            z-index: 1001 !important
        }

        .whatswidget-conversation {
            background-color: #e4dcd4 !important;
            background-image: url('data:image/png !important;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAYAAABUfC3PAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAhHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAAiZdY5dDoQwCITfOcUeYQqUluOYrCbewOM7tW6MD/slwPAbZD32TT6DAojX1iMjQDw9daHomBhQFGVE+skdrVApxXfmYjpFZG/wZ9DxpiJ6bM1pXDHV1YJmV5M3BOOFfA5E/X3zp34jJ5txK0wLhZMZAAABd2lUWHRYTUw6Y29tLmFkb2JlLnhtcAABAFVURi04AFhNTDpjb20uYWRvYmUueG1wAEiJ7ZaxTsMwFEX3foVl5thJKEOsuB1aUBkKCJBaxjR5Taw2TpQYYvprDHwSv4DdVi2qyojEYE+27/U99vPy4qGuk3QFCi0gF5Ljr49PjETG8exq6k/rERRismngaXP3nG5WaZTh4aAXa6bLugSVIF2uZcs0x0lWLYCZud2mGG0tasXxfPqARlUDqE/6xPeutXgL8aCH4iZbssfxzT7CrDgulKoZpV3Xke6SVE1OgyiKqB/SMPSMw2vfpUq0J9sLG7HLGEObNqJWopLIrpNF9ao4xkZH+3DQ4pguW7K9LEmrklqFBsSnP+1KLH+xW+Vot4fZg9Cwno9FCbI1V+A48IMT9eWMapPYbZnkMBOZKs4JExB5oU6U+0aAqYHahWFqK0n3pTQ/Qw9fM9g+6K+HgziIgziIgziIg/wrSC8+NHcgTUfXmdbtG8Nkm7OA2X6LAAATK0lEQVR4nO1d25bjOI4MgKSy5/+/bR/3cf+hLJLAPoCgaFu2JaeU6dptnFNTPVlpWSJIXAIBiP7nv/9L8a98lPBv38C/ci/xt2/g/5qICGoVqAoUAAEAEQIzmBlE9PIaEQBUFaUUiAhU7VIhMEIIYP73MG0VEUHOpa+lCxEhhICUIkIILxUTRQSlVtRSoAoQAQqFFoGoIsX4r2I2iIjgcrlARMGB8fU1gYigqqhVUGpBzhmqipTS02vFWivmeQYTI8YA5gBVQc4ZJWcQgJgSeMOx+/8qtvAVtQpCDJhSujJVzAIiIJeCXApCiGB+vJ6xioCIME0JIYT2Y7tg6RcJQP+33xMzrcvfIAIBm+z0mSIi8HWMMQ7raMLMSCmZ4sT8DfB4PSNUV51QjBEiipzLsgi/JKoKVYWIQETb/SiICMy8yU6fen/tf0IIDy2K36vq8jyP7rlFXw8e6Beec1l8U4CIQFTa7RCIlpNRRaClYEoJMcbfU8xycF8IbVrTqABqLUh6HR3XWiG12oOe/LBdCarQHgGi7yo3UUQMZuqLTyIopaDUCmJGbGajnyy7QA9N3RocrTxfIhnu/VbsngR4ckJcYuCAWgrmeUZskZaIopQMEUVK8VQnX6ugVgsjq0hfPOaAEPlpfC/NjpdSUUtFYIYCkGa7pdoiKRTUwnx/xiMVw+0ecylgEYSmGP8Oj8BEbHvQi++PIYTuP0qpIJa+y7g9xFlmQUQwzxdUEcQQkG6iltu/b2Wx0xk5C6pUO2kAePA3AEFUuuJTjC/D0j3ieUhgRikFKnK1brVaNEtESCm+tGAxBAbxF2opzWQJiAkpphYin5OjdN+hauF4SggPdpD/rjaPquq70xY+xtSTNWrOlm9OmCqDMEaUz8PSvWILnlriqMil9MVXBYgJMUSE8HqTR8B2Fd2EcmfY3luRZl8Dh+4PgMUnjH+ulaJgDogxIISAaUrdnrsy/DrtYcBAM812osz0HWfGPBwmIpS2ud2bERNS2JbNAwP29RNKuBVueYZicY6OHdXaTm5THFOzxe0TpRYA2h803ChVVFFLBYAOGdnvcVNyvQoajpIOTd1ax/asW+RHAclx15sjrhBRxGYhO3ZUS0MYYo+4/KEMp1OgnQyHhkYppZpth0VzVQImLAtGbN/vDvlo+a6iY875UKfncm9+WkjY/81sre/irqxqpiWmiBBGn2C7X8TOFXNb4JXnr9UUm2JEBZliqnTTxi1i0w/FyONZCjEsqF4ngApwsDDXAowl5HVFgVo+wWSfVYuoPCiw0HbxJ6vfD/TfQwMFPcPzfEc0fwupGD/73ZNxex+H7xUvAzg845A1tR0KXPuv8e8QGCIW75dc7BT00DZ2HzD+WZMYAkQEfy4XQLXjUQtA6KdPnsIdj8RyjtpN5xJ6718rQ5dnix7btU5RSs4ZCsPPQlxC1Fdi4W28UpT/2ZPwhWA+pFbp/3/8fg8cXmFQa8/mfk9UwEQtpLdTHeM+DM6ulaGwnJDazw5VyujEU0qYprR7F4Zwb5ZG3zTKo9PivuORZTYlB6jaImzNxXzD1ZbLETOoVguBRa984BaptSKXgilNSMlUcbnMxyulVjGfcQCUMTr/6rhS04v5ptB9095v4sCQDn1sv59S6lXNRGPCPF8scHjDR1G7Fy+IHW6+HGf6LrbkgUJukIUleeiL76cml4yczWfEHRVSajXzWmpHoHfcXQ8W7G/0YGKvTohtQ+WcIc3UllJOyFP6jb2nlK6QXCBiKLVHbI5Ya0OT/QRZToLNpeuOmWFBpbdsom72xMq7QbmfZmLaDaYHZqQYkRvEZQo+I3kkQGUJQffKGLmlVidZXegGpFYR5HlGyQUqimlKmxUDGNSzRykxRtvZ8wwJEbUaavAOl8ErkhaiG0KejjZfFtUwsr5nX23Xm0n5mr5eRjNuhmiamgMuqHVbzcTvte/0jZ9JyaJDD4ktMHm/+mmKDlBloBXxDlUKM4ODQmfd5UCBJb/x3OZWIZ6IjmVg910hhJ7t51L6jt5yv9LAya15hi+iCENVdofrj655VYp/+0oPxBLEJYTdngMAtS2oHekBXhFBdi5Vy9hiiIgR3WQEZmgMmOcMCductyEJ0hHmrfdqG4FwFsH0lKsSM1wxW0W1wSjEVzB+bZl5rVZZjNGSj5wz5pakAkNWTeYnZMN3O9A5Euc+QQ5Xitt5AJsftp+qVnsYfy61QsXCXnP8liMQkeUZ9ZqJ2EvXm5RipYCeA32InIKTMjOqLPD4FrOgaLZ1/Jln8WR4lpsqZm6FpNrwq8Em9xrNaxlt+TtK6cU3YCB3fL9Gc55SquwyC21pVv/ltjykjvuvie4LxokAJu6BwtYSsWf3peSOXluIe0/G2yurShm5V3bjtDnku0rM6r7d5zmDi9fhnUbrztihF6xEPk8V9ux+RaD8nLk4SikFl3nupWyFJb3IltnH+L5iHiol59wKSkZs2BP2mRkiCLZFNeORv03mmBlhYGsaRmTQy+1GWcwdbaZFEZkfu90Qz8RNM4Be1xGxzSCiqFIRNyp3TVYdvcPTzhapYgWrrTdtu4/6rt7yOc873Cz4Z5gZU0pWW4c2rMqSuBGF9u4BwMzR3g2EHdiVVAvNY0O0uRXtrOwA6DejuYc+ZYHL33OCxAxuJnDrKUsxImdrGXAY3E2nK6xd3QDKm+SyNDI6h31BpZ0+YKs3IrLfVNGrT4hqD1i+I6tKuc2IA+/nfzERZMdJscWPPVGc53zlNB9FNYYWL70fcYo9JN8qZi6xmZ7bGZE1I88zKoeOSDDTOY6e2ZpeHGy7JbZtEV8EWuvmaIiZzH9ooxCZVRmoQHZCXMkejHSFhIi4E4NyHlgYytWv79MSXGkkD4eUFIoQToq+Op7DDCjuTMXWGydiiJRd0VBsDMe5Ib+llMYsdJIdNWhEG2ulgsn8zgjPbBH3Q1KlF622SggBX19fKNWIHSDCV5gO4Sk/9Ck9kXvz+u7szTnv80nMjGmawMESRFGBFK88GhRjXQXUggDrQNtTa3f6qqoipvdI38yMRNRP7jsV0DU5lfnkkY02mtGenegPLC0R9VYCL5laKLtQlNZkjf7q/DEvbgUO3+rrPCKDv5XT6WgeNYnqbqDNI68tNnoMJrRFQeqNRypX/+2csKkFEp/WaHv6SeHG3VWRU/omR/ShE/+GiI/YilnEjBQWpr7f39G7/Ag5XSnWs/FeJXKUkfp6a4K64zMkHiF4FY+aUq75Y58sqvpT5qtsBiddeW6C4H6gK8R5xctpMH7wcgrOaqM7W6SVw8939L0O7rXwdVL2NRncsCUdzJJTOv1PbAnt7c7/2xTh4vDSPB9MxlsTIiDEgFoq/lwuHS8CMDSfujNui0+t9aEt/lKnuK9Z/KYSPLQ+YnxKzhm5FMQYfkIphBStz8+agYwA4Zn5YqZwZfe50UK38pDfkR4MvKHYI8enjF0KMfyAUoCFYF0777a1RQz9Itwy+Z/a+R6ledi9R3wRjxyf4ozLWg8meD//Ulo91r9hhqwreUYp1YbbTNMuxYxjP44Yn7Jcx9pAfrSX6RMiIkehnbL0DrzicM+R41PGiPFDG8xeyzudVEtDU4aKVVQXoHPHdy/fvP4L38ALY4x/r1IsxG7U0fjaH6kqSq1Gi+0Th7ZBOLfCRCg4b3zKX6wUZ+YLKBucY+H2/dACV8g8zyAYu7LWuhlXuxVm6405a3zKX6sUz1s81wmykLVvM3rvyweWfkfR9znAHrScNT7ldKUc2UU7ipervXvMWzDmmjsHixt91nofFdPXV+stqYjhe2MYzxyfcqWU62hhfxPMrYwJlvdiHJkIevVvzhm1VCi0U1rHzir3HSEEXEqjwX59f3DbWeNTrpRy1E52slwptU8WoqaMaZoO+x43IxOADPSxITEEBDJGPYArM2U/012Vylf3sOc6W4iOq+ZrzHb34Exj24JjQgabhEbwK6szFr8rfj0FUEsFEyFMAYGuH895v2/HrAfIFqLjnVL8Q5d57vWQEKwf/lnHr8Jmosx5Rh3IDD5fJefcbua9hO2VhBDwRYQLZsu2c8Y0TVe/00eAQFo/5c/PnnSiY0oRCuqY17j575TipkdbxiqqkDyjlIUFeHvcnObjxayUkrFSBjzL297OFCJCDAE5l17Xv/1Op5jO84xpmjZ1fB0tr4iOd45+UYhNqvPopndTqSKp9pCvwxatgSfFtMo8N9R3/5SHvcJsTJeRu9g5xrBBOzGaKc3FwuSfnNa6heh4t00sfCTEFDqPammjzp0nBaAjv/NlBgiYUnriyKmPy3iHRLFVrPkIg2PX3tpNWJDpmGKHW76+vt+3uFW2EB3vzZdazB/4OsxzhJfbMBv3Od4xM02T1U0ePJihDk0VJzZNuX32KXhzzpDWNkFE0Fyag/X5LNa+103uyTX8LUTHVUc/subHi40Fq8s8tz5Ea3fbVNTZ2mL1pkiDU6wVG9aUqrL0Q4IgLH34Zy9TazUWZ0o/MkL+FdHx3ssN5JA18UlDc26Zc+BDc493xfojWw8km0+ppSJN6Y6SuuRRBUpGGPTZxp8wQv6t0MPqCYbOprh3UtH70yieiS+0BR8VBMY0pVUUwW14jHGYi2wn7BNkt1KW5ktFCnFfG5kuielaE1K3t+/WzIfClc8efmRSe04QQ29f+BRe2L1Smt1/FLr6NFSLGvaFkgrt8+mNQnSjlMZm3DtWY6El1X4C9uBsa1Sl35Q7pRAaU/7BaAznb1kSuf1BeudTq/6N0A3B/KxW7TnSP/987VMM0IZOR6tlfNAi75V7pTAB8qQjuo3NmDgtIe4G6bUOYpthf1WMsuOpqhYxiTz8/jUhspaIOMyZ/GR5RW26U0pgRtXaEdbbi0nPjNeZjg9vpBHWUkp9J6/dVBWB5v3BgJmgXR/5FdlCbbp6DGr8KzwYjeEDa/bOiF9uBC9fFtaBuQ/f7e+IU5v+/Ln0PG9N7vZWaCdgrYG0sxl3LlhpmFncEj57gLHrGz5fRmpTldoZoWtypxRrHzAIoLMZm+yd5qCKzoqk1vv+ygGb4hVHvhzgSBmJ6Hs+s4fatKqUwDZBuw7vK/Rb2GPpVWVAYl8PVO5vdmgwzyeKESVspOKW6UfvUJsetmwvdYnacSP0dzJsuPlG7a+lIA1zd5/efBvQeXRl8kj5CWrTQ6WEEHvNgdoojj6O/EUDkKrasM1+A69N0agU/oXC01b5CWrTwz56Nze1VpSceynYmoDW2+X85mzkko10jfF1Zt1HlUubH/nLrwh8Jj9BbXr4r0RtsihTf6eUAn1y3W10NhbC5mxFr9QG3bykkzYn6Pb2t7LxrU7cqU0xxY6ATG2M/IhyxNh+r5WgdeM8/KfDDRYGeUbOdgx9IEwptdcpxqqkansTRCOlvVLIPM+dof5bNXPAp7kakjAClGtyNrXp6Qr4aQEBZVh08/QVpdjggVKWofw2ASI+PSF+qkqtKE3ZaXqtxLXrOGj6rrmz10QZdO+lwFIVUaQ/xyM5i9r0clv6vC0CIZfcXwDGiA1+lx4aRjT4hKl39o7ii+hvnfYy7SuY/VZUtTeqemvbO0N9AHsnpJvm0HZxlTZFHEAI09PPn0Ft2mQrun8hYFbY1J/A/dj6q/RqrfhzMXT5tqFmrKP41B9/u8JemN59kDTmpYi9J3La2ZEFtCl3VfCf//wzNMgG/PlzsRetPddJX58jqU2bDbjTiYxUwcu4vhA7QlvqQnZ2XGfJbKgPuYkprCpui3jsT0RI0zQMT5A2b2v79TpCQUvPIYA+37iz6Ddc70hq02aluMmw92qFvgALedocZG0EPq+duBChdfsuRax3RUXAYRl0owBKXt4FuVXHnZYLtAKZ3agDr0TbpxIdSW3aFeqISI/FFzhk8QPvNuHsFaM26QIBtfI00/5OAaf7lBYBElF7PyTtenPQkdSmzUrxNmvwEkMQ/XwZ1UP1ec4o5dLeGFTBIfSR63skhICvaTL0tr2s03hsafMGO5ratEkpyxACvRrcfEQvxl7xHCElbaaBwJE3wzmPrgcspQkDZcMmUPQMatPuTI2w2OHfEm9Aiuovd/7e5rjl9+6RM6hN+5XSaZa/i039xildkzOoTXHvGEEMi3E2g/7T5SxqE/t7C18K3fsSHSKgv0k6oXAPZebRtWDUppEQ8l2Jc0Nnn8EJRHQ3PMAnqeZcProodSs+FKG2iO3RYFBto5WeWYGzqE1sOcfrF9B0Gz4UdLR1cP0tYq2Dc39z0Xy52NuKVjC6xXc+F0+gj+xv4e0FXvTsuSsF6+1hnyoLKmGTtlXtZQK3daHf9pGsGxUCoM+Qr7V1DrfXNf0tp8UQuPY209bu5xiXy28rBADYW+Ve3UwP2xptaKRe/i0+xTqdDSK6/LlAxd5zzB90/6qK6DyvLTvEWuwKSmkz4tvrvz9hd20VbyF3vxFC+Cjin5UBWn/8M3GsRtHajBuUICrg8LvMk2WCg/Zi17PE8tPaHkZx6xOf9Sr25KhaxayPsQVdzQX+LXF4fJ5zhzpSirvfDvEJcplnKyeHgP8FbJ3FbCth4+oAAAAASUVORK5CYII=') !important;
            background-repeat: repeat !important;
            box-shadow: rgba(0, 0, 0, 0.16) 0px 5px 40px !important;
            width: 250px !important;
            height: 300px !important;
            border-radius: 10px !important;
            transition-duration: 0.5s !important;
            margin-bottom: 80px !important
        }

        .whatswidget-conversation-header {
            background-color: #23b123 !important;
            padding: 10px !important;
            padding-left: 25px !important;
            box-shadow: 0px 1px #00000029 !important;
            font-weight: 600 !important;
            border-top-left-radius: 10px !important;
            border-top-right-radius: 10px !important
        }

        .whatswidget-conversation-message {
            line-height: 1.2em !important;
            background-color: #23b123 !important;
            padding: 10px !important;
            margin: 10px !important;
            margin-left: 15px !important;
            border-radius: 5px !important
        }

        .whatswidget-conversation-message-outer {
            background-color: #FFF !important;
            padding: 10px !important;
            margin: 10px !important;
            margin-left: 0px !important;
            border-radius: 5px !important;
            box-shadow: rgba(0, 0, 0, 0.342) 0px 2.5px 10px !important;
            cursor: pointer !important;
            animation: nudge 2s linear infinite !important;
            margin-bottom: 70px !important
        }

        .whatswidget-text-header-outer {
            font-weight: bold !important;
            font-size: 90% !important
        }

        .whatswidget-text-message-outer {
            font-size: 90% !important
        }

        .whatswidget-conversation-cta {
            border-radius: 25px !important;
            width: 175px !important;
            font-size: 110% !important;
            padding: 10px !important;
            margin: 0 auto !important;
            text-align: center !important;
            background-color: #23b123 !important;
            color: white !important;
            font-weight: bold !important;
            box-shadow: rgba(0, 0, 0, 0.16) 0px 2.5px 10px !important;
            transition: 1s !important;
            position: absolute !important;
            top: 62% !important;
            left: 10% !important
        }

        .whatswidget-conversation-cta:hover {
            transform: scale(1.1) !important;
            filter: brightness(1.3) !important
        }

        .whatswidget-cta {
            text-decoration: none !important;
            color: white !important
        }

        .whatswidget-cta-desktop {
            display: none !important
        }

        .whatswidget-cta-mobile {
            display: inherit !important
        }

        @media (min-width: 48em) {
            .whatswidget-cta-desktop {
                display:inherit !important
            }

            .whatswidget-cta-mobile {
                display: none !important
            }
        }

        .whatswidget-button-wrapper {
            position: fixed !important;
            bottom: 15px !important;
            right: 15px !important
        }

        .whatswidget-button {
            position: relative !important;
            right: 0px !important;
            background-color: #31d831 !important;
            border-radius: 100% !important;
            width: 60px !important;
            height: 60px !important;
            box-shadow: 2px 1px #0d630d63 !important;
            transition: 1s !important
        }

        .whatswidget-icon {
            width: 42px !important;
            height: 42px !important;
            position: absolute !important;
            bottom: 10px !important;
            left: 10px !important;
        }

        .whatswidget-button:hover {
            filter: brightness(115%) !important;
            transform: rotate(15deg) scale(1.15) !important;
            cursor: pointer !important
        }

        @keyframes nudge {
            20%,100% {
                transform: translate(0,0)
            }

            0% {
                transform: translate(0,5px);
                transform: rotate(2deg)
            }

            10% {
                transform: translate(0,-5px);
                transform: rotate(-2deg)
            }
        }	
    .minhalogo {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
}
#valordopagamentos {
  font-family: 'Arial', sans-serif; 
  font-size: 1.2em; 
  font-weight: bold; 
  color: #27ae60; 
  text-align: center; 
  display: block; 
  margin: 20px auto; 
  letter-spacing: 1px; 
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1); 
  transition: color 0.3s ease-in-out;
}

#itemList {
    list-style-type: none;
    padding: 0;
    font-weight: 600;
}

#itemList li {
    padding: 10px;
    margin-bottom: 5px;
    border-radius: 5px;
    display: flex;
    align-items: center;
    gap: 10px;
    background: linear-gradient(339deg, #ff620073, #ff6f00a3);
    border-left: 2px solid #05a581;
}

#itemList li img {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    object-fit: cover;
    box-shadow: 0 2px 5px rgb(0 0 0 / 81%);
}

#itemList li span {
    font-weight: bold;
}

#container {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
}
/* Estilo base para todos os valores do pedido */
.valor-pedido {
  display: block;
  margin-top: 11px;
  font-size: 18px;
  font-weight: 600;
  letter-spacing: 0.5px;
}

/* Desconto */
.valor-desconto {
    color: #ff0013;
    background: rgb(29 53 87 / 35%);
    border-radius: 8px;
    padding: 6px 10px;
    display: inline-block;
}

/* Subtotal */
.valor-subtotal {
  color: #ffffff; /* azul escuro */
  background: rgb(29 53 87 / 35%);
  border-radius: 8px;
  padding: 6px 10px;
  display: inline-block;
}

/* Entrega */
.valor-entrega {
  color: #002fff; /* azul m√©dio */
    background: rgb(29 53 87 / 35%);
  border-radius: 8px;
  padding: 6px 10px;
  display: inline-block;
}

/* Total Final */
.valor-total {
    color: #2a9d8f; /* verde */
  background: rgba(42, 157, 143, 0.1);
  font-size: 1.3rem;
  font-weight: 700;
  border-radius: 10px;
  padding: 8px 14px;
  margin-top: 12px;
}
.titulo-chave-pix {
    font-weight: 600;
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
}
.meuslinks {
    cursor: pointer;
    color: #fff;
    font-weight: bold;
    border-bottom: 2px solid #c9840a;
    font-size: 28px;
}

/* Estilos para o menu de personaliza√ß√£o do QR Code */
.menuqrpersonalizado {
	padding: 10px;
	color: #fff;
}
.menuqrpersonalizado label {
	display: block;
	margin-top: 15px;
	margin-bottom: 5px;
	font-weight: bold;
}
.menuqrpersonalizado input[type="text"],
.menuqrpersonalizado input[type="number"],
.menuqrpersonalizado select {
	width: 100%;
	padding: 8px;
	border-radius: 5px;
	border: 1px solid var(--cor-primaria);
	background-color: rgba(255, 255, 255, 0.1);
	color: #fff;
	font-size: 14px;
}
.menuqrpersonalizado input[type="color"] {
	width: 48%;
	height: 40px;
	border: none;
	padding: 0;
	cursor: pointer;
}
.menuqrpersonalizado .inline {
	display: flex;
	justify-content: space-between;
	gap: 4%;
}
.menuqrpersonalizado hr {
	border: none;
	border-top: 1px solid rgba(255, 160, 0, 0.5);
	margin: 20px 0;
}
select option {
    background: #333;
    color: white;
}
/* Product List in Modal */
.product-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #eee;
}

.product-entry:last-child {
    border-bottom: none; 
}

.quantity-controls {
    display: flex;
    align-items: center;
}

.quantity-controls button {
  background: none;
    border: none;
    cursor: pointer;
    color: #fff;
}

.quantity-controls span {
    margin: 0 10px;
    font-size: 1em;
}
/* Modal Buttons */
.modal-buttons {
  display: flex;
  justify-content: center;
}

.modal-buttons button {
    width: 48%;
}
/* Estilos para a tela de pagamento */
#paymentModal .payment-modal {
    text-align: center;
}

#paymentModal h2 {
    margin-bottom: 20px;
    color: #ffffff;
}

#payment-details {
    text-align: left; 
    margin-bottom: 20px;
}

#payment-details h3 {
  margin-bottom: 10px;
    color: #fff;
    text-align: center;
}

#product-list-modal {
    list-style: none;
    padding: 0;
}

#product-list-modal li {
    margin-bottom: 5px;
}

#payment-details strong {
    font-size: 1.2em;
}

/* Estilos para a se√ß√£o de pagamentos pendentes */
.pending-transactions {
    text-align: left;
    margin-bottom: 20px;
}

.pending-transactions h2 {
    margin-bottom: 10px;
}

#devendo-list {
    margin: 10px 0;
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 5px;
}

.confirm-payment { /* Estilo para o bot√£o "Confirmar Pagamento" */
background: linear-gradient(47deg, #0081ff, #4800ff, #00a4ff);
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    box-shadow: 0 0 8px #0081ff;
    margin-right: 5px;
}

.confirm-payment:hover {
  background: linear-gradient(47deg, #206958, #05a581, #206958);
  box-shadow: 0 0 15px #05a581;
}

#qr-minha-venda {
    mix-blend-mode: normal;
    /* background: linear-gradient(47deg, #206958, #05a581, #206958); */
    /* box-shadow: 0 0 15px #05a581; */
}
.quantity-controls .quantity-display {
    font-weight: 700;
    font-size: 1.1rem;
    color: white;
}

.quantity-controls .quantity-btn:hover {
    transform: scale(1.1);
}

.quantity-controls .quantity-btn.increment {
    background-color: #2ecc71;
    color: white;
}


.quantity-controls .quantity-btn.decrement {
    background-color: #e74c3c;
    color: white;
}

.quantity-controls .quantity-btn {
    width: 32px;
    height: 32px;
    padding: 0;
    border: none;
    border-radius: 50%;
    font-size: 1.2rem;
    font-weight: 500;
    line-height: 1;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
}
.overlay {
    backdrop-filter: saturate(50%) blur(2.0px);
}
.links-header svg {
    margin-right: 14px;
}
.texocopiado {
    text-align: center;
    word-wrap: break-word;
    white-space: pre-wrap;
    color: #fff;
    width: 90%;
}
/* ==== CARD DO LINK ==== */
.links-style {
    list-style: none;
    display: flex;
    gap: 10px;
    margin-bottom: 16px;
    color: #f1f5f9;
    transition: all 0.2s ease;
    background: rgb(255 255 255 / 8%);
    border-radius: 15px;
    backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid #05a581;
    max-width: 600px;
    width: 100%;
    padding-bottom: 20px;
    flex-direction: column;
    align-items: center;
}
.links-style:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 30px rgba(0,0,0,0.55);
}

/* ==== T√çTULO ==== */
.link-item.link-title {
  font-weight: 700;
  font-size: 17px;
  color: #f1f5f9;
  text-shadow: 0 0 6px rgba(255,255,255,0.2);
  display: flex;
  align-items: center;
  gap: 6px;
}
.link-item.link-title::before {
  content: "üí∏";
  font-size: 18px;
}

/* ==== CONTAINER DE BOT√ïES ==== */
.link-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 4px;
}

/* ==== BOT√ïES ==== */
.link-actions button {
  border: none;
  border-radius: 10px;
  padding: 9px 14px;
  font-weight: 600;
  cursor: pointer;
  font-size: 15px;
  color: #ffffff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  transition: all 0.18s ease;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25);
}

/* ==== CORES E EMOJIS ==== */
.open-link {
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
}
.open-link:hover {
  background: linear-gradient(135deg, #1d4ed8, #1e40af);
}

.share-link {
  background: linear-gradient(135deg, #22c55e, #15803d);
}
.share-link::before {
  content: "üîó";
}
.share-link:hover {
  background: linear-gradient(135deg, #16a34a, #166534);
}

.delete-link {
  background: linear-gradient(135deg, #ef4444, #b91c1c);
}
.delete-link::before {
  content: "üóëÔ∏è";
}
.delete-link:hover {
  background: linear-gradient(135deg, #dc2626, #991b1b);
}

/* ==== ABA ==== */

.aba h3 {
  margin: 0 0 10px;
  color: #60a5fa;
  font-size: 18px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 6px;
}
.aba h3::before {
  content: "üìã";
  font-size: 18px;
}

/* ==== BOT√ïES DE NAVEGA√á√ÉO ==== */
.botoes-navegacao {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin: 20px 0;
}

.botoes-navegacao button {
  border: none;
  border-radius: 8px;
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: #fff;
  padding: 10px 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.18s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}
.botoes-navegacao button:hover {
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
}
#anterior-aba::before {
  content: "‚¨ÖÔ∏è";
}
#proxima-aba::after {
  content: "‚û°Ô∏è";
}

/* ==== RESPONSIVIDADE ==== */
@media (max-width: 640px) {
  .links-style {
    padding: 12px;
  }
  .link-actions button {
    width: 100%;
  }
  .botoes-navegacao {
    flex-direction: column;
  }
  .botoes-navegacao button {
    width: 100%;
  }
}
.links-header {
    display: flex;
    align-content: flex-start;
    justify-content: flex-start;
}
.fechalinks {
    cursor: pointer;
}
/* Transaction History Styling */
.transaction-history {
    text-align: left; 
    margin-bottom: 20px;
}

.transaction-history h2 {
    margin-bottom: 10px;
    text-align: center;
}

#history-list {
  margin: 10px 0;
    max-height: 500px;
    overflow-y: auto;
    padding: 10px;
    border-radius: 5px;
}

.history-entry {
    padding: 6px;
    border-bottom: 1px solid #eee;
    text-align: center;
    justify-content: center;
    list-style: none;
    display: flex;
    gap: 10px;
    margin-bottom: 16px;
    color: #ffffff;
    transition: all 0.2s ease;
    background: rgb(255 255 255 / 8%);
    border-radius: 15px;
    backdrop-filter: blur(var(--blur-padrao));
    border-left: 3px solid #05a581;
    max-width: 600px;
    padding-bottom: 20px;
    flex-direction: column;
    align-items: center;
}

.history-entry:last-child { 
    border-bottom: none; 
}
#modal-editar {
  display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
    margin-bottom: 15px;
    color: #ffffff;
    z-index: 1001;
    }
.edit-product { /* Estilo para o bot√£o "Confirmar Pagamento" */
background: linear-gradient(47deg, #0081ff, #4800ff, #00a4ff);
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    box-shadow: 0 0 8px #0081ff;
    margin-right: 5px;
}

.edit-product:hover {
  background: linear-gradient(47deg, #206958, #05a581, #206958);
  box-shadow: 0 0 15px #05a581;
}
.history-controls {    display: flex;    margin-bottom: 1rem;    gap: 10px;    flex-direction: column-reverse;}
.filter-container { display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap; }
.tabs { display: flex; border-bottom: 2px solid #eee; margin-bottom: 10px; width: 100%; overflow-x: auto; }
.tab-button { white-space: nowrap; padding: 8px 12px; border: none; background-color: transparent; cursor: pointer; font-size: 0.9rem; color: #555; border-bottom: 3px solid transparent; transition: all 0.3s ease; }
.tab-button.active, .tab-button:hover { color: #007bff; border-bottom-color: #007bff; font-weight: bold; }
.search-input { padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; width: 100%; }
.download-options { position: relative; display: inline-block; }
.dropdown-content { display: none; position: absolute; right: 0; background-color: #f9f9f9; min-width: 200px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 10; border-radius: 5px; overflow: hidden; }
.dropdown-content a { color: black; padding: 12px 16px; text-decoration: none; display: block; font-size: 0.9rem; }
.dropdown-content a:hover { background-color: #f1f1f1; }
.download-options .show { display: block; }
.arrow-down { border: solid black; border-width: 0 2px 2px 0; display: inline-block; padding: 3px; transform: rotate(45deg); margin-left: 8px; }

.floating-placa {
    top: 20px;
    position: relative;
    margin-bottom: 25px;
    text-align: left;
}
.floating-placa input[type="text"], input[type="tel"], input[type="email"], .floating-placa input[type="number"], .floating-placa select, .floating-placa textarea {
    border: none;
    border-bottom: 2px solid #ff8c00;
    padding: 10px;
    width: 100%;
    color: white;
    font-size: 1em;
    outline: none;
    transition: border-bottom-color 0.3s ease;
    background: rgb(255 255 255 / 8%);
    border-radius: 8px;
}

.showError {
    color: white;
    font-weight: bold;
    font-size: 14px;
    margin-top: 5px;
    border: none;
    border-bottom: 2px solid #ff0000;
    padding: 8px;
    box-sizing: border-box;
    transition: border-bottom-color 0.3s ease;
    border-radius: 15px;
    background: linear-gradient(226deg, #c90000bd, #ff0000cf);
    box-shadow: 0 0 15px #ff0000;
    display: none;
}
</style>
  
</head>

<body id="desfocfundo">

<div class="loading-img" id="Carregando"></div>

<div id="modal" class="modal">
  <div class="modal-content">
    <p id="Error"></p>
    <button class="modal-btn" onclick="fecharModal()">Fechar</button>
  </div>
</div>

<div id="modal-salvapix" class="modal-salva">
  <div class="modal-content-salva">
    <div class="StickyTab">
    <div class="StickyType"></div>
    <span class="close-button" aria-label="Fechar Modal" id="close-check" onclick="fecharsalvapix()">√ó</span>
    </div>
	<div class="floating-label">
         <input type="text" id="titulo" placeholder=""  maxlength="40">
		 <label for="titulo" >Titulo do Seu Pix:<b><span class="infor"> Ex: Meu Pix - NuBank</span></b></label>
		 </div>
    <button class="cliqueBtn" onclick="salvameupix()">Adiciona titulo</button>
  </div>
</div>


<div class="dados">
	<h1>Gerador de QR Code Pix</h1>

  <div id="modal-editar" class="modal" aria-hidden="true">
    <div class="modal-content-editar">
      <span class="close-button" onclick="fechareditform()">√ó</span>
              <h2>Atualizar Produto</h2>
      <form id="edit-form">
        <div class="floating-label">
          <label for="edit-name">Nome do Produto:</label>
          <input type="text" id="edit-name" required />
        </div>
        <div class="floating-label">
          <label for="edit-price">Pre√ßo do Produto:</label>
          <input type="text" id="edit-price" placeholder="" oninput="amount(this)" required>
        </div>
      <button type="submit" class="atualizar-produto">Atualizar</button>
      </form>
    </div>
  </div>

  <div id="minhavenda" style="display: none;">
    <div class="links-container">
    <div class="links-header">
    <a class="fechalinks" onclick="mostrarLinks()"> <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fff" height="38" width="38" xmlns="http://www.w3.org/2000/svg" style="color: rgb(255, 255, 255);"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></a>
    <h1>Minha Vendas</h1>
    </div>
    
    <div class="menuvendas"></div>

    <div class="rodape-div-4-coluna">
               <!-- elemento -->
               <span><b>Aten√ß√£o!</b></span>
               <p>Seus dados ser√£o armazenados localmente no seu navegador. Eles n√£o ser√£o compartilhados ou enviados para servidores externos.</p>
           </div>
    </div>
</div>


    <div id="productModal" class="modal-vendas" aria-hidden="true">
        <div class="modal-contentvenda">
            <span class="close-button" aria-label="Fechar Modal">√ó</span>
            <h2>Adicionar Novo Produto</h2>
            <form id="product-form">
                <div class="floating-label">
                <input type="text" id="product-name" placeholder="" required>
                <label for="product-name">Nome do Produto:<b><span class="infor">*</span></b></label>
                </div>

                <div class="floating-label">
                <input type="text" id="product-price" placeholder="" oninput="amount(this)" required>
                <label for="product-price">Pre√ßo (R$ 1.000,00):<b><span class="infor">*</span></b></label>
                </div>
                <button type="submit" class="confirm-payment">Salvar Produto</button>
            </form>
        </div>
    </div>

    <div id="productsModal" class="modal-vendas" aria-hidden="true">
        <div class="modal-contentvenda">
            <span class="close-button" aria-label="Fechar Modal">√ó</span>
            <h2>Selecionar Produtos</h2>
            <div id="products-list"></div>

            <div class="modal-buttons">
                <button id="cancel-products" class="cancel-products">Cancelar</button>
                <button id="add-products" class="botao-compartilhar-vendas">Gerar QR</button>
            </div>
        </div>
    </div>

    <div id="paymentModal" class="modal-vendas" aria-hidden="true">
        <div class="modal-contentvenda payment-modal">

          <div id="modalagendamento" class="modalagendamento" aria-hidden="true">
            <div class="modal-contentvenda">
                <span class="modalagendamento-close-button" aria-label="Fechar agendamento" onclick="fecharModalNomeAgendamento()">√ó</span>
                <h2>Nome do Cliente:</h2>
                    <div class="floating-label-clienteNome">
                      <input type="text" id="clienteNome" placeholder="" required="">
                      <label for="clienteNome"></label>
                    </div>
                      <button id="modalConfirm" class='modalConfirm'>Confirmar</button>
                      <br />
                      <br />		
                      <span id="Error-nome-agendamento"></span>
            </div>
           </div>

            <span class="close-button" aria-label="Fechar Modal">√ó</span>
            <h2>Pagamento QR Pix</h2>

            <div class="flex flex-row justify-between w-auto pb3">
                <span class="justify-start b tl">Nome: </span>
                <span class="justify-end tr" id="nome"></span>
            </div>
            <div class="flex flex-row justify-between w-auto pb3">
                <span class="justify-start b tl" id="cpfcnpj">CPF: </span>
                <span class="justify-end tr" id="cpf-cnpj"></span>
            </div>
            <div class="flex flex-row justify-between w-auto pb3">
                <span class="justify-start b tl">Banco: </span>
                <span class="justify-end tr" id="banco-do-beneficiario"></span>
            </div>

            <!-- O <canvas> foi substitu√≠do por uma <div> para a nova biblioteca -->
            <div id="qr-minha-venda" style="width: 270px; height: 270px;"></div>

            <div id="payment-details">
                <h3>Detalhes da Compra</h3>
                <ul id="product-list-modal"></ul>
                <p><strong>Total: <span id="total-amount-modal">R$ 0,00</span></strong></p>
            </div>

            <div class="modal-buttons">
                <button id="pago-button" class="botao-compartilhar-vendas">Pago</button>
                <button id="compartilhar-pagameto-button" class="botao-compartilhar-vendas">Agenda e Compatilhar</button>
            </div>
        </div>
    </div>


	 <div id="links-container" style="display: none;">
	   <div class="links-container">
	   <div class="links-header">
	   <a class="fechalinks" onclick="fechalinks()"> <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fff" height="38" width="38" xmlns="http://www.w3.org/2000/svg" style="color: rgb(255, 255, 255);"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></a>
	   <h1>Meus Links Pix</h1>
	   </div>
	   
	   <div class="links-item"><ul id="lista-links"></ul></div>
	   
	   <div class="rodape-div-4-coluna">
                <!-- elemento -->
                <span><b>Aten√ß√£o!</b></span>
                <p>Seus dados ser√£o armazenados localmente no seu navegador. Eles n√£o ser√£o compartilhados ou enviados para servidores externos.</p>
            </div>
	   </div>
</div>

		 <div class="show-share">
      <div id="compartilhar" class="">
            <div class="StickyBox" id="mainContent">
					  <div class="loading-img overlay" id="CarregaCompartilhar"></div>
                    <div class="StickyDemo" style="display: none;">
                        <div class="StickyTab">
                            <div class="StickyType">Compartilhar com outros aplicativos</div>
                            <span class="close-button" aria-label="Fechar Modal" onclick="closecompartilhar()">√ó</span>
                        </div>
                        <div class="share-wrapper-icons colorful colorful-ico">
                            <li class="twitter">
                                <a class="twitter" data-height="460" onclick="compartilharlink('https://twitter.com/intent/tweet?text=Meu Pix&url=')" data-width="550" rel="nofollow" title="Twitter">Twitter</a>
                            </li>
                            <li class="telegram">
                                <a class="telegram" data-height="460" data-width="550" onclick="compartilharlink('https://telegram.me/share/url?text=Meu Pix&url=')" rel="nofollow" title="Telegram">Telegram</a>
                            </li>
                            <li class="whatsapp">
                                <a class="whatsapp" data-height="650" data-width="550" onclick="compartilharlink('https://api.whatsapp.com/send?text=')" rel="nofollow" title="Whatsapp">Whatsapp</a>
                            </li>
                            <li class="facebook-f">
                                <a class="facebook" data-height="650" data-width="550" onclick="compartilharlink('https://www.facebook.com/sharer.php?u=')" rel="nofollow" title="Facebook">Facebook</a>
                            </li>
                            <li>
                            <a data-height="460" data-width="550" onclick="Compartilhamentos()" title="outros Compartilhamentos"> <img class="Compartilhamentos"/> Outros</a>
                            </li>
                            <li class="email">
                                <a class="email" data-height="460" data-width="550" onclick="compartilharlink('mailto:?subject=Meu Pix&body=')" rel="nofollow" title="Email">Email</a>
                            </li>
							<li>
							<a  data-height="460" data-width="550" onclick="LinkCurto()" title="Gerador Por https://is.gd/"><img class="logois"/>Link Curto</a> 
                            </li>
                        </div>

                <span class="title">Link curto</span>
                
                <div class="copy-section">
						    <div id="telacopiado" class="modal">
                  <div class="modal-content">
						      <h3  class="notificatextocopiado">
						      <b><span id="titulocopiado"></span><br /></b></h3>
						      <span class="texocopiado" id="textocopiado"></span>					 
						      </div>
						    </div>
                
						    <div class="copy-post">
						      <input id="linkcurto" onclick="copiarLinkCurto()"></input>
						    </div><br />
						    <span class="title">Link com os par√¢mentos</span>
						    <div class="copy-post">
						      <input id="urlpix" onclick="copiaurlpix()"></input>
						    </div><br />
						    <span class="title">Seu Link pix codificador</span>
						    <div class="copy-post">
						       <input id="linkcodificador" onclick="copiaLink()"></input>
						    </div><br />	
						    <span class="title">Salva seu pix</span>
						    <div class="copy-post">
						       <input id="salva-meu-pix" onclick="copiameulinkpix()"></input>
						    </div><br />							
				       </div>
                    </div>
                </div>
           </div>
     </div> 

<div class="caixatex"> 
  <h2 class="tituloh2">Dados Pix</h2>

     <div class="floating-placa">
      <select id="ChavesSelector">
        <option value="celular">Telefone</option>
        <option value="email">Email</option>
        <option value="cnpj">CNPJ</option>
        <option value="cpf">CPF</option>
        <option value="aleatoria">Chave Aleat√≥ria</option>
     </select>
     <label>Tipo de Chave <b class="infor">*</b></label></div>

     <div class="floating-placa"><input type="text" id="pixkey" placeholder=" "> <label id="pixKeyLabel">Chave Pix (Telefone) <b class="infor">*</b></label></div>

     <div class="floating-placa">
         <input type="text" id="merchantName" placeholder=""  maxlength="25"> 
         <label for="merchantName">Nome do Beneficiado: <b class="infor">* </b><span style="color: #fff;"> (at√© 25 letras)</span></label>
		 </div>

     		 <div class="floating-placa">
         <input type="text" id="merchantCity" placeholder=""  maxlength="15">
         <label for="merchantCity">Cidade do Beneficiado:<b class="infor">*</b><span style="color: #fff;"> (at√© 15 letras)</span></label>
		 </div>

		 <div class="floating-placa">
         <input type="text" id="banco" placeholder=" ">
		 <label for="banco">banco do Beneficiado:<b class="infor">*</b><span style="color: #fff;">Ex: PicPay</span></b></label>
		 </div>

		 <div class="floating-placa">
         <input  type="tel" id="documento" name="documento" placeholder=" " oninput="formatarDocumento(this)" maxlength="18">
		 <label for="documento">CPF ou CNPJ do Beneficiado: <b><span class="infor">*</span></b></label>
		 </div>
		 
		 <div class="floating-placa">
         <input type="text" id="description" placeholder=""  maxlength="28">
         <label for="description">mensagem no Pagamento: <span style="color: #fff;"> (at√© 28 letras)</span></b></label>
		 </div>
		 
		 <div class="floating-placa">
         <input type="text" id="txid" placeholder=""  maxlength="20">
		 <label for="txid" >Identificador da transa√ß√£o: <b><span style="color: #fff;">Sem espa√ßos at√© 20 Letras e/ou caracteres especiais (ex: √ß √£)</span></b></label>
		 </div>
		 
		 <div class="floating-placa">
         <input type="tel" id="amount" placeholder=" " oninput="amount(this)">
         <label for="amount">Valor: <b><span style="color: #fff;">R$ 1.000,00</span></b></label>
		 </div>
		 
		 <div class="floating-placa">
         <input  type="text" id="whatsapp" name="whatsapp" placeholder=" " oninput="formatarTelefone(this)" maxlength="13">
         <label for="whatsapp">Whatsapp do Beneficiado: <b><span style="color: #fff;">Whatsapp:5591900000000 ou true = #BotaoEnviarComprovante</span></b></label>
		 </div>

		 <div class="floating-placa">
         <input type="text" id="botao-voltar" placeholder=" " oninput="botaovolta(this)">
         <label for="botao-voltar">Add Bot√£o Voltar: <b><span style="color: #fff;">Link ou true = #BotaoVoltarPix</span></b></label>
		 </div>

     <div class="menuqrpersonalizado">
			<label>Forma dos QR:</label>
			<select id="shape">
				<option value="square">Quadrado</option>
				<option value="dots">Pontos</option>
				<option value="rounded" selected>Arredondado</option>
				<option value="classy">Elegante</option>
				<option value="classy-rounded">Elegante Arredondado</option>
				<option value="extra-rounded">Super Arredondado</option>
			</select>
		
			<label>Forma dos cantos do QR:</label>
			<select id="cornerShape">
				<option value="square">Quadrado</option>
				<option value="dot">Ponto</option>
				<option value="extra-rounded" selected>Arredondado</option>
			</select>
		
			<hr>
		
			<label>üé® Cor Principal do QR / Gradiente:</label>
			<div class="inline">
				<input type="color" id="color1" value="#ffffff">
				<input type="color" id="color2" value="#05a581">
			</div>
		
			<label>Tipo de gradiente do QR:</label>
			<select id="gradientType">
				<option value="none" selected>Cor √∫nica</option>
				<option value="linear">Linear</option>
				<option value="radial">Radial</option>
			</select>
		
			<label>Rota√ß√£o do gradiente do QR:</label>
			<input type="number" id="rotation" min="0" max="360" value="0">
		
			<hr>
		
			<label>Usar cores diferentes nos cantos do QR?</label>
			<select id="useCornerColors">
				<option value="no" selected>N√£o</option>
				<option value="yes">Sim</option>
			</select>
		
			<div id="cornerSettings" class="hidden">
				<label>üéØ Cores dos Cantos do QR:</label>
				<div class="inline">
					<input type="color" id="cornerColor1" value="#ffffff">
					<input type="color" id="cornerColor2" value="#05a581">
				</div>
		
				<label>Tipo de gradiente dos cantos do QR:</label>
				<select id="cornerGradientType">
					<option value="none" selected>Cor √∫nica</option>
					<option value="linear">Linear</option>
					<option value="radial">Radial</option>
				</select>
		
				<label id="cornerRotationLabel" class="hidden">Rota√ß√£o do gradiente dos cantos do QR:</label>
				<input type="number" id="cornerRotation" min="0" max="360" value="0" class="hidden">
			</div><br>
    <div class="floating-placa">
		 <input type="text" id="add-logo" placeholder=" ">
		 <label for="add-logo">Logo: <span style="color: #fff;">Ex: https://meupix.github.io/logo.png</span></label>
		 </div><br>
            <button class="cliqueBtn" onclick="updateQrPreview()" style="margin-top: 20px;">Ver Preview do PIX</button>
		</div>
		 
		 <span class="showError" id="showError"></span><br>
		 
		 <button class="cliqueBtn" onclick="AbrirPixCriptografardo()">Gerar Pix</button>
     <button class="cliqueBtn" onclick="MinhaVenda()">Minha Venda Pix</button>
		 <button class="cliqueBtn" onclick="CompartilharPix()">Compartilhar Pix</button>
     <button class="cliqueBtn" onclick="CriarLojaVirtual()">Criar Loja Virtual</button>
		 <button class="cliqueBtn" onclick="criaplacapix()">Criar Placa Pix</button>
		 <button class="cliqueBtn" onclick="salvameupix()">Salvar Pix</button>
		 <span onclick="mostrarLinks()" class="meuslinks">Meus Links Salvos</span>
</div> 
	
<footer class="rodape" id="contato">
    <div class="rodape-div">
        <div class="rodape-div-1">
            <img src="pagamentos.files/imagens/logo-pix.png" alt="Meu Pix" title="Meu Pix" style="width: 130px;">
        </div>
        <div class="rodape-div-2">
            <a href="https://github.com/meupix/meupix.github.io" rel="nofollow" title="github">GitHub</a>
        </div>
        <div class="rodape-div-3">
             <span><b>Baixar HTML</b></span>
			 <p><a href="https://github.com/meupix/meupix.github.io/archive/refs/heads/main.zip">Download</a></p>
        </div>
    </div>
	<div>
        <span><b>Aten√ß√£o!</b></span>
        <p>Antes de receber qualquer pagamento, verifique se todos os dados est√£o corretos e teste a leitura do QR Code. O site se isenta de qualquer responsabilidade pela exatid√£o e integridade das informa√ß√µes geradas.</p>
    </div>
    <p class="rodape-direitos">¬© Meu Pix - 2024</p>
</footer>
</div>

<!-- NOVO: Modal de Pr√©-visualiza√ß√£o -->
<div id="previewModal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closePreviewModal()">√ó</span>
        <div id="tele-de-preview">
            <h3 class="subtitulo">Use o QR Code do Pix para pagar</h3>
            <p>Abra o app do seu banco, escaneie a imagem ou cole o c√≥digo.</p>
            <div id="qr-code-preview" style="width: 270px; height: 270px;"></div>

            <p class="valor-total">
                <strong id="valor2-preview">R$ 00,00</strong>
            </p>

            <a id="copy-qr-preview" class="copy-button" onclick="copiarqrpixPreview();">Copiar C√≥digo Pix</a>

            <div class="detalhes-pix">
              <p class="titulo-chave-pix"><strong>Ou use a chave Pix</strong></p>
              <div class="info-pix-container">
                 <div class="info-linha">
                     <span class="info-label">Chave Pix</span>
                     <span id="chave-preview" class="info-valor"></span>
                 </div>
                  <div class="info-linha">
                      <span class="info-label">Nome</span>
                      <span class="info-valor" id="nome2-preview"></span>
                  </div>
                  <div class="info-linha">
                      <span class="info-label" id="cpf-cnpj-preview">CPF</span>
                      <span class="info-valor" id="cpf-preview"></span>
                  </div>
                  <div class="info-linha" id="infor-none-preview" style="display: none;">
                      <span class="info-label">Identificador</span>
                      <span class="info-valor" id="infor-preview"></span>
                  </div>
                  <div class="info-linha" id="mensagem-none-preview" style="display: none;">
                      <span class="info-label">Mensagem</span>
                      <span class="info-valor" id="mensagem-preview"></span>
                  </div>
              </div>
          </div>
        </div>
    </div>
</div>

<div class="qrcriado" style="display: none;">
  <div id="BotaoVoltar2" class="botao-voltar-mobile"><a onclick="Voltar();" class="loja-button"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fff" height="20" width="20" xmlns="http://www.w3.org/2000/svg" style="color: rgb(255, 255, 255);"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></a></div>
    <main class="container-principal">
    <!-- SE√á√ÉO ESQUERDA -->
    <section class="secao-esquerda">
          <div id="BotaoVoltar1" class="botao-voltar-desktop"><a onclick="Voltar();" class="loja-button"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fff" height="20" width="20" xmlns="http://www.w3.org/2000/svg" style="color: rgb(255, 255, 255);"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></a></div>
        <div class="info-pagamento">
            <div id="logo" class="logo-container">
                <div id="minhalogo" class="minhalogo"></div>
                <h1 class="titulo-principal">Transfira <span id="valor1"></span> para <br><span id="nome1"></span>.</h1>
            </div>
        </div>
    </section>

    <!-- SE√á√ÉO DIREITA -->
    <section class="secao-direita">
        <div id="qr-data">
            <h3 class="subtitulo">Use o QR Code do Pix para pagar</h3>
            <p class="instrucao">Abra o app do seu banco, escaneie a imagem ou cole o c√≥digo.</p>
            
			<!-- O <canvas> foi substitu√≠do por uma <div> para a nova biblioteca -->
			<div id="qr-code" style="width: 270px; height: 270px;"></div>

            <div id="container">
              <ul id="itemList"></ul>
            </div>
            
            <p class="valor-total">
                <strong><strong id="valor2"></strong></strong>
            </p>

            <a id="copy-qr" class="copy-button" data-clipboard-target="#qrpix" onclick="copiarqrpix();">Copiar C√≥digo Pix</a>

            <div class="detalhes-pix">
              <p class="titulo-chave-pix"><strong>Ou use a chave Pix</strong></p>
              <div class="info-pix-container">
                 <div id="copiarchavepix" class="info-linha">
                     <span class="info-label">Chave Pix</span>
                     <span id="copy-chave" class="copy-icon-chave" data-clipboard-target="#chave" onclick="copiarchavepix();">Copiar Chave</span>
                 </div>
                  <div class="info-linha">
                      <span class="info-label">Nome</span>
                      <span class="info-valor" id="nome2"></span>
                  </div>
                  <div class="info-linha">
                      <span class="info-label" id="cpf-cnpj">CPF</span>
                      <span class="info-valor" id="cpf"></span>
                  </div>
                  <div class="info-linha">
                      <span class="info-label">Banco</span>
                      <span class="info-valor" id="banco-do-beneficiario"></span>
                  </div>
                  <div id="infor-none" class="info-linha">
                      <span class="info-label">Identificador</span>
                      <span class="info-valor" id="infor"></span>
                  </div>
                  <div id="mensagem-none" class="info-linha">
                      <span class="info-label">Mensagem</span>
                      <span class="info-valor" id="mensagem"></span>
                  </div>
              </div>
          </div>
        </div>

        <div id="Botaowhat1" class="botao-comprovante-desktop">
            <span class="comprovante-button" onclick="EnviarComprovante();">Enviar Comprovante <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="logo-what" alt="WhatsApp"></span>
        </div>
        <div id="Botaowhat2" class="botao-comprovante-mobile">
            <span class="comprovante-button" onclick="EnviarComprovante();">Enviar Comprovante <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="logo-what" alt="WhatsApp"></span>
        </div>

                    <div id="Botaowhatpedido2" class="botao-comprovante-desktop">
              <span class="comprovante-button db tc no-underline fw6 ttn-ns" onclick="EnviarPedido();">Envia pedido <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="logo-what" alt="WhatsApp"></span>
          </div>
          <div id="Botaowhatpedido1" class="botao-comprovante-mobile">
              <span class="comprovante-button db tc no-underline fw6 ttn-ns" onclick="EnviarPedido();">Envia pedido <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="logo-what" alt="WhatsApp"></span>
          </div>

        <div id="whatswidget-pre-wrapper" class="">
    <div id="whatswidget-widget-wrapper" class="whatswidget-widget-wrapper" style="all:revert;">
        <div id="whatswidget-conversation" class="whatswidget-conversation" style="display: none;">
            <div class="whatswidget-conversation-header" style="all:revert;">
                <div id="whatswidget-conversation-title" class="whatswidget-conversation-title" style="all:revert;"><span id="nome3"></span></div>
            </div>
            <div id="whatswidget-conversation-message" class="whatswidget-conversation-message " style="all:revert;">Qualquer d√∫vida estou a disposi√ß√£o.</div>
            <div class="whatswidget-conversation-cta" style="all:revert; cursor: pointer;" >
                <a style="all:revert;" id="whatswidget-phone-desktop" onclick="AbrirWhatsapp();" class="whatswidget-cta whatswidget-cta-desktop">Enviar mensagem</a>
                <a id="whatswidget-phone-mobile" onclick="AbrirWhatsapp();" class="whatswidget-cta whatswidget-cta-mobile" style="all:revert;">Enviar mensagem</a>
            </div>
        </div>
        <div id="whatswidget-conversation-message-outer" class="whatswidget-conversation-message-outer" style="display: none;">
            <div id="whatswidget-text-header-outer" class="whatswidget-text-header-outer" style="all:revert;"><span id="nome4"></span></div>
            <br>
            <div id="whatswidget-text-message-outer" class="whatswidget-text-message-outer" style="all:revert;">Qualquer d√∫vida estou a disposi√ß√£o.</div>
        </div>
        <div class="whatswidget-button-wrapper" style="all:revert;">
            <div class="whatswidget-button" id="whatswidget-button" style="all:revert;">
                <div style="margin:0 auto;width:38.5px;all:revert;">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgba(255,255,255,1)"><path d="M7.25361 18.4944L7.97834 18.917C9.18909 19.623 10.5651 20 12.001 20C16.4193 20 20.001 16.4183 20.001 12C20.001 7.58172 16.4193 4 12.001 4C7.5827 4 4.00098 7.58172 4.00098 12C4.00098 13.4363 4.37821 14.8128 5.08466 16.0238L5.50704 16.7478L4.85355 19.1494L7.25361 18.4944ZM2.00516 22L3.35712 17.0315C2.49494 15.5536 2.00098 13.8345 2.00098 12C2.00098 6.47715 6.47813 2 12.001 2C17.5238 2 22.001 6.47715 22.001 12C22.001 17.5228 17.5238 22 12.001 22C10.1671 22 8.44851 21.5064 6.97086 20.6447L2.00516 22ZM8.39232 7.30833C8.5262 7.29892 8.66053 7.29748 8.79459 7.30402C8.84875 7.30758 8.90265 7.31384 8.95659 7.32007C9.11585 7.33846 9.29098 7.43545 9.34986 7.56894C9.64818 8.24536 9.93764 8.92565 10.2182 9.60963C10.2801 9.76062 10.2428 9.95633 10.125 10.1457C10.0652 10.2428 9.97128 10.379 9.86248 10.5183C9.74939 10.663 9.50599 10.9291 9.50599 10.9291C9.50599 10.9291 9.40738 11.0473 9.44455 11.1944C9.45903 11.25 9.50521 11.331 9.54708 11.3991C9.57027 11.4368 9.5918 11.4705 9.60577 11.4938C9.86169 11.9211 10.2057 12.3543 10.6259 12.7616C10.7463 12.8783 10.8631 12.9974 10.9887 13.108C11.457 13.5209 11.9868 13.8583 12.559 14.1082L12.5641 14.1105C12.6486 14.1469 12.692 14.1668 12.8157 14.2193C12.8781 14.2457 12.9419 14.2685 13.0074 14.2858C13.0311 14.292 13.0554 14.2955 13.0798 14.2972C13.2415 14.3069 13.335 14.2032 13.3749 14.1555C14.0984 13.279 14.1646 13.2218 14.1696 13.2222V13.2238C14.2647 13.1236 14.4142 13.0888 14.5476 13.097C14.6085 13.1007 14.6691 13.1124 14.7245 13.1377C15.2563 13.3803 16.1258 13.7587 16.1258 13.7587L16.7073 14.0201C16.8047 14.0671 16.8936 14.1778 16.8979 14.2854C16.9005 14.3523 16.9077 14.4603 16.8838 14.6579C16.8525 14.9166 16.7738 15.2281 16.6956 15.3913C16.6406 15.5058 16.5694 15.6074 16.4866 15.6934C16.3743 15.81 16.2909 15.8808 16.1559 15.9814C16.0737 16.0426 16.0311 16.0714 16.0311 16.0714C15.8922 16.159 15.8139 16.2028 15.6484 16.2909C15.391 16.428 15.1066 16.5068 14.8153 16.5218C14.6296 16.5313 14.4444 16.5447 14.2589 16.5347C14.2507 16.5342 13.6907 16.4482 13.6907 16.4482C12.2688 16.0742 10.9538 15.3736 9.85034 14.402C9.62473 14.2034 9.4155 13.9885 9.20194 13.7759C8.31288 12.8908 7.63982 11.9364 7.23169 11.0336C7.03043 10.5884 6.90299 10.1116 6.90098 9.62098C6.89729 9.01405 7.09599 8.4232 7.46569 7.94186C7.53857 7.84697 7.60774 7.74855 7.72709 7.63586C7.85348 7.51651 7.93392 7.45244 8.02057 7.40811C8.13607 7.34902 8.26293 7.31742 8.39232 7.30833Z"></path></svg> 
                </div>
            </div>
        </div>
    </div>
</div>
    </section>
  </main>

  <!-- Elementos escondidos para armazenar dados -->
  <span style="display: none;" id="chave"></span>
  <span style="display: none;" id="qrpix"></span>
  <span style="display: none;" id="valor"></span>
  <span style="display: none;" id="beneficiario"></span>
  <span style="display: none;" id="descricao"></span>
  <span style="display: none;" id="identificador"></span>
  <span style="display: none;" id="whatsapp"></span>
  <span style="display: none;" id="voltar"></span>
</div>

<script>

const urlParams = new URLSearchParams(window.location.search);

// Verifica se existem par√¢metros na URL
if (!urlParams || urlParams.keys().next().done) {
    // Sem par√¢metros encontrados, fa√ßa algo aqui (opcional)
} else {
    // Verifica se os par√¢metros necess√°rios est√£o presentes
    if (!urlParams.has('codepix') && !urlParams.has('chave') && !urlParams.has('schave') && !urlParams.has('minhavenda')) {

        // Par√¢metros n√£o encontrados: exibe mensagem de erro
        $('#Error').text('Par√¢metro n√£o encontrado: &codepix= &chave= &schave= &minhavenda=');
        $('#modal').css('display', 'flex');
        $('#desfocfundo').addClass('overlay');
        $('.dados').hide();
        $('#Carregando').html('<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-pix.png" alt="">');
    } else {
        // Par√¢metros encontrados: inicia o processamento do pagamento
        $('#desfocfundo').addClass('overlay');
        $('.dados').hide();
        $('#Carregando').html('<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-pix.png" alt="">');
    }
}

// ===================================================================
// --- FUN√á√ïES DO MENU DE PERSONALIZA√á√ÉO ---
// ===================================================================

// Adiciona listeners para mostrar/esconder op√ß√µes de gradiente dos cantos
document.addEventListener('DOMContentLoaded', () => {
    const useCornerColors = document.getElementById('useCornerColors');
    const cornerSettings = document.getElementById('cornerSettings');
    const cornerGradientType = document.getElementById('cornerGradientType');
    const cornerRotation = document.getElementById('cornerRotation');
    const cornerRotationLabel = document.getElementById('cornerRotationLabel');
    useCornerColors.addEventListener('change', () => {
        if (useCornerColors.value === 'yes') {
            cornerSettings.style.display = 'block';
        } else {
            cornerSettings.style.display = 'none';
        }
    });
    cornerGradientType.addEventListener('change', () => {
        if (cornerGradientType.value === 'linear') {
            cornerRotation.style.display = 'block';
            cornerRotationLabel.style.display = 'block';
        } else {
            cornerRotation.style.display = 'none';
            cornerRotationLabel.style.display = 'none';
        }
    });
    initPixFormatters();
    setTimeout(() => {
        // Inicializa a exibi√ß√£o correta com base nos valores atuais
        useCornerColors.dispatchEvent(new Event('change'));
        cornerGradientType.dispatchEvent(new Event('change'));
    }, 100);

    return;

});

// Fun√ß√£o para coletar todas as op√ß√µes de personaliza√ß√£o do modal
function getQrPersonalizationOptions() {
    if (!document.getElementById('shape')) return {}; // Retorna vazio se o menu n√£o existir

    return {
        qr_shape: document.getElementById('shape').value,
        qr_corner_shape: document.getElementById('cornerShape').value,
        qr_color1: document.getElementById('color1').value,
        qr_color2: document.getElementById('color2').value,
        qr_gradient_type: document.getElementById('gradientType').value,
        qr_rotation: document.getElementById('rotation').value,
        qr_use_corner_colors: document.getElementById('useCornerColors').value,
        qr_corner_color1: document.getElementById('cornerColor1').value,
        qr_corner_color2: document.getElementById('cornerColor2').value,
        qr_corner_gradient_type: document.getElementById('cornerGradientType').value,
        qr_corner_rotation: document.getElementById('cornerRotation').value
    };
}


function CompartilharPix() {
  // Obt√©m os valores dos campos do formul√°rio
  const pixKeyInput = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';
  const pixkey = formatchavepix(pixKeyInput);
  // Verifica a presen√ßa de dados obrigat√≥rios
  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  // Gera o link para compartilhar o PIX
  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let textoOriginal = '';
    let meupixsalvo = ''; 
    
    	const personalizationOptions = getQrPersonalizationOptions();
    let personalizationString = "";
    for (const key in personalizationOptions) {
        personalizationString += `&${key}=${encodeURIComponent(personalizationOptions[key])}`;
    }

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); // Fun√ß√£o para formatar CPF (n√£o implementada aqui)
       meupixsalvo = "?schave=" + pixkey + (amount ? "&valor=" + amount : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
       textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    } else if (cpf.length === 14) {
       meupixsalvo = "?schave=" + pixkey + (amount ? "&valor=" + amount : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
       textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
    textoOriginal += personalizationString;
    meupixsalvo += personalizationString;
      const LinkCriptografado = btoa(textoOriginal);
      GerarLinkCurto("https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado), "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado));
      document.getElementById('linkcodificador').value = "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado);
      document.getElementById('urlpix').value = "https://meupix.github.io" + textoOriginal.replace(/\ /g, '%20');
      document.getElementById('salva-meu-pix').value = "https://meupix.github.io" + meupixsalvo.replace(/\ /g, '%20');
  }

  $('#mainContent').addClass('overlay');
  $('#compartilhar').show(); 
  $('#close-check').show();
  $('#CarregaCompartilhar').show();
  $('#CarregaCompartilhar').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-compartilhar.png" alt="">`);
}
function AbrirPixCriptografardo() {
  // Obt√©m os valores dos campos do formul√°rio
  const pixkey = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';

  // Verifica a presen√ßa de dados obrigat√≥rios
  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }


if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let textoOriginal;
	
	const personalizationOptions = getQrPersonalizationOptions();
    let personalizationString = "";
    for (const key in personalizationOptions) {
        personalizationString += `&${key}=${encodeURIComponent(personalizationOptions[key])}`;
    }

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
        textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      } else if (cpf.length === 14) {
        textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
	
	textoOriginal += personalizationString;

    // Gera o link do Pix criptografado e redireciona
	const LinkCriptografado = btoa(textoOriginal); 
    location.href = "?codepix=" + encodeURIComponent(LinkCriptografado);
  }
}

function MinhaVenda() {
   // Obt√©m os valores dos campos do formul√°rio
   const pixkey = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';

  // Verifica a presen√ßa de dados obrigat√≥rios
  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let ParamsChaves;
	const personalizationOptions = getQrPersonalizationOptions();
    let personalizationString = "";
    for (const key in personalizationOptions) {
        personalizationString += `&${key}=${encodeURIComponent(personalizationOptions[key])}`;
    }

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      } else if (cpf.length === 14) {
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
	
	ParamsChaves += personalizationString;

    // Gera o link do Pix criptografado e redireciona
	const LinkCriptografado = btoa(ParamsChaves); 
    location.href = "?minhavenda=" + encodeURIComponent(LinkCriptografado);
  }
}

function CriarLojaVirtual() {
   // Obt√©m os valores dos campos do formul√°rio
   const pixKeyInput = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';
  const pixkey = formatchavepix(pixKeyInput);
  // Verifica a presen√ßa de dados obrigat√≥rios
  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let ParamsChaves;
	const personalizationOptions = getQrPersonalizationOptions();
    let personalizationString = "";
    for (const key in personalizationOptions) {
        personalizationString += `&${key}=${encodeURIComponent(personalizationOptions[key])}`;
    }

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      } else if (cpf.length === 14) {
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
	
	ParamsChaves += personalizationString;

    // Gera o link do Pix criptografado e redireciona
	const LinkCriptografado = btoa(ParamsChaves); 
    location.href = "https://meupix.vercel.app/lojavirtual/criarconfig?dadospix=" + encodeURIComponent(LinkCriptografado);
  }
}

function criaplacapix() {
  // Obt√©m os valores dos campos do formul√°rio
  const pixkey = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';

  // Verifica a presen√ßa de dados obrigat√≥rios
  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let ParamsChaves;

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      } else if (cpf.length === 14) {
        ParamsChaves = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
	
    // Gera o link do Pix criptografado e redireciona
	const LinkCriptografado = btoa(ParamsChaves); 
    location.href = "https://meupix.vercel.app/criarplaca?dadospix=" + encodeURIComponent(LinkCriptografado);
  }
}

// Fun√ß√£o para adicionar um novo link ao localStorage
function salvameupix() {
  // Obt√©m os valores dos campos do formul√°rio
  const pixKeyInput = document.getElementById('pixkey').value || '';
  const amount = document.getElementById('amount').value || '';
  const description = (document.getElementById('description').value).substring(0, 28) || '';
  const merchantName = (document.getElementById('merchantName').value).substring(0, 25) || '';
  const merchantCity = (document.getElementById('merchantCity').value).substring(0, 15) || '';
  const txid = (document.getElementById('txid').value).substring(0, 20) || '';
  const banco = document.getElementById('banco').value || '';
  const cpf = (document.getElementById('documento').value.replace(/\D/g, '')).substring(0, 18) || '';
  const whatsapp = document.getElementById('whatsapp').value || '';
  const voltar = document.getElementById('botao-voltar').value || '';
  const minhalogo = document.getElementById('add-logo').value || '';
  const titulo = document.getElementById('titulo').value || '';
  const pixkey = formatchavepix(pixKeyInput);

  if (pixkey === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a chave Pix.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantName === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (merchantCity === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a Cidade do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (banco === '') {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira o nome do banco do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }

  if (cpf.length !== 11 && cpf.length !== 14) {
    $('.showError').show();
    document.getElementById('showError').innerText = 'Insira a CPF OU CNPJ do Beneficiado.';
    setTimeout(() => { $('.showError').hide(); }, 2000);
    return;
  }
  
  if (titulo === '') {
      const modal = document.getElementById('modal-salvapix');
      modal.style.display = 'flex';
    return;
    }

  // Gera o link para compartilhar o PIX
  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {
    let meupixsalvo;
    let textoOriginal;
        	const personalizationOptions = getQrPersonalizationOptions();
    let personalizationString = "";
    for (const key in personalizationOptions) {
        personalizationString += `&${key}=${encodeURIComponent(personalizationOptions[key])}`;
    }

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
      meupixsalvo = "?schave=" + pixkey + (amount ? "&valor=" + amount : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + CPFLink + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    } else if (cpf.length === 14) {
      meupixsalvo = "?schave=" + pixkey + (amount ? "&valor=" + amount : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
      textoOriginal = "?chave=" + pixkey + (amount ? "&valor=" + amount.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (description ? "&mensagem=" + description : "") + (txid ? "&txid=" + txid : "") + "&banco=" + banco + "&cpf=" + cpf + (whatsapp ? "&whatsapp=" + whatsapp : "") + (minhalogo ? "&logo=" + minhalogo : "") + (voltar ? "&voltar=" + voltar : "");
    }
      meupixsalvo += personalizationString;
      textoOriginal += personalizationString;
    // Adicionar o link ao localStorage
	const LinkCriptografado = btoa(textoOriginal); 
	    const paramschaves = "https://meupix.github.io" + textoOriginal.replace(/\ /g, '%20').trim();
    const gerarPix = encodeURIComponent(LinkCriptografado).trim();
    const editarPix = meupixsalvo.replace(/\ /g, '%20').trim();
    const compartilharPix = "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado).trim();
    let links = JSON.parse(localStorage.getItem('links')) || [];
    // Verifica se o link j√° existe
    if (links.some(item => item.titulo === titulo)) {
      alert('Este t√≠tulo j√° est√° na sua lista!');
      return; 
    }

    links.push({ 
      titulo: titulo, 
      gerarPix: gerarPix, 
      editarPix: editarPix,
      compartilharPix: compartilharPix,
      paramschaves: paramschaves	  
    }); 
    
    localStorage.setItem('links', JSON.stringify(links));  
  $('#modal-salvapix').hide();
  //document.getElementById('pixkey').value = ``;
  //document.getElementById('amount').value = ``;
  //document.getElementById('description').value = ``;
  //document.getElementById('merchantName').value = ``;
  //document.getElementById('merchantCity').value = ``;
  //document.getElementById('txid').value = ``;
  //document.getElementById('banco').value = ``;
  //document.getElementById('documento').value = ``;
  //document.getElementById('whatsapp').value = ``;
  //document.getElementById('botao-voltar').value = ``;
  //document.getElementById('add-logo').value = ``;
  document.getElementById('titulo').value = ``;
  document.getElementById('Error').innerText = 'Link Salvo com sucesso!';
  const modal = document.getElementById('modal');
  modal.style.display = 'flex';  
  setTimeout(() => {  modal.style.display = 'none';  }, 1500);
  }
}

function buildQrOptions(payload, minhalogo, personalizationOptions = {}, size = 270) {
    const defaultOptions = {
        width: size,
        height: size,
        data: payload,
        image: minhalogo || undefined,
        dotsOptions: { type: "rounded", color: "#000" },
        backgroundOptions: { color: "#ffffff" },
        imageOptions: { crossOrigin: "anonymous", imageSize: 0.4, margin: 5 },
        cornersSquareOptions: { type: "extra-rounded", color: "#000" },
        cornersDotOptions: { type: "dot", color: "#000" }
    };

    const options = { ...defaultOptions };

    if (personalizationOptions && Object.keys(personalizationOptions).length > 0 && personalizationOptions.qr_shape) {
        options.dotsOptions.type = personalizationOptions.qr_shape;

        const mainCornerType = personalizationOptions.qr_corner_shape;
        if (mainCornerType === 'dot') {
            options.cornersDotOptions.type = 'dot';
            options.cornersSquareOptions.type = undefined;
        } else {
            options.cornersSquareOptions.type = mainCornerType || 'extra-rounded';
            options.cornersDotOptions.type = undefined;
        }

        const gradientType = personalizationOptions.qr_gradient_type;
        const color1 = personalizationOptions.qr_color1;
        const color2 = personalizationOptions.qr_color2;
        const rotation = parseFloat(personalizationOptions.qr_rotation || 0);

        if (gradientType && gradientType !== 'none' && color2) {
            options.dotsOptions.gradient = {
                type: gradientType,
                rotation: rotation,
                colorStops: [{ offset: 0, color: color1 }, { offset: 1, color: color2 }]
            };
            options.dotsOptions.color = undefined;
        } else {
            options.dotsOptions.color = color1 || "#000";
            options.dotsOptions.gradient = undefined;
        }

        if (personalizationOptions.qr_use_corner_colors === 'yes') {
            const cornerGradientType = personalizationOptions.qr_corner_gradient_type;
            const cornerColor1 = personalizationOptions.qr_corner_color1;
            const cornerColor2 = personalizationOptions.qr_corner_color2;
            const cornerRotation = parseFloat(personalizationOptions.qr_corner_rotation || 0);

            let cornerOptions = {};
            if (cornerGradientType && cornerGradientType !== 'none' && cornerColor2) {
                cornerOptions.gradient = {
                    type: cornerGradientType,
                    rotation: cornerRotation,
                    colorStops: [{ offset: 0, color: cornerColor1 }, { offset: 1, color: cornerColor2 }]
                };
                cornerOptions.color = undefined;
            } else {
                cornerOptions.color = cornerColor1 || "#000";
                cornerOptions.gradient = undefined;
            }
            options.cornersSquareOptions = { ...options.cornersSquareOptions, ...cornerOptions };
            options.cornersDotOptions = { ...options.cornersDotOptions, ...cornerOptions };
        } else {
            options.cornersSquareOptions.color = undefined;
            options.cornersDotOptions.color = undefined;
            options.cornersSquareOptions.gradient = undefined;
            options.cornersDotOptions.gradient = undefined;
        }
    }

    return options;
}

let qrPreviewInstance = null;

function updateQrPreview() {
    const pixKeyInput = document.getElementById('pixkey').value || '';
    const merchantName = (document.getElementById('merchantName').value || 'Beneficiario').substring(0, 25);
    const merchantCity = (document.getElementById('merchantCity').value || 'Cidade').substring(0, 15);
    const amount = document.getElementById('amount').value.replace(/[^\d,.]/g, '') || '';
    const txid = (document.getElementById('txid').value || '***').substring(0, 20);
    const description = (document.getElementById('description').value || '').substring(0, 28);
    const minhalogo = document.getElementById('add-logo').value || 'pagamentos.files/imagens/logo.png';
    const documento = document.getElementById('documento').value.replace(/\D/g, '');
  const pixkey = formatchavepix(pixKeyInput);
    if (!pixkey || !merchantName || !merchantCity || !documento) {
        document.getElementById('showError').innerText = 'Preencha os campos obrigat√≥rios para ver a pr√©via.';
        $('.showError').show();
        setTimeout(() => { $('.showError').hide(); }, 2000);
        return;
    }

    const payload = QrCodePix(pixkey, description, merchantName, merchantCity, txid, amount);
    
    // Popula o modal
    document.getElementById('valor2-preview').textContent = amount ? formatarReal(amount.replace('.', '')) : 'R$ 0,00';
    document.getElementById('nome2-preview').textContent = merchantName;
    document.getElementById('chave-preview').textContent = pixkey;

    if (documento.length === 11) {
        document.getElementById('cpf-cnpj-preview').textContent = 'CPF';
        document.getElementById('cpf-preview').textContent = formatarCPF(documento);
    } else if (documento.length === 14) {
        document.getElementById('cpf-cnpj-preview').textContent = 'CNPJ';
        document.getElementById('cpf-preview').textContent = formatarCNPJ(documento);
    } else {
        document.getElementById('cpf-cnpj-preview').textContent = 'Documento';
        document.getElementById('cpf-preview').textContent = 'N√£o informado';
    }

    // NOVO: Adiciona txid e description ao modal
    const txidPreview = document.getElementById('infor-preview');
    const txidRowPreview = document.getElementById('infor-none-preview');
    if (txid && txid !== '***') {
        txidPreview.textContent = txid;
        txidRowPreview.style.display = 'flex';
    } else {
        txidRowPreview.style.display = 'none';
    }

    const descriptionPreview = document.getElementById('mensagem-preview');
    const descriptionRowPreview = document.getElementById('mensagem-none-preview');
    descriptionPreview.textContent = description;
    descriptionRowPreview.style.display = description ? 'flex' : 'none';

    // Gera o QR Code no modal
    const qrContainer = document.getElementById('qr-code-preview');
    qrContainer.innerHTML = ''; // Limpa QR anterior
    const qrCode = new QRCodeStyling(buildQrOptions(payload, minhalogo, getQrPersonalizationOptions(), 270));
    qrCode.append(qrContainer);

    // Armazena o payload para o bot√£o de copiar
    qrContainer.dataset.payload = payload;

    // Exibe o modal
    document.getElementById('previewModal').style.display = 'flex';
    
}

function closePreviewModal() {
    document.getElementById('previewModal').style.display = 'none';
}

function copiarqrpixPreview() {
    const payload = document.getElementById('qr-code-preview').dataset.payload;
    if (payload) {
        navigator.clipboard.writeText(payload).then(() => {
            const btn = document.getElementById('copy-qr-preview');
            btn.textContent = 'Copiado!';
            setTimeout(() => { btn.textContent = 'Copiar C√≥digo Pix'; }, 1500);
        });
    }
}

document.addEventListener('DOMContentLoaded', function () {
  // Obt√©m a URL atual e seus par√¢metros
  var url = window.location.href;		 
  const Params = new URLSearchParams(window.location.search);



  // Verifica se existem par√¢metros na URL
  if (!Params || Params.keys().next().done) {return;} // Se n√£o houver par√¢metros, sai da fun√ß√£o
  if (!Params.has('codepix')) {
  
  if (!Params.has('chave')) {
  	  
  if (!Params.has('schave')) {
  
if (!Params.has('minhavenda')) {return}

let ParamsPix;
 const minhavenda = atob(Params.get('minhavenda'));

    if (minhavenda === '') {
     exibirErro('Insira o valor no par√¢metros &minhavenda=');
    return;
    }

    if (minhavenda) {
        ParamsPix = new URLSearchParams(minhavenda);
    } else {
        ParamsPix = Params;
    }
	
	const personalizationOptions = {
		qr_shape: ParamsPix.get('qr_shape'),
		qr_corner_shape: ParamsPix.get('qr_corner_shape'),
		qr_color1: ParamsPix.get('qr_color1'),
		qr_color2: ParamsPix.get('qr_color2'),
		qr_gradient_type: ParamsPix.get('qr_gradient_type'),
		qr_rotation: ParamsPix.get('qr_rotation'),
		qr_use_corner_colors: ParamsPix.get('qr_use_corner_colors'),
		qr_corner_color1: ParamsPix.get('qr_corner_color1'),
		qr_corner_color2: ParamsPix.get('qr_corner_color2'),
		qr_corner_gradient_type: ParamsPix.get('qr_corner_gradient_type'),
		qr_corner_rotation: ParamsPix.get('qr_corner_rotation')
	};

  $('.menuvendas').html(`
  <main>
        <h1><span id="valordopagamentos" aria-live="polite">R$ 0,00</span></h1>

        <form id="pix-form">
            <label for="pix-key">Chave PIX: <span id="pix-key"></span></label>
        </form>

<div class="keypad" aria-label="Teclado Num√©rico">
        <button class="keypad-button" data-value="7">7</button>
        <button class="keypad-button" data-value="8">8</button>
        <button class="keypad-button" data-value="9">9</button>
        <button class="keypad-button" data-value="4">4</button>
        <button class="keypad-button" data-value="5">5</button>
        <button class="keypad-button" data-value="6">6</button>
        <button class="keypad-button" data-value="1">1</button>
        <button class="keypad-button" data-value="2">2</button>
        <button class="keypad-button" data-value="3">3</button>
        <button class="keypad-button backspace" data-value="backspace">‚Üê</button>
        <button class="keypad-button" data-value="0">0</button>
        <button class="keypad-button" data-value="+">+</button>
        <button class="keypad-button c" data-value="C">C</button>
        <button class="keypad-button enter" data-value="enter">‚úì</button>
    </div>

        <div class="button-group">
            <button class="Btnvendas" id="new-product">+ Novo Produto</button>
            <button class="Btnvendas" id="products">Ver Produtos</button>
        </div>
        
        <section class="transaction-history">
            <h2>Hist√≥rico de Transa√ß√µes</h2>
            <div class="history-controls">
                <div class="filter-container">
                    <input type="text" id="search-input" class="search-input" placeholder="Pesquisar por ID, valor, cliente..." aria-label="Pesquisar transa√ß√µes">
                </div>
                
                <button class="Btnvendas Limpar" id="remove">Limpar Hist√≥rico</button>
                <div class="download-options">
                    <button id="export-options-btn" class="Btnvendas">Baixar Hist√≥rico <span class="arrow-down"></span></button>
                    <div id="export-dropdown" class="dropdown-content">
                        <a href="#" id="export-print" data-month="all">Imprimir Extrato (Tudo)</a>
                        <a href="#" id="export-csv" data-month="all">Baixar em CSV (Tudo)</a>
                        <a href="#" id="export-txt" data-month="all">Baixar em TXT (Tudo)</a>
                    </div>
                </div>
            </div>
            <div id="month-tabs" class="tabs"></div>
            <div id="history-list"></div>
        </section>

    </main>
`);
  const pixKeyInput = ParamsPix.get('chave') || '';
  const banco = ParamsPix.get('banco') || '';
  const cpfInput = (ParamsPix.get('cpf') || '').substring(0, 14);
  const merchantName = (ParamsPix.get('nome') || '').substring(0, 25);
  const merchantCity = (ParamsPix.get('cidade') || '').substring(0, 15);
  const whatsapp = ParamsPix.get('whatsapp') || '';
  const botaovoltar = ParamsPix.get('voltar') || '';
  const minhalogo = ParamsPix.get('logo') || 'pagamentos.files/imagens/logo.png';
  const chavepix = formatchavepix(pixKeyInput);
  const cpf = formatchavepix(cpfInput);
  if (chavepix === '') {
    exibirErro('Insira o valor no par√¢metros &chave=');
    return;
  }
  if (merchantName === '') {
    exibirErro('Insira o valor no par√¢metros &nome=');
    return;
  }
  if (merchantCity === '') {
    exibirErro('Insira o valor no par√¢metros &cidade=');
    return;
  }
  if (cpf.length !== 11 && cpf.length !== 14) {
    exibirErro('Insira o valor no par√¢metros &cpf=');
    return;
  }
  if (banco === '') {
    exibirErro('Insira o valor no par√¢metros &banco=');
    return;
  }

  const amountDisplay = document.getElementById('valordopagamentos');
  const historyList = document.getElementById('history-list');
  const productsList = document.getElementById('products-list');
  const productListModal = document.getElementById('product-list-modal');
  const totalAmountModal = document.getElementById('total-amount-modal');

    let amount = 0;
    let selectedProducts = {};
    let transactionId;
    let Cliente;

    let keypadState = {
    currentInput: '0',    // A entrada agora √© uma string para lidar com a v√≠rgula
    previewValue: 0,      // Valor num√©rico j√° somado no preview
    previewString: ''     // String formatada do preview (Ex: "R$ 10,00 + R$ 5,50")
    };

  document.getElementById('pix-key').textContent = formatarChavePix(chavepix);
  document.getElementById('banco-do-beneficiario').textContent = banco;
  document.getElementById('nome').textContent = merchantName;

      if (cpf.length === 11) {
        document.getElementById('cpfcnpj').textContent = 'CPF:';
        document.getElementById('cpf-cnpj').textContent = formatarCPF(cpf);
    } else if (cpf.length === 14) {
        document.getElementById('cpfcnpj').textContent = 'CNPJ:';
        document.getElementById('cpf-cnpj').textContent = formatarCNPJ(cpf);
    }

  const generateTransactionID = () => {
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let id = '';
    for (let i = 0; i < 4; i++) {
      id += characters.charAt(Math.floor(Math.random() * characters.length));
    }
    return 'Pagamento' + id;
  };

  function formatarBRL(valorNumerico) {
    return (valorNumerico / 100).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
  }

  const formatarValorParaNumero = (valorFormatado) => {
    const valorNumerico = Number(valorFormatado.replace(/[^\d,]/g, '').replace('.', '').replace(',', '.')) * 100;
    return isNaN(valorNumerico) ? 0 : valorNumerico;
};

const parseInputToCents = (input) => {
    const numericString = input.replace(',', '');
    return parseInt(numericString, 10) || 0;
};

// Nova fun√ß√£o para formatar e exibir o valor
const updateAmountDisplay = () => {
    // Formata a entrada atual, dividindo por 100 para mostrar os centavos
    const cents = parseInputToCents(keypadState.currentInput);
    const formattedCurrentValue = formatarBRL(cents);
    
    if (keypadState.previewString) {
        // Se a entrada atual n√£o for "0", mostra a soma pendente
        if (keypadState.currentInput !== '0') {
            amountDisplay.textContent = `${keypadState.previewString} + ${formattedCurrentValue}`;
        } else {
            amountDisplay.textContent = keypadState.previewString;
        }
    } else {
        amountDisplay.textContent = formattedCurrentValue;
    }
};

// Fun√ß√£o para resetar o estado do teclado
const resetKeypad = () => {
    keypadState.currentInput = '0';
    keypadState.previewValue = 0;
    keypadState.previewString = '';
    updateAmountDisplay();
};

// A L√ìGICA PRINCIPAL DO TECLADO
const handleKeypadInput = (value) => {
    // Adiciona feedback visual ao bot√£o pressionado
    const button = document.querySelector(`.keypad-button[data-value="${value}"]`);
    if(button) {
        button.style.transform = 'scale(0.95)';
        setTimeout(() => button.style.transform = '', 100);
    }

    // L√≥gica para cada tecla
    switch (value) {
        case 'C':
            resetKeypad();
            break;

        case 'backspace':
            // Se estiver somando, remove o √∫ltimo item da soma
            if (keypadState.currentInput === '0' && keypadState.previewString) {
                const values = keypadState.previewString.split(' + ');
                const removedValueString = values.pop();
                const removedValueCents = formatarValorParaNumero(removedValueString);
                keypadState.previewValue -= removedValueCents;
                keypadState.previewString = values.join(' + ');
            } else { // Sen√£o, apaga o √∫ltimo d√≠gito
                keypadState.currentInput = keypadState.currentInput.slice(0, -1);
                if (keypadState.currentInput === '') {
                    keypadState.currentInput = '0';
                }
            }
            break;

        case '+':
            const currentValueCents = parseInputToCents(keypadState.currentInput);
            if (currentValueCents > 0) {
                keypadState.previewValue += currentValueCents;
                const formattedValue = formatarBRL(currentValueCents);
                keypadState.previewString = keypadState.previewString ? `${keypadState.previewString} + ${formattedValue}` : formattedValue;
                keypadState.currentInput = '0';
            }
            break;
            
        case 'enter':
            const finalCurrentValue = parseInputToCents(keypadState.currentInput);
            amount = keypadState.previewValue + finalCurrentValue; // 'amount' agora √© o valor final em centavos
            showPaymentScreen();
            resetKeypad(); // Reseta ap√≥s gerar o PIX
            break;

        default: // N√∫meros de 0 a 9
            // Limita a 2 casas decimais
            if (keypadState.currentInput.includes(',')) {
                const [, decimals] = keypadState.currentInput.split(',');
                if (decimals.length >= 2) break;
            }
            
            // Impede n√∫meros excessivamente longos
            if (keypadState.currentInput.replace(',', '').length >= 9) break;

            if (keypadState.currentInput === '0') {
                keypadState.currentInput = value;
            } else {
                keypadState.currentInput += value;
            }
            break;
    }
    updateAmountDisplay();
};

  const showPaymentScreen = () => {
    transactionId = generateTransactionID();
	let payload;
	
    if (/^(0+|00[.,]00|0[.,]00)$/.test(amount.toString().replace(/[^\d,.]/g, '')) || amount.toString().replace(/[^\d,.]/g, '') === '') {		
		payload = QrCodePix(chavepix, '', merchantName, merchantCity, transactionId, '');
    } else {
		let valor = parseFloat(amount.toString().replace(/\D/g, '')) / 100;
		payload = QrCodePix(chavepix, '', merchantName, merchantCity, transactionId, valor.toFixed(2));
    }
    
    GeraQRCodePix(payload, minhalogo, personalizationOptions);

    generateProductListModal(transactionId);
        if (keypadState.previewString) {
        const values = keypadState.previewString.split(' + ');
     if (values.length > 0) {
 
      const previewTotalElement = document.createElement('p');
      previewTotalElement.id = 'preview-total';
      previewTotalElement.textContent = amountDisplay.textContent;
      productListModal.appendChild(previewTotalElement);
        } else {
          $('#preview-total').hide();
        }
    }
    totalAmountModal.textContent = formatarBRL(amount);
	
    $(window).click(function(event) {
      if ($(event.target).is('#paymentModal')) {
        $('#paymentModal').hide();
    }
  });
setTimeout(() => {  $('#paymentModal').show();  }, 500);
};

  const generateProductListModal = (transactionId) => {
  productListModal.innerHTML = ''; 

  const products = JSON.parse(localStorage.getItem('products')) || [];
  selectedProducts = selectedProducts || {}; 

  const transactionIdElement = document.createElement('p');
  transactionIdElement.textContent = `ID da Transa√ß√£o: ${transactionId}`;
  productListModal.appendChild(transactionIdElement);

  for (const index in selectedProducts) {
    if (selectedProducts.hasOwnProperty(index)) {
      const product = products[index];
      const quantity = selectedProducts[index];

      if (quantity > 0 && product) { 
        const listItem = document.createElement('li');
        listItem.textContent = `${product.name} x${quantity} - ${formatarBRL(
          parseFloat(product.price.replace(/[^\d]/g, '')) * quantity
        )}`;
        productListModal.appendChild(listItem);
      }
    }
  }

  totalAmountModal.textContent = formatarBRL(amount);
};

  const saveTransaction = (status = 'pago') => {
    valor = formatarBRL(amount.toString());
    let meupixsalvo;
    let textoOriginal;

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
      meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
      textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
    } else if (cpf.length === 14) {
      meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
      textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
    }

	const LinkCriptografado = btoa(textoOriginal); 
	    const paramschaves = "https://meupix.github.io" + textoOriginal.replace(/\ /g, '%20').trim();
    const gerarPix = encodeURIComponent(LinkCriptografado).trim();
    const editarPix = meupixsalvo.replace(/\ /g, '%20').trim();
    const compartilharPix = "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado).trim();

    const transaction = {
      gerarPix: gerarPix, 
      editarPix: editarPix,
      compartilharPix: compartilharPix,
      paramschaves: paramschaves,
      id: transactionId,
      amount: formatarBRL(amount),
      chavepix: chavepix,
      date: new Date().toISOString(), // Use ISOString para facilitar a ordena√ß√£o e filtragem
      products: Object.entries(selectedProducts).map(([productId, quantity]) => { const product = JSON.parse(localStorage.getItem('products'))[productId]; return { name: product.name, price: product.price, quantity: quantity };}),
      status: status
    };

    let history = JSON.parse(localStorage.getItem(chavepix)) || [];
    history.unshift(transaction);
    localStorage.setItem(chavepix, JSON.stringify(history));

    document.getElementById('Error').innerText = status + ' ID: ' + transactionId + ' Valor: ' + formatarBRL(amount) + ' cria com sucesso!';
    const modal = document.getElementById('modal');
    modal.style.display = 'flex';  
    setTimeout(() => {  modal.style.display = 'none';  }, 2000);

    displayHistory();
    resetTransaction();
  };

const resetTransaction = () => {
    // amount ser√° definido no momento do 'enter', ent√£o s√≥ precisamos resetar o teclado
    resetKeypad(); 
    selectedProducts = {};
    transactionId = null;
  };

  const extrairStatus = (statusComNome) => {
    return statusComNome.split(' - ')[0];
  };

const updateDownloadLinks = () => {
    const activeTab = document.querySelector('.tab-button.active');
    const selectedMonth = activeTab?.dataset.month || 'all';
    const selectedMonthText = activeTab?.textContent || 'Tudo';

    document.getElementById('export-print').textContent = `Imprimir Extrato (${selectedMonthText})`;
    document.getElementById('export-csv').textContent = `Baixar em CSV (${selectedMonthText})`;
    document.getElementById('export-txt').textContent = `Baixar em TXT (${selectedMonthText})`;
};


  const populateMonthFilter = (history) => {
    const monthTabs = document.getElementById('month-tabs');
    const months = new Set();

    history.forEach(transaction => {
        const transactionDate = new Date(transaction.date);
        const month = transactionDate.getFullYear() + '-' + String(transactionDate.getMonth() + 1).padStart(2, '0');
        months.add(month);
    });
    
    const currentActive = document.querySelector('.tab-button.active')?.dataset.month || 'all';

    monthTabs.innerHTML = '<button class="tab-button" data-month="all">Todos</button>';

    Array.from(months).sort().reverse().forEach(month => {
        const tabButton = document.createElement('button');
        tabButton.classList.add('tab-button');
        tabButton.dataset.month = month;
        const monthName = new Date(month + '-02').toLocaleString('pt-BR', { month: 'short' });
        const year = new Date(month + '-02').getFullYear();
        tabButton.textContent = `${monthName}/${year}`;
        monthTabs.appendChild(tabButton);
    });
    
    const newActiveTab = monthTabs.querySelector(`[data-month="${currentActive}"]`) || monthTabs.querySelector('[data-month="all"]');
    newActiveTab.classList.add('active');


    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', (e) => {
            const current = document.querySelector('.tab-button.active');
            if (current) current.classList.remove('active');
            e.target.classList.add('active');
            displayHistory();
        });
    });
    updateDownloadLinks();
};

const displayHistory = () => {
    historyList.innerHTML = '';
    const history = JSON.parse(localStorage.getItem(chavepix)) || [];
    const searchQuery = document.getElementById('search-input').value.toLowerCase();
    
    populateMonthFilter(history);
    
    const selectedMonth = document.querySelector('.tab-button.active')?.dataset.month || 'all';

    if (history.length > 0) {
        const filteredHistory = history.filter(transaction => {
            const transactionDate = new Date(transaction.date);
            const transactionMonth = transactionDate.getFullYear() + '-' + String(transactionDate.getMonth() + 1).padStart(2, '0');

            const matchesMonth = selectedMonth === 'all' || transactionMonth === selectedMonth;
            
            const searchString = [
                transaction.id,
                transaction.amount,
                transaction.status,
                transaction.date
            ].join(' ').toLowerCase();

            const matchesSearch = searchString.includes(searchQuery);

            return matchesMonth && matchesSearch;
        });

        if (filteredHistory.length > 0) {
            filteredHistory.forEach((transaction, index) => {
                const entry = document.createElement('div');
                entry.classList.add('history-entry');
                
                const formattedDate = new Date(transaction.date).toLocaleDateString('pt-BR');
                entry.innerHTML = `<span>ID: ${transaction.id} - ${transaction.amount} - ${formattedDate} - ${transaction.status}</span>`;

                const statusReal = extrairStatus(transaction.status);
                const linkActions = document.createElement('div');
                linkActions.classList.add('link-actions');

                if (statusReal === 'Aguardando Pagamento') {
                    const confirmButton = document.createElement('button');
                    confirmButton.textContent = 'Confirmar Pagamento';
                    confirmButton.classList.add('confirm-payment');
                    confirmButton.dataset.id = transaction.id;
                    confirmButton.addEventListener('click', () => confirmarPagamento(transaction.id));
                    linkActions.appendChild(confirmButton);

                    const btnCompartilhar = document.createElement('button');
                    btnCompartilhar.textContent = 'Compartilhar';
                    btnCompartilhar.classList.add('confirm-payment');
                    btnCompartilhar.onclick = function() {
                        document.getElementById('linkcodificador').value = transaction.compartilharPix;
                        document.getElementById('urlpix').value = transaction.paramschaves;
                        document.getElementById('salva-meu-pix').value = "https://meupix.github.io" + transaction.editarPix;
                        $('#mainContent').addClass('overlay');
                        $('#compartilhar').show();
                        $('#close-check').show();
                        $('#CarregaCompartilhar').show();
                        $('#CarregaCompartilhar').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-compartilhar.png" alt="">`);
                        GerarLinkCurto(transaction.compartilharPix, transaction.compartilharPix);
                        document.getElementById('textocopiado').innerText = transaction.status + ' ID: ' + transaction.id + ' Valor: ' + transaction.amount;
                        document.getElementById('titulocopiado').innerText = 'Pagamento criado com sucesso!';
                        telacopiado = document.getElementById('telacopiado');
                        telacopiado.style.display = 'flex';
                        setTimeout(() => { telacopiado.style.display = 'none'; }, 3000);
                    };
                    linkActions.appendChild(btnCompartilhar);
                }

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Apagar';
                deleteButton.classList.add('cancel-products');
                deleteButton.dataset.id = transaction.id;
                deleteButton.addEventListener('click', handleDeleteTransaction);
                linkActions.appendChild(deleteButton);

                entry.appendChild(linkActions);
                historyList.appendChild(entry);
            });
        } else {
            historyList.textContent = "Nenhuma transa√ß√£o encontrada para os filtros aplicados.";
        }
    } else {
        historyList.textContent = "Nenhuma transa√ß√£o no hist√≥rico.";
    }
    updateDownloadLinks();
};

const handleDeleteTransaction = (event) => {
    const transactionId = event.target.dataset.id;
    if (confirm('Tem certeza de que deseja apagar esta transa√ß√£o?')) {
        let history = JSON.parse(localStorage.getItem(chavepix)) || [];
        const historyIndex = history.findIndex(t => t.id === transactionId);
        if (historyIndex > -1) {
            history.splice(historyIndex, 1);
            localStorage.setItem(chavepix, JSON.stringify(history));
            displayHistory();
        }
    }
};

const confirmarPagamento = (transactionId) => {
    let history = JSON.parse(localStorage.getItem(chavepix)) || [];
    const transaction = history.find(t => t.id === transactionId);
    if (transaction) {
        transaction.status = 'pago';
        localStorage.setItem(chavepix, JSON.stringify(history));
        displayHistory();
    }
};


  const displayProducts = () => {
    productsList.innerHTML = '';
    const products = JSON.parse(localStorage.getItem('products')) || [];
    selectedProducts = {};

    if (products.length === 0) {
        productsList.textContent = "Nenhum produto cadastrado.";
        return;
    }

    products.forEach((product, index) => {
        const entry = document.createElement('div');
        entry.classList.add('product-entry');
        entry.innerHTML = `
            <span>${product.name} - ${product.price}</span>
            <div class="quantity-controls">
                <button data-index="${index}" class="quantity-btn decrement">-</button>
                <span class="quantity-display" id="quantity-${index}">0</span>
                <button data-index="${index}" class="quantity-btn increment">+</button>
            </div>
            <button class="edit-product" data-index="${index}">Editar</button>
            <button class="cancel-products" data-index="${index}">Apagar</button>
        `;
        productsList.appendChild(entry);
    });

    addEventListenersToProductButtons();
    addEventListenersToEditButtons();
};

const addEventListenersToEditButtons = () => {
    const editButtons = document.querySelectorAll('.edit-product');
    editButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            const index = event.target.getAttribute('data-index');
            abrirModal(index);
        });
    });
};

const abrirModal = (index) => {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const product = products[index];

    document.getElementById('edit-name').value = product.name;
    document.getElementById('edit-price').value = product.price;

    const modal = document.getElementById('modal-editar');
    modal.style.display = 'block';
    modal.setAttribute('aria-hidden', 'false');

    document.getElementById('edit-name').focus();

    const editForm = document.getElementById('edit-form');
    editForm.onsubmit = (event) => {
        event.preventDefault();
        salvarEdicao(index);
    };

window.addEventListener('click', (event) => {
    if (event.target === modal) {
        fechareditform();
    }
});
};

const fechareditform = () => {
    const modal = document.getElementById('modal-editar');
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
};

const salvarEdicao = (index) => {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const product = products[index];
    const newName = document.getElementById('edit-name').value;
    const newPrice = document.getElementById('edit-price').value;

    if (newName && newPrice) {
        product.name = newName;
        product.price = newPrice;

        localStorage.setItem('products', JSON.stringify(products));
        fechareditform();
        displayProducts();
    }
};

const addEventListenersToProductButtons = () => {
    document.querySelectorAll('.increment, .decrement').forEach(button => {
        button.addEventListener('click', (event) => {
            const index = parseInt(event.target.dataset.index, 10);
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const product = products[index];

            if (event.target.classList.contains('increment')) {
                selectedProducts[index] = (selectedProducts[index] || 0) + 1;
            } else if (event.target.classList.contains('decrement') && selectedProducts[index] > 0) {
                selectedProducts[index] -= 1;
            }
            document.getElementById(`quantity-${index}`).textContent = selectedProducts[index] || 0;
        });
    });

    const deleteProductButtons = document.querySelectorAll('.cancel-products');
    deleteProductButtons.forEach(button => {
        button.addEventListener('click', handleDeleteProduct);
    });
};

const handleDeleteProduct = (event) => {
    const index = parseInt(event.target.dataset.index, 10);
    let products = JSON.parse(localStorage.getItem('products')) || [];

    if (index < 0 || index >= products.length) {
        alert('√çndice do produto inv√°lido!');
        return;
    }

    const productName = products[index].name;

    if (confirm(`Tem certeza de que deseja apagar o produto "${productName}"?`)) {
        products.splice(index, 1);
        localStorage.setItem('products', JSON.stringify(products)); 
        displayProducts();
    }
};

  const addDevendoTransaction = () => {

    $('#modalagendamento').show();

    const confirmButtonagendamento = document.getElementById('modalConfirm');
    confirmButtonagendamento.addEventListener('click', () => {
        let Cliente = document.getElementById('clienteNome').value;

        if (!Cliente) {
          document.getElementById('Error-nome-agendamento').innerText = 'Por favor, insira o nome do cliente antes de continuar.';
        setTimeout(() => {  document.getElementById('Error-nome-agendamento').innerText = '';  }, 1500);
        return;
        }

        $('#modalagendamento').hide();
        $('#clienteNome').val('');
        valor = formatarBRL(amount.toString());
        let meupixsalvo;
        let textoOriginal;

        if (cpf.length === 11) {
            const CPFLink = LinkCPF(cpf);
            meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
            textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
        } else if (cpf.length === 14) {
            meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
            textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
        }

        const LinkCriptografado = btoa(textoOriginal);
        const paramschaves = "https://meupix.github.io" + textoOriginal.replace(/\ /g, '%20').trim();
        const gerarPix = encodeURIComponent(LinkCriptografado).trim();
        const editarPix = meupixsalvo.replace(/\ /g, '%20').trim();
        const compartilharPix = "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado).trim();

        const transaction = {
          gerarPix: gerarPix, 
          editarPix: editarPix,
          compartilharPix: compartilharPix,
          paramschaves: paramschaves,
          id: transactionId,
          amount: formatarBRL(amount),
          chavepix: chavepix,
          date: new Date().toISOString(),
          products: Object.entries(selectedProducts).map(([productId, quantity]) => { const product = JSON.parse(localStorage.getItem('products'))[productId]; return { name: product.name, price: product.price, quantity: quantity };}),
          status: 'Aguardando Pagamento - ' + Cliente,
        };

        let history = JSON.parse(localStorage.getItem(chavepix)) || [];
        history.unshift(transaction);
        localStorage.setItem(chavepix, JSON.stringify(history));
    
        document.getElementById('textocopiado').innerText = 'Cliente: ' + Cliente + ' ID: ' + transactionId + ' Valor: ' + formatarBRL(amount) ;
       document.getElementById('titulocopiado').innerText = 'Pagamento cria com sucesso!';
       let $telacopiado = $('#telacopiado');
       $telacopiado.css('display', 'flex'); 
       setTimeout(() => { $telacopiado.fadeOut(); }, 3500);
    
       $('#mainContent').addClass('overlay');
       $('#compartilhar').show();
       $('#close-check').show();
       $('#CarregaCompartilhar').show();
       $('#CarregaCompartilhar').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-compartilhar.png" alt="">`);
       GerarLinkCurto(compartilharPix, compartilharPix);

        displayHistory();
        resetTransaction();
        $('#paymentModal').hide();
    });
};

  document.getElementById('remove').addEventListener('click', () => {
    if (confirm("Tem certeza de que deseja limpar o hist√≥rico de transa√ß√µes?")) {
      localStorage.removeItem(chavepix);
      displayHistory();
    }
  });

  document.querySelectorAll('.keypad-button').forEach(button => {
    button.addEventListener('click', () => handleKeypadInput(button.dataset.value));
  });

  document.getElementById('pago-button').addEventListener('click', () => {
    saveTransaction();
    $('#paymentModal').hide();
  });

  document.getElementById('compartilhar-pagameto-button').addEventListener('click', () => {

    valor = formatarBRL(amount.toString());
    let meupixsalvo;
    let textoOriginal;

    if (cpf.length === 11) {
      const CPFLink = LinkCPF(cpf); 
      meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
      textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + CPFLink + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
    } else if (cpf.length === 14) {
      meupixsalvo = "?schave=" + chavepix + (valor ? "&valor=" + valor : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
      textoOriginal = "?chave=" + chavepix + (valor ? "&valor=" + valor.replace(/[^\d,.]/g, '') : "") + "&nome=" + merchantName + "&cidade=" + merchantCity + (transactionId ? "&txid=" + transactionId : "") + "&banco=" + banco + "&cpf=" + cpf + (minhalogo ? "&logo=" + minhalogo : "") + (whatsapp ? "&whatsapp=" + whatsapp : "") + (botaovoltar ? "&voltar=" + botaovoltar : "");
    }

	  const LinkCriptografado = btoa(textoOriginal); 
	  const paramschaves = "https://meupix.github.io" + textoOriginal.replace(/\ /g, '%20').trim();
    const gerarPix = encodeURIComponent(LinkCriptografado).trim();
    const editarPix = meupixsalvo.replace(/\ /g, '%20').trim();
    const compartilharPix = "https://meupix.github.io?codepix=" + encodeURIComponent(LinkCriptografado).trim();

    $('#linkcodificador').val(compartilharPix);
    $('#urlpix').val(paramschaves);
    $('#salva-meu-pix').val("https://meupix.github.io" + editarPix);

    addDevendoTransaction();

  });

  const productModal = document.getElementById('productModal');
  const newProductButton = document.getElementById('new-product');
  const closeProductModal = productModal.querySelector('.close-button');

  newProductButton.onclick = () => {
    productModal.style.display = 'block';
  };

  closeProductModal.onclick = () => {
    productModal.style.display = 'none';
  };

  document.getElementById('product-form').addEventListener('submit', (event) => {
    event.preventDefault();
    const name = document.getElementById('product-name').value.trim();
    const price = document.getElementById('product-price').value;
    let products = JSON.parse(localStorage.getItem('products')) || [];
    const existingProduct = products.find(product => product.name.toLowerCase() === name.toLowerCase());
    if (existingProduct) {
      alert('J√° existe um produto com este nome!');
      return;
    }
    const product = { name, price };
    products.unshift(product);
    localStorage.setItem('products', JSON.stringify(products));
    productModal.style.display = 'none';
    document.getElementById('product-form').reset();

    document.getElementById('Error').innerText = 'produto: ' + name + ' criado com sucesso!';
  const modal = document.getElementById('modal');
  modal.style.display = 'flex';  
  setTimeout(() => {  modal.style.display = 'none';  }, 1500);
  });

  const productsModal = document.getElementById('productsModal');
  const productsButton = document.getElementById('products');
  const closeProductsModal = productsModal.querySelector('.close-button');
  const cancelProductsButton = document.getElementById('cancel-products');
  const addProductsButton = document.getElementById('add-products');

  productsButton.onclick = () => {
    displayProducts();
    productsModal.style.display = 'block';
  };

  closeProductsModal.onclick = () => {
    productsModal.style.display = 'none';
    selectedProducts = {};
  };

  cancelProductsButton.onclick = () => {
    productsModal.style.display = 'none';
    displayProducts();
  };

  addProductsButton.addEventListener('click', () => {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    amount = 0;
    for (const index in selectedProducts) {
      if (selectedProducts.hasOwnProperty(index)) {
        const product = products[index];
        const quantity = selectedProducts[index];
        amount += parseFloat(product.price.replace(/[^\d]/g, '')) * quantity;
      }
    }
    transactionId = generateTransactionID();
	let payload;

    if (/^(0+|00[.,]00|0[.,]00)$/.test(amount.toString().replace(/[^\d,.]/g, '')) || amount.toString().replace(/[^\d,.]/g, '') === '') {		
		payload = QrCodePix(chavepix, '', merchantName, merchantCity, transactionId, '');
    } else {
		let valor = parseFloat(amount.toString().replace(/\D/g, '')) / 100;
		payload = QrCodePix(chavepix, '', merchantName, merchantCity, transactionId, valor.toFixed(2));
    }
    GeraQRCodePix(payload, minhalogo, personalizationOptions);
    generateProductListModal(transactionId);
    totalAmountModal.textContent = formatarBRL(amount);
    
    previewValue = 0;
    previewString = '';
    const paymentModal = document.getElementById('paymentModal');
	


    window.addEventListener('click', (event) => {
		if (event.target === paymentModal) {
		  paymentModal.style.display = 'none';
		}
	});
		setTimeout(() => { paymentModal.style.display = 'block'; productsModal.style.display = 'none';  }, 500);
    updateAmountDisplay();
  });

  window.onclick = (event) => {
    if (event.target === productModal) {
      productModal.style.display = 'none';
    } else if (event.target === productsModal) {
      productsModal.style.display = 'none';
    }
  };

  const closePaymentModalButton = document.querySelector('#paymentModal .close-button');
  if (closePaymentModalButton) {
    closePaymentModalButton.addEventListener('click', () => {
      document.getElementById('paymentModal').style.display = 'none';
    });
  }

const printHistory = (history) => {
  if (!history || history.length === 0) {
    alert("N√£o h√° transa√ß√µes neste hist√≥rico para imprimir.");
    return;
  }
  const now = new Date();
  const dateForFile = now.toISOString().slice(0, 10);
  const timeForFile = now.toTimeString().slice(0, 8).replace(/:/g, '-'); 
  const fileNameTitle = `Extrato_PIX_${chavepix}_${dateForFile}_${timeForFile}`;

  const parseCurrency = (currencyString) => {
    if (!currencyString || typeof currencyString !== 'string') return 0;
    const numberString = currencyString.replace(/[^\d,]/g, '').replace(',', '.');
    return parseFloat(numberString) || 0;
  };

  let totalRecebido = 0;
  let totalAReceber = 0;

  history.forEach(transaction => {
    const valorNumerico = parseCurrency(transaction.amount);
    if (transaction.status === 'pago') {
      totalRecebido += valorNumerico;
    } else if (transaction.status && transaction.status.startsWith('Aguardando Pagamento')) {
      totalAReceber += valorNumerico;
    }
  });

  const formattedTotalRecebido = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalRecebido);
  const formattedTotalAReceber = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalAReceber);
  
  const keySvg = `
  <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48">
  <path fill="#4db6ac" d="M11.9,12h-0.68l8.04-8.04c2.62-2.61,6.86-2.61,9.48,0L36.78,12H36.1c-1.6,0-3.11,0.62-4.24,1.76	l-6.8,6.77c-0.59,0.59-1.53,0.59-2.12,0l-6.8-6.77C15.01,12.62,13.5,12,11.9,12z"></path><path fill="#4db6ac" d="M36.1,36h0.68l-8.04,8.04c-2.62,2.61-6.86-2.61-9.48,0L11.22,36h0.68c1.6,0,3.11-0.62,4.24-1.76	l6.8-6.77c0.59-0.59,1.53-0.59,2.12,0l6.8,6.77C32.99,35.38,34.5,36,36.1,36z"></path><path fill="#4db6ac" d="M44.04,28.74L38.78,34H36.1c-1.07,0-2.07-0.42-2.83-1.17l-6.8-6.78c-1.36-1.36-3.58-1.36-4.94,0	l-6.8,6.78C13.97,33.58,12.97,34,11.9,34H9.22l-5.26-5.26c-2.61-2.62-2.61-6.86,0-9.48L9.22,14h2.68c1.07,0,2.07,0.42,2.83,1.17	l6.8,6.78c0.68,0.68,1.58,1.02,2.47,1.02s1.79-0.34,2.47-1.02l6.8-6.78C34.03,14.42,35.03,14,36.1,14h2.68l5.26,5.26	C46.65,21.88,46.65,26.12,44.04,28.74z"></path>
  </svg>`;

  const keyIconSvg = 'data:image/svg+xml;utf8,' + encodeURIComponent(keySvg);

  let htmlContent = `
    <html>
      <head>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
        <title>${fileNameTitle}</title>
        <style>
          body { font-family: 'Roboto', sans-serif; margin: 0; background-color: #f4f4f9; }
          .container { max-width: 800px; margin: 20px auto; padding: 25px; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
          .header { display: flex; align-items: center; border-bottom: 2px solid #e0e0e0; padding-bottom: 15px; margin-bottom: 20px; }
          .header img { width: 50px; height: 50px; margin-right: 15px; }
          .header h1 { font-size: 24px; color: #333; margin: 0; }
          .summary { background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 25px; display: flex; justify-content: space-around; text-align: center; }
          .summary-item h3 { margin: 0 0 5px 0; font-size: 14px; color: #555; font-weight: 500; text-transform: uppercase; }
          .summary-item p.recebido { margin: 0; font-size: 20px; color: #28a745; font-weight: 700; }
          .summary-item p.a-receber { margin: 0; font-size: 20px; color: #fd7e14; font-weight: 700; }
          .transaction-list { list-style: none; padding: 0; }
          .transaction-item { border-bottom: 1px solid #eee; padding: 15px 5px; display: flex; justify-content: space-between; align-items: flex-start; }
          .transaction-details .info-line { display: flex; align-items: center; margin-bottom: 8px; font-size: 14px; color: #444; }
          .info-line .material-symbols-outlined { margin-right: 8px; opacity: 0.7; font-size: 20px; }
          .info-line img { width: 18px; height: 18px; margin-right: 8px; opacity: 0.7; }
          .product-list { list-style: none; padding-left: 28px; margin: 5px 0 0 0; font-size: 13px; color: #666; }
          .transaction-amount { text-align: right; min-width: 120px; }
          .transaction-amount .value { font-size: 18px; font-weight: 700; color: #333; margin-bottom: 5px; }
          .status { font-size: 12px; font-weight: 700; padding: 3px 8px; border-radius: 12px; color: #fff; text-align: center; }
          .status-pago { background-color: #28a745; }
          .status-aguardando { background-color: #fd7e14; }
          .footer { text-align: center; margin-top: 30px; font-size: 12px; color: #999; }
          @media print { body { background-color: #fff; } .container { box-shadow: none; margin: 0; max-width: 100%; border: 1px solid #ccc; } }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header"><img src="${minhalogo}" alt="Logo PIX"><h1>Extrato PIX</h1></div>
          <div class="summary">
            <div class="summary-item"><h3>Total Recebido</h3><p class="recebido">${formattedTotalRecebido}</p></div>
            <div class="summary-item"><h3>A Receber</h3><p class="a-receber">${formattedTotalAReceber}</p></div>
          </div>
          <ul class="transaction-list">
  `;

  history.forEach(transaction => {
    const productsHtml = transaction.products.length > 0
      ? `<ul class="product-list">${transaction.products.map(p => `<div>${p.name} (x${p.quantity})</div>`).join('')}</ul>` : '';
    
    let statusHtml = '';
    let clienteHtml = '';
    if (transaction.status === 'pago') {
      statusHtml = '<div class="status status-pago">PAGO</div>';
    } else if (transaction.status && transaction.status.startsWith('Aguardando Pagamento')) {
      const clienteNome = transaction.status.replace('Aguardando Pagamento - ', '').trim();
      statusHtml = '<div class="status status-aguardando">AGUARDANDO</div>';
      clienteHtml = `<div class="info-line"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVR4nO3UQUrDQBSH8R8umqVdWrrWK+hJxEPYHsNuRPFAurR1ZfEAuinVlUUUXVYGJiCCdNJObCn54A8heeGbl8wbGjaUAn2M8BETrnvxWS10Mcb8j9zHmqwUC6Q/5Vk77ydIy5zmFN9VEA9zit8riENtNuYVs5aO37biH/fWtauLOKMpc9ySme4CeS0nV0krfsph3HAht/Fe9k4b/pUdHGGAGzzjK2aKa5zhMNauTAcXeKkwx2FR59hbRtjGFT6XOKfLhHcvsZsqPcDTCsLfecR+ivgho7TMOEU8rUE8SRGfYJZR+orjFHHDdvENyZP0ibBvoI8AAAAASUVORK5CYII=" alt="user--v1">
        <strong>${clienteNome}</strong></div>`;
    }
    const formattedDate = new Date(transaction.date).toLocaleDateString('pt-BR');
    htmlContent += `
      <li class="transaction-item">
        <div class="transaction-details">
          ${clienteHtml}
          <div class="info-line"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAYElEQVR4nGNgGEBwlIGB4TAV1WGA/1BMLXVg4MXAwPAYSdN/EjFIryc+Cygx/D8UPyLGu5TiEWABueD/qAWEwKgFBMGoBdSzwIaBdGBLjAU0L649oQooMdyDDN8zjGAAAPyMrSC4RAvoAAAAAElFTkSuQmCC" alt="calendar--v1">
            <span>${formattedDate} | ID: ${transaction.id}</span></div>
          <div class="info-line"><img src="${keyIconSvg}" alt="Chave"><span>${transaction.chavepix}</span></div>
          <div class="info-line"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR4nN2TPQoCMRBGnyBYiwewsxc8hKuIp/EI4ilEEDyC5aK4pZ3llrs2WtmoCP4RSLEgrJlsIuqD6Sbfy88E/oUQeAA3YOhDEGmBqhNQwxPzjMi2FnmCjgPBJk9QAuKCgt67axoUCF+avEMVOFqE34EWhkwsBFMENIXhZ6COkLVAMJKGq4+2N9z5DKhIBWMdEOrRdYqaoitwARp4oAwcLKYokkj6wE4oWPFNdIEtkAKBg74X0szREwd9nxcEenECtB30/TBPua+9xM7fMm8AAAAASUVORK5CYII=" alt="shopping-cart">
            ${productsHtml ? `${productsHtml}` : '<span>Nenhum produto listado</span>'}</div>
        </div>
        <div class="transaction-amount">
          <div class="value">${transaction.amount}</div>
          ${statusHtml}
        </div>
      </li>
    `;
  });

  htmlContent += `
          </ul>
          <div class="footer">Relat√≥rio gerado em ${new Date().toLocaleString('pt-BR')} para a chave: ${chavepix}</div>
        </div>
      </body>
    </html>
  `;

  const printWindow = window.open('', '_blank');
  printWindow.document.write(htmlContent);
  printWindow.document.close();
  setTimeout(() => {printWindow.print();  }, 500);
};

const downloadHistoryAsCSV = (history) => {
    if (!history || history.length === 0) {
        alert("N√£o h√° transa√ß√µes para exportar.");
        return;
    }

    let csvContent = "data:text/csv;charset=utf-8,";
    csvContent += "ID;Data;Valor;Status;Cliente;Produtos\r\n";

    history.forEach(transaction => {
        const products = transaction.products.map(p => `${p.name} (x${p.quantity})`).join(' | ');
        const cliente = transaction.status.startsWith('Aguardando Pagamento - ') ? transaction.status.replace('Aguardando Pagamento - ', '').trim() : '';
        const status = extrairStatus(transaction.status);
        const date = new Date(transaction.date).toLocaleString('pt-BR');
        const row = [transaction.id, date, transaction.amount, status, cliente, `"${products}"`].join(';');
        csvContent += row + "\r\n";
    });

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", `historico_pix_${chavepix}.csv`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
};

const downloadHistoryAsTXT = (history) => {
    if (!history || history.length === 0) {
        alert("N√£o h√° transa√ß√µes para exportar.");
        return;
    }

    let txtContent = `Hist√≥rico de Transa√ß√µes - Chave PIX: ${chavepix}\r\n`;
    txtContent += `Gerado em: ${new Date().toLocaleString('pt-BR')}\r\n`;
    txtContent += "================================================\r\n\r\n";

    history.forEach(transaction => {
        const products = transaction.products.map(p => `\t- ${p.name} (x${p.quantity})`).join('\r\n');
        const cliente = transaction.status.startsWith('Aguardando Pagamento - ') ? `\r\nCliente: ${transaction.status.replace('Aguardando Pagamento - ', '').trim()}` : '';
        const status = extrairStatus(transaction.status);
        const date = new Date(transaction.date).toLocaleString('pt-BR');
        
        txtContent += `ID: ${transaction.id}\r\n`;
        txtContent += `Data: ${date}\r\n`;
        txtContent += `Valor: ${transaction.amount}\r\n`;
        txtContent += `Status: ${status}${cliente}\r\n`;
        if(products) txtContent += `Produtos:\r\n${products}\r\n`;
        txtContent += "------------------------------------------------\r\n";
    });

    const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.setAttribute("href", url);
    link.setAttribute("download", `historico_pix_${chavepix}.txt`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
};

const handleDownload = (format) => {
    const allHistory = JSON.parse(localStorage.getItem(chavepix)) || [];
    const selectedMonth = document.querySelector('.tab-button.active')?.dataset.month || 'all';
    
    let historyToProcess;

    if (selectedMonth === 'all') {
        historyToProcess = allHistory;
    } else {
        historyToProcess = allHistory.filter(transaction => {
            const transactionDate = new Date(transaction.date);
            const transactionMonth = transactionDate.getFullYear() + '-' + String(transactionDate.getMonth() + 1).padStart(2, '0');
            return transactionMonth === selectedMonth;
        });
    }

    if (historyToProcess.length === 0) {
        alert('N√£o h√° transa√ß√µes para o per√≠odo selecionado.');
        return;
    }

    switch (format) {
        case 'print':
            printHistory(historyToProcess);
            break;
        case 'csv':
            downloadHistoryAsCSV(historyToProcess);
            break;
        case 'txt':
            downloadHistoryAsTXT(historyToProcess);
            break;
    }
};

document.getElementById('search-input').addEventListener('input', displayHistory);

// --- BLOCO CORRIGIDO ---
// Dropdown de exporta√ß√£o (corrigido e mais robusto)
const exportBtn = document.getElementById('export-options-btn');
const exportDropdown = document.getElementById('export-dropdown');

exportBtn.addEventListener('click', (event) => {
    // Impede que o clique no bot√£o feche o menu imediatamente (devido ao listener da window)
    event.stopPropagation(); 
    exportDropdown.classList.toggle('show');
});

window.addEventListener('click', (event) => {
    // Se o menu estiver aberto e o clique for fora do container do dropdown, fecha o menu
    if (exportDropdown.classList.contains('show') && !event.target.closest('.download-options')) {
        exportDropdown.classList.remove('show');
    }
});
// --- FIM DO BLOCO CORRIGIDO ---

// Bot√µes do Dropdown agora chamam o manipulador
document.getElementById('export-print').addEventListener('click', (e) => { e.preventDefault(); handleDownload('print'); });
document.getElementById('export-csv').addEventListener('click', (e) => { e.preventDefault(); handleDownload('csv'); });
document.getElementById('export-txt').addEventListener('click', (e) => { e.preventDefault(); handleDownload('txt'); });


// --- CHAMADA INICIAL ---
  displayHistory();

    $('#Carregando').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-pix.png" alt="">`);
    setTimeout(() => { $('.dados').show(); $('.caixatex').hide(); $('#minhavenda').show(); $('#Carregando').hide(); $('#desfocfundo').removeClass('overlay'); }, 1000);

    return;
  
  } else {

  const pixKeyInput = Params.get('schave') || '';
  const nome = Params.get('nome') || '';
  const cidade = Params.get('cidade') || '';
  const cpfInput = Params.get('cpf') || '';
  const banco = Params.get('banco') || '';
   const schave = formatchavepix(pixKeyInput);
   const cpf = formatchavepix(cpfInput);
  if (schave === '') {
    exibirErro('Insira o valor no par√¢metros &schave=');
    return;
  }
  if (nome === '') {
    exibirErro('Insira o valor no par√¢metros &nome=');
    return;
  }
  if (cidade === '') {
    exibirErro('Insira o valor no par√¢metros &cidade=');
    return;
  }
  if (cpf.length !== 11 && cpf.length !== 14) {
    exibirErro('Insira o valor no par√¢metros &cpf=');
    return;
  }
  if (banco === '') {
    exibirErro('Insira o valor no par√¢metros &banco=');
    return;
  }

  const tipoChaveDetectado = detectarTipoChave(schave);
  const chSelector = document.getElementById('ChavesSelector');
  if (chSelector) {
  chSelector.value = tipoChaveDetectado;
  chSelector.dispatchEvent(new Event('change'));
  }
            


  // Preenche os campos do formul√°rio com os valores dos par√¢metros
  document.getElementById('pixkey').value = Params.get('schave') || '';
  document.getElementById('amount').value = Params.get('valor') || '';
  document.getElementById('merchantName').value = (Params.get('nome') || '').substring(0, 25);
  document.getElementById('merchantCity').value = (Params.get('cidade') || '').substring(0, 15);
  document.getElementById('description').value = (Params.get('mensagem') || '').substring(0, 28);
  document.getElementById('txid').value = (Params.get('txid') || '').substring(0, 20);
  document.getElementById('banco').value = Params.get('banco') || '';
  document.getElementById('documento').value = (Params.get('cpf') || '').substring(0, 14);
  document.getElementById('whatsapp').value = Params.get('whatsapp') || '';
  document.getElementById('botao-voltar').value = Params.get('voltar') || '';
  document.getElementById('add-logo').value = Params.get('logo') || '';
  document.getElementById('shape').value = Params.get('qr_shape') || '';
  document.getElementById('cornerShape').value = Params.get('qr_corner_shape') || '';
  document.getElementById('color1').value = Params.get('qr_color1') || '';
  document.getElementById('color2').value = Params.get('qr_color2') || '';
  document.getElementById('gradientType').value = Params.get('qr_gradient_type') || '';
  document.getElementById('rotation').value = Params.get('qr_rotation') || '';
  document.getElementById('useCornerColors').value = Params.get('qr_use_corner_colors') || '';
  document.getElementById('cornerColor1').value = Params.get('qr_corner_color1') || '';
  document.getElementById('cornerColor2').value = Params.get('qr_corner_color2') || '';
  document.getElementById('cornerGradientType').value = Params.get('qr_corner_gradient_type') || '';
  document.getElementById('cornerRotation').value = Params.get('qr_corner_rotation') || '';

  //Limpa os par√¢metros da URL
  //limparParametros();
        initPixFormatters();
        if (document.getElementById('pixkey')) document.getElementById('pixkey').dispatchEvent(new Event('blur'));
  // Exibe os campos do formul√°rio e oculta a anima√ß√£o de carregamento
  setTimeout(() => {  $('.dados').show(); $('#Carregando').hide(); $('#desfocfundo').removeClass('overlay'); }, 1000);
  return;
  }
	 
  } else {
  ParamsPix = new URLSearchParams(Params); // Obt√©m a URL atual e seus  ex:?chave=SuaChave&valor=00.00&nome=SeuNome&cidade=SuaCidade&mensagem=Minha Loja&txid=IDdoPagamento&banco=***&cpf=SeuFPFouCNPJ&whatsapp=true&voltar=true&logo=https://ffcodiguin.vercel.app/verificador/imagens/Logo_nova.png
  }
  
  } else {


  const Paramsdescriptografado = atob(Params.get('codepix'));
  if (Paramsdescriptografado === '') {
  exibirErro('Insira o valor no par√¢metros &codepix=');
  return;
  }
  ParamsPix = new URLSearchParams(Paramsdescriptografado); // Obt√©m a URL atual e seus  ex:?codepix=P2NoYXZlPVN1YUNoYXZlJnZhbG9yPTAwLjAwJm5vbWU9U2V1Tm9tZSZjaWRhZGU9U3VhQ2lkYWRlJm1lbnNhZ2VuPU1pbmhhIExvamEmdHhpZD1JRGRvUGFnYW1lbnRvJmJhbmNvPSoqKiZjcGY9U2V1RlBGb3VDTlBKJndoYXRzYXBwPXRydWUmdm9sdGFyPXRydWUmbG9nbz1odHRwczovL2ZmY29kaWd1aW4udmVyY2VsLmFwcC92ZXJpZmljYWRvci9pbWFnZW5zL0xvZ29fbm92YS5wbmc=
  }
  
  const pixKeyInput = ParamsPix.get('chave') || '';
    let amount = ParamsPix.get('valor') || '';
  const merchantName = (ParamsPix.get('nome') || '').substring(0, 25);
  const merchantCity = (ParamsPix.get('cidade') || '').substring(0, 15);
  const description = (ParamsPix.get('mensagem') || '').substring(0, 28);
  const txid = (ParamsPix.get('txid') || '').substring(0, 20);
  const banco = ParamsPix.get('banco') || '';
  const cpfInput = (ParamsPix.get('cpf') || '').substring(0, 14);
  const whatsapp = ParamsPix.get('whatsapp') || '';
  const voltar = ParamsPix.get('voltar') || '';
  const minhalogo = ParamsPix.get('logo') || 'pagamentos.files/imagens/logo.png';
  const pixkey = formatchavepix(pixKeyInput);
  const cpf = formatchavepix(cpfInput);

  const personalizationOptions = {
	qr_shape: ParamsPix.get('qr_shape'),
	qr_corner_shape: ParamsPix.get('qr_corner_shape'),
	qr_color1: ParamsPix.get('qr_color1'),
	qr_color2: ParamsPix.get('qr_color2'),
	qr_gradient_type: ParamsPix.get('qr_gradient_type'),
	qr_rotation: ParamsPix.get('qr_rotation'),
	qr_use_corner_colors: ParamsPix.get('qr_use_corner_colors'),
	qr_corner_color1: ParamsPix.get('qr_corner_color1'),
	qr_corner_color2: ParamsPix.get('qr_corner_color2'),
	qr_corner_gradient_type: ParamsPix.get('qr_corner_gradient_type'),
	qr_corner_rotation: ParamsPix.get('qr_corner_rotation')
  };

  const idadaloja = ParamsPix.get('idadaloja') || '';
  iddopagamento = ParamsPix.get('iddopagamento') || '';

		 // Valida os par√¢metros obrigat√≥rios
  if (pixkey === '') {
    exibirErro('Insira o valor no par√¢metros &chave=');
    return;
  }

  if (merchantName === '') {
    exibirErro('Insira o valor no par√¢metros &nome=');
    return;
  }

  if (merchantCity === '') {
    exibirErro('Insira o valor no par√¢metros &cidade=');
    return;
  }

  if (banco === '') {
    exibirErro('Insira o valor no par√¢metros &banco=');
    return;
  }

  // Formata o CPF ou CNPJ, se fornecido
  if (cpf.length === 11) {
    // CPF v√°lido
  } else if (cpf.length === 14) {
    // CNPJ v√°lido
  } else {
    exibirErro('Insira o valor no par√¢metros &cpf=');
    return;
  }
  // Verifica a presen√ßa de dados obrigat√≥rios e Atualiza os elementos na p√°gina com os dados do PIX 
  if (pixkey !== '' && merchantName !== '' && merchantCity !== '') {

  limparParametros();
		   
  // Remove elementos da p√°gina e exibe o carregamento do QR Code
    $('.dados').remove('');
    $('#Carregando').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-pix.png" alt="">`);
    setTimeout(() => {  $('.qrcriado').show(); $('#Carregando').hide(); $('#desfocfundo').removeClass('overlay'); }, 1000);
  
   // L√≥gica para ocultar elementos se os par√¢metros n√£o estiverem presentes
  if (whatsapp === '') {
    document.getElementById('Botaowhat1').style.display = 'none';
    document.getElementById('Botaowhat2').style.display = 'none';
    document.getElementById('whatswidget-pre-wrapper').style.display = 'none';
  }
  if (idadaloja === '') {
    $('#Botaowhatpedido1').remove('');
    $('#Botaowhatpedido2').remove('');
  } else {
      $('#copiarchavepix').remove('');
      $('.titulo-chave-pix').remove('');
  }
  if (voltar === '') {
    document.getElementById('BotaoVoltar1').style.display = 'none';
    document.getElementById('BotaoVoltar2').style.display = 'none';
  }     
  
  if (/^(0+|00[.,]00|0[.,]00)$/.test(amount.replace(/[^\d,.]/g, '')) || amount.replace(/[^\d,.]/g, '') === '') {		
    payload = QrCodePix(pixkey, description, merchantName, merchantCity, txid, '');
    document.getElementById('valor').textContent = 'R$ 00,00';
    document.getElementById('valor1').textContent = 'R$ 00,00';
    document.getElementById('valor2').textContent = 'R$ 00,00';
  } else {
   // Verifica se o valor j√° est√° no formato num√©rico desejado (sem a formata√ß√£o monet√°ria)
    if (/^\d+\.\d{2}$/.test(amount.replace(/[^\d,.]/g, ''))) {
    payload = QrCodePix(pixkey, description, merchantName, merchantCity, txid, amount.replace(/[^\d,.]/g, ''));
    document.getElementById('valor').textContent = formatarReal(amount);
    document.getElementById('valor1').textContent = formatarReal(amount);
    document.getElementById('valor2').textContent = formatarReal(amount);
    } else {
    amount = parseFloat(amount.replace(/[^\d,.]/g, '').replace(/\./g, '').replace(',', '.'));
    payload = QrCodePix(pixkey, description, merchantName, merchantCity, txid, amount.toFixed(2));
    document.getElementById('valor').textContent = formatarReal(amount.toFixed(2));
    document.getElementById('valor1').textContent = formatarReal(amount.toFixed(2));
    document.getElementById('valor2').textContent = formatarReal(amount.toFixed(2));
    }
  }
   CriarQRCode(payload, minhalogo, personalizationOptions);
    document.getElementById('qrpix').textContent = payload;
    document.getElementById('chave').textContent = pixkey;
    document.getElementById('beneficiario').textContent = merchantName;
    document.getElementById('descricao').textContent = description;
    document.getElementById('identificador').textContent = txid;
    document.getElementById('banco-do-beneficiario').textContent = banco;	          
    document.getElementById('whatsapp').textContent = whatsapp;
    document.getElementById('nome1').textContent = merchantName;
    document.getElementById('nome2').textContent = merchantName;
    document.getElementById('nome3').textContent = merchantName;
    document.getElementById('nome4').textContent = merchantName;
    document.getElementById('voltar').textContent = voltar;
    
    // L√≥gica para exibir informa√ß√µes opcionais na p√°gina
  if (txid === '') {
  document.getElementById('infor-none').style.display = 'none';
  } else {
  document.getElementById('infor').textContent = txid;
  }
  if (description === '') {
  document.getElementById('mensagem-none').style.display = 'none';
  } else {
  document.getElementById('mensagem').textContent = description;
  }
   // Formata o CPF ou CNPJ, se presente, e atualiza os elementos correspondentes
  if (cpf.length === 11) {
        const cpfFormatado = formatarCPF(cpf);
        document.getElementById('cpf').textContent = cpfFormatado;
        document.getElementById('cpf-cnpj').textContent = 'CPF';
  } else if (cpf.length === 14) {
        const cnpjFormatado = formatarCNPJ(cpf);
        document.getElementById('cpf').textContent = cnpjFormatado;
        document.getElementById('cpf-cnpj').textContent = 'CNPJ';
  } else {
        document.getElementById('cpf').textContent = 'N/A';
        document.getElementById('cpf-cnpj').textContent = 'CPF OU CNPJ';
  }

  if (minhalogo === '') {
        document.getElementById('minhalogo').style.display = 'none';
  } else { 
        var imagemContainer = document.getElementById('minhalogo');
        var imagemElemento = document.createElement('img');
        imagemElemento.setAttribute('src', 'pagamentos.files/imagens/logo.png');
        imagemElemento.setAttribute('width', '200');
        imagemElemento.setAttribute('height', '200');
        imagemContainer.appendChild(imagemElemento);
  }
  if (idadaloja) {
      const dadosDoPedido = obterDadosDoPedidoPorId(iddopagamento, idadaloja);
  const produtos = dadosDoPedido.produtos;
        pedidowhatsapp = dadosDoPedido.pedidowhatsapp;

        const items = JSON.parse(produtos);
        const itemList = document.getElementById('itemList');
        const container = document.getElementById('container');
        const h1 = document.createElement('strong');

        h1.classList.add("titulo-chave-pix");
        h1.textContent = "Produtos do Pedido:";
        container.insertBefore(h1, itemList);

if (Number(dadosDoPedido.subtotal) > 0) {
  const spansubtotal = document.createElement('strong');
  spansubtotal.classList.add("valor-pedido", "valor-subtotal");
  spansubtotal.textContent = "Subtotal: " + formatarReal(dadosDoPedido.subtotal);
  container.appendChild(spansubtotal);
}

if (Number(dadosDoPedido.desconto) > 0) {
  const spandesconto = document.createElement('strong');
  spandesconto.classList.add("valor-pedido", "valor-desconto");
  spandesconto.textContent = "Desconto: - " + formatarReal(dadosDoPedido.desconto);
  container.appendChild(spandesconto);
}


if (Number(dadosDoPedido.deliveryFee) > 0) {
  const spandelivery = document.createElement('strong');
  spandelivery.classList.add("valor-pedido", "valor-entrega");
  spandelivery.textContent = "Entrega: + " + formatarReal(dadosDoPedido.deliveryFee);
  container.appendChild(spandelivery);
}
    document.getElementById('valor2').textContent = "Total: " + formatarReal(dadosDoPedido.total);
            items.forEach(item => {
              const li = document.createElement('li');
              li.innerHTML = `
                  <img src="${encodeURI(item.imageUrl)}" alt="${item.name}"> 
                  ${item.name} (Qtd: ${item.quantity}) 
                  ${item.selectedSize ? `(Tamanho: ${item.selectedSize})` : ''} 
                  ${item.selectedsabor ? `(Sabor: ${item.selectedsabor})` : ''} 
                  - ${formatarReal(item.price.toFixed(2))}
              `;
                itemList.appendChild(li);
            });
  } else {
    $('#container').remove('');
  }

   } else {
     // Em caso de erro, gera um QR Code de erro
    const code = 'erro';
    new QRCodeStyling({
      width: 270,
      height: 270,
      data: code,
      image: 'pagamentos.files/imagens/error.png',
      dotsOptions: { color: '#ff0000' },
      backgroundOptions: { color: '#ffffff00' },
      imageOptions: {
        crossOrigin: "anonymous",
        imageSize: 0.5,
        margin: 5
      }
    }).append(document.getElementById('qr-code'));
}

});

// ===================================================================
// --- FUN√á√ïES DE GERA√á√ÉO DE QR CODE ATUALIZADAS ---
// ===================================================================
function buildQrOptions(payload, minhalogo, personalizationOptions = {}) {
    const defaultOptions = {
        height: 270,
        data: payload,
        image: minhalogo || undefined,
        dotsOptions: { type: "rounded", color: "#fff" },
        backgroundOptions: { color: "#ffffff00" },
        imageOptions: { crossOrigin: "anonymous", imageSize: 0.2, margin: 3 },
        cornersSquareOptions: { type: "extra-rounded", color: "#fff" },
        cornersDotOptions: { type: undefined }
        
    };
	
	const options = {...defaultOptions};

    if (personalizationOptions && Object.keys(personalizationOptions).length > 0 && personalizationOptions.qr_shape) {
        options.dotsOptions.type = personalizationOptions.qr_shape;
		
		const mainCornerType = personalizationOptions.qr_corner_shape;
		if(mainCornerType === 'dot'){
			options.cornersDotOptions.type = 'dot';
			options.cornersSquareOptions.type = undefined;
		} else {
			options.cornersSquareOptions.type = mainCornerType || 'extra-rounded';
			options.cornersDotOptions.type = undefined;
		}
		
        const gradientType = personalizationOptions.qr_gradient_type;
        const color1 = personalizationOptions.qr_color1;
        const color2 = personalizationOptions.qr_color2;
        const rotation = parseFloat(personalizationOptions.qr_rotation || 0) * (Math.PI / 180);

        if (gradientType && gradientType !== 'none' && color2) {
            options.dotsOptions.gradient = {
                type: gradientType,
                rotation: rotation,
                colorStops: [{ offset: 0, color: color1 }, { offset: 1, color: color2 }]
            };
            options.dotsOptions.color = undefined;
        } else {
            options.dotsOptions.color = color1 || "#fff";
            options.dotsOptions.gradient = undefined;
        }
		
		if (personalizationOptions.qr_use_corner_colors === 'yes'){
			const cornerGradientType = personalizationOptions.qr_corner_gradient_type;
			const cornerColor1 = personalizationOptions.qr_corner_color1;
			const cornerColor2 = personalizationOptions.qr_corner_color2;
			const cornerRotation = parseFloat(personalizationOptions.qr_corner_rotation || 0) * (Math.PI / 180);

			let cornerOptions = {};
			if(cornerGradientType && cornerGradientType !== 'none' && cornerColor2){
				cornerOptions.gradient = {
					type: cornerGradientType,
					rotation: cornerRotation,
					colorStops: [{ offset: 0, color: cornerColor1 }, { offset: 1, color: cornerColor2 }]
				};
                cornerOptions.color = undefined;
			} else {
				cornerOptions.color = cornerColor1 || "#fff";
                cornerOptions.gradient = undefined;
			}
			options.cornersSquareOptions = {...options.cornersSquareOptions, ...cornerOptions};
			options.cornersDotOptions = {...options.cornersDotOptions, ...cornerOptions};
		} else {
			options.cornersSquareOptions.color = undefined;
			options.cornersDotOptions.color = undefined;
			options.cornersSquareOptions.gradient = undefined;
			options.cornersDotOptions.gradient = undefined;
		}
    }
    
    return options;
}

function CriarQRCode(payload, minhalogo, personalizationOptions = {}) {
    const container = document.getElementById('qr-code');
    if (container) container.innerHTML = "";

    const options = buildQrOptions(payload, minhalogo, personalizationOptions, 260);
    const qrCode = new QRCodeStyling(options);
    
    if(container) qrCode.append(container);
}

function GeraQRCodePix(payload, minhalogo, personalizationOptions = {}) {
    const container = document.getElementById('qr-minha-venda');
    if (!container) return;
    
    container.innerHTML = "";

    const options = buildQrOptions(payload, minhalogo, personalizationOptions, 270);
    const qrCode = new QRCodeStyling(options);
    
    qrCode.append(container);
}

// Fun√ß√£o para exibir os links salvos na tela
function mostrarLinks() {
  const listaLinks = document.getElementById('lista-links');
  listaLinks.innerHTML = ''; // Limpa a lista de links existente

  const links = JSON.parse(localStorage.getItem('links')) || []; // Obt√©m os links do localStorage
  links.reverse(); // Inverte a ordem dos links para exibir os mais recentes primeiro

  if (links.length > 0) { // Se houver links armazenados
    // Cria abas para cada grupo de 10 links
    const numAbas = Math.ceil(links.length / 10); // Calcula o n√∫mero de abas necess√°rias

    // Cria as abas
    for (let i = 0; i < numAbas; i++) {
      const aba = document.createElement('div'); // Cria uma nova aba
      aba.classList.add('aba'); // Adiciona a classe 'aba'
      aba.id = `aba-${i + 1}`; // Define o ID da aba

      // Cria um t√≠tulo para a aba
      const tituloAba = document.createElement('h3');
      tituloAba.textContent = `Lista pix ${i + 1}`;
      aba.appendChild(tituloAba);

      // Adiciona os links √† aba
      for (let j = i * 10; j < (i + 1) * 10 && j < links.length; j++) {
        const itemLista = document.createElement('li'); // Cria um novo item de lista
        itemLista.classList.add('links-style'); // Adiciona a classe 'links-style'

        const linkItem = document.createElement('span'); // Cria um novo elemento span para o link
        linkItem.classList.add('link-item'); // Adiciona a classe 'link-item'
        linkItem.textContent = links[j].titulo; // Define o texto do link como o t√≠tulo do item
        linkItem.classList.add('link-title'); // Adiciona a classe 'link-title'

        const linkActions = document.createElement('div'); // Cria um novo elemento div para as a√ß√µes do link
        linkActions.classList.add('link-actions'); // Adiciona a classe 'link-actions'

        // Bot√£o para abrir o link
        const btnAbrir = document.createElement('button');
        btnAbrir.textContent = 'Gerar';
        btnAbrir.classList.add('open-link');
        btnAbrir.onclick = function() {
          window.location.href = "?codepix=" + links[j].gerarPix; // Redireciona para o link
        };

        // Bot√£o para editar o link
        const btnEditar = document.createElement('button'); 
        btnEditar.textContent = 'Recria';
        btnEditar.classList.add('open-link');
        btnEditar.onclick = function() {
          window.location.href = links[j].editarPix; // Redireciona para o link
        };

        // Bot√£o para compartilhar o link
        const btnCompartilhar = document.createElement('button');
        btnCompartilhar.textContent = 'Compartilhar';
        btnCompartilhar.classList.add('share-link');
        
        btnCompartilhar.onclick = function() {
          document.getElementById('linkcodificador').value = links[j].compartilharPix; 
          document.getElementById('urlpix').value = links[j].paramschaves; 
          document.getElementById('salva-meu-pix').value = "https://meupix.github.io" + links[j].editarPix; 
          $('#mainContent').addClass('overlay'); 
          $('#compartilhar').show(); 
          $('#close-check').show(); 
          $('#CarregaCompartilhar').show(); 
          // Define o HTML do elemento 'CarregaCompartilhar'
          $('#CarregaCompartilhar').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-compartilhar.png" alt="">`); 
          GerarLinkCurto(links[j].compartilharPix, links[j].compartilharPix);
        };

      // Bot√£o de exclus√£o
      const btnExcluir = document.createElement('button');
      btnExcluir.textContent = 'Excluir';
      btnExcluir.classList.add('delete-link');
      btnExcluir.onclick = function() {
      excluirLink(links[j].titulo, i); // Chama a fun√ß√£o para excluir o link
      };

	  	const linkActions2 = document.createElement('div');
      linkActions2.classList.add('link-actions');

      const btnCriaPlaca = document.createElement('button');
      btnCriaPlaca.textContent = 'Cria Placa';
      btnCriaPlaca.classList.add('open-link');
      btnCriaPlaca.onclick = function() {
        window.location.href = "https://meupix.vercel.app/criarplaca?dadospix=" + links[j].gerarPix;
      };
	  
	    const btnCriaVenda = document.createElement('button');
      btnCriaVenda.textContent = 'Minhas Vendas';
      btnCriaVenda.classList.add('open-link');
      btnCriaVenda.onclick = function() {
        window.location.href = "?minhavenda=" + links[j].gerarPix;
      };

      const btnlojavirtual = document.createElement('button');
      btnlojavirtual.textContent = 'Criar Loja Virtual';
      btnlojavirtual.classList.add('open-link');
      btnlojavirtual.onclick = function() {
        window.location.href = "https://meupix.vercel.app/lojavirtual/criarconfig?dadospix=" + links[j].gerarPix;
      };

      linkActions.appendChild(btnAbrir);
      linkActions.appendChild(btnEditar);
	    linkActions.appendChild(btnCriaPlaca);
      linkActions.appendChild(btnlojavirtual);
      linkActions2.appendChild(btnCriaVenda);
      linkActions2.appendChild(btnCompartilhar);
      linkActions2.appendChild(btnExcluir);

      

	   
      // Adicionar os elementos √† lista
      itemLista.appendChild(linkItem);
      
      itemLista.appendChild(linkActions);
      itemLista.appendChild(linkActions2);
      aba.appendChild(itemLista); // Adiciona o item de lista √† aba
      }

      // Esconde as abas inicialmente
      aba.style.display = 'none';
      listaLinks.appendChild(aba); // Adiciona a aba √† lista de links
    }

    // Cria um elemento para conter os bot√µes de navega√ß√£o
    const botoesNavegacao = document.createElement('div');
    botoesNavegacao.classList.add('botoes-navegacao');

    // Adiciona o bot√£o "Anterior Aba" (invis√≠vel inicialmente)
    const botaoAnteriorAba = document.createElement('button');
    botaoAnteriorAba.textContent = 'Volta';
    botaoAnteriorAba.id = 'anterior-aba';
    botaoAnteriorAba.style.display = 'none'; // Oculta inicialmente
    botoesNavegacao.appendChild(botaoAnteriorAba); // Adiciona o bot√£o ao container

    // Adiciona o bot√£o "Pr√≥xima Aba"
    const botaoProximaAba = document.createElement('button');
    botaoProximaAba.textContent = 'Pr√≥xima';
    botaoProximaAba.id = 'proxima-aba';

    // Verifica se h√° mais de 10 links para mostrar o bot√£o
    if (links.length > 10) {
      botaoProximaAba.style.display = 'block';
    } else {
      botaoProximaAba.style.display = 'none';
    }

    botoesNavegacao.appendChild(botaoProximaAba); // Adiciona o bot√£o ao container

    // Adiciona o container dos bot√µes √† lista de links
    listaLinks.appendChild(botoesNavegacao);

    // Mostra a primeira aba
    const primeiraAba = document.getElementById('aba-1');
    primeiraAba.style.display = 'block';

    // Define as fun√ß√µes dos bot√µes de navega√ß√£o
    botaoAnteriorAba.onclick = function() {
      // Obt√©m a aba atual
      const abaAtual = document.querySelector('.aba[style*="display: block"]');

      // Encontra a aba anterior
      const abaAnterior = abaAtual.previousElementSibling;

      // Se houver uma aba anterior, exibe-a e esconde a atual
      if (abaAnterior) {
        abaAtual.style.display = 'none';
        abaAnterior.style.display = 'block';

        // Atualiza o estado dos bot√µes de navega√ß√£o
        if (abaAnterior.id === 'aba-1') {
          botaoAnteriorAba.style.display = 'none';
        }
        botaoProximaAba.style.display = 'block';
      }
    };

    botaoProximaAba.onclick = function() {
      // Obt√©m a aba atual
      const abaAtual = document.querySelector('.aba[style*="display: block"]');

      // Encontra a pr√≥xima aba
      const abaProxima = abaAtual.nextElementSibling;

      // Verifica se a pr√≥xima aba tem links
      if (abaProxima && abaProxima.querySelectorAll('li').length > 0) {
        // Se houver links na pr√≥xima aba, exibe-a e esconde a atual
        abaAtual.style.display = 'none';
        abaProxima.style.display = 'block';

        // Atualiza o estado dos bot√µes de navega√ß√£o
        if (abaProxima.id !== `aba-${numAbas}`) {
          botaoProximaAba.style.display = 'block';
        } else {
          botaoProximaAba.style.display = 'none';
        }
        botaoAnteriorAba.style.display = 'block';
      }
    }

  } else { // Se n√£o houver links armazenados
    const itemLista = document.createElement('div');
    itemLista.textContent = 'Sua lista est√° vazia...'; // Define o texto do item de lista
    listaLinks.appendChild(itemLista); // Adiciona o item de lista √† lista de links
  }

  document.getElementById("desfocfundo").style.display = "";
  $('.qrcriado').hide();
  $('.dados').show();

  // Ocultar o formul√°rio e mostrar a lista de links
  $('#minhavenda').hide();
  $('.caixatex').hide(); // Oculta o elemento com a classe 'caixatex'
  $('#links-container').show(); // Exibe o elemento com o id 'links-container'
  limparParametros();
}

function voltarmeusalve() {
  mostrarLinks();
}

function excluirLink(titulo, abaIndex) {
  const links = JSON.parse(localStorage.getItem('links')) || [];
  const novoLinks = links.filter(link => link.titulo !== titulo);
  localStorage.setItem('links', JSON.stringify(novoLinks));
  const numAbas2 = Math.ceil(links.length / 10);
  
  for (let i = 0; i < numAbas2; i++) {
    atualizarAba(i);
  }
  
  atualizarBotoesNavegacao(abaIndex);

  // Exibe mensagem de sucesso
  document.getElementById('Error').innerText = titulo + ', excluido com sucesso!';
  const modal = document.getElementById('modal');
  modal.style.display = 'flex';
  setTimeout(() => {  modal.style.display = 'none';  }, 1500);
}

function atualizarBotoesNavegacao(abaIndex) {
  const links = JSON.parse(localStorage.getItem('links')) || [];
  const numAbas = Math.ceil(links.length / 10);
  
  const proximaAba = document.getElementById('proxima-aba');
  const anteriorAba = document.getElementById('anterior-aba');

  // Define a visibilidade dos bot√µes "Pr√≥xima" e "Anterior"
  proximaAba.style.display = (numAbas > abaIndex + 1) ? 'block' : 'none';
  anteriorAba.style.display = (abaIndex > 0) ? 'block' : 'none';

  // Verifica se a pr√≥xima aba tem links
  const abaAtual = document.getElementById(`aba-${abaIndex + 1}`); // Obt√©m a pr√≥xima aba

  if (abaAtual && abaAtual.querySelectorAll('li').length === 0) {
      // Se estiver vazia, volta para a aba anterior
    const abaAnterior = abaAtual.previousElementSibling;
    if (abaAnterior) {
      abaAtual.style.display = 'none';
      abaAnterior.style.display = 'block';
      abaIndex--; // Decrementa o √≠ndice da aba atual
    }
	  // Define a visibilidade dos bot√µes "Pr√≥xima" e "Anterior"
    proximaAba.style.display = (numAbas > abaAtual) ? 'block' : 'none';
  anteriorAba.style.display = (abaIndex > 0) ? 'block' : 'none';
  } else {
  if (abaAtual.querySelectorAll('li').length === 0) {
    // Se estiver vazia, volta para a aba anterior
    const abaAnterior = abaAtual.previousElementSibling;
    if (abaAnterior) {
      abaAtual.style.display = 'none';
      abaAnterior.style.display = 'block';
    }
	  // Define a visibilidade dos bot√µes "Pr√≥xima" e "Anterior"
	    proximaAba.style.display = (numAbas > abaAtual) ? 'block' : 'none';
  anteriorAba.style.display = (abaIndex > 0) ? 'block' : 'none';
  }
}
  
  proximaAba.onclick = function() {
      // Obt√©m a aba atual
      const abaAtual = document.querySelector('.aba[style*="display: block"]');

      // Encontra a pr√≥xima aba
      const abaProxima = abaAtual.nextElementSibling;

      // Verifica se a pr√≥xima aba tem links
      if (abaProxima && abaProxima.querySelectorAll('li').length > 0) {
        // Se houver links na pr√≥xima aba, exibe-a e esconde a atual
        abaAtual.style.display = 'none';
        abaProxima.style.display = 'block';

        // Atualiza o estado dos bot√µes de navega√ß√£o
        if (abaProxima.id !== `aba-${numAbas}`) {
          proximaAba.style.display = 'block';
        } else {
          proximaAba.style.display = 'none';
        }
        anteriorAba.style.display = 'block';
      }
    }
 }

// Fun√ß√£o para atualizar a aba atual
function atualizarAba(abaIndex) {
  const aba = document.getElementById(`aba-${abaIndex + 1}`);
  aba.innerHTML = '';

  const tituloAba = document.createElement('h3');
  tituloAba.textContent = `Lista Pix ${abaIndex + 1}`;
  aba.appendChild(tituloAba);

  const links = JSON.parse(localStorage.getItem('links')) || [];
  links.reverse();

  if (links.length > 0) {
    for (let j = abaIndex * 10; j < (abaIndex + 1) * 10 && j < links.length; j++) {
      const itemLista = document.createElement('li');
      itemLista.classList.add('links-style');

      const linkItem = document.createElement('span');
      linkItem.classList.add('link-item');
      linkItem.textContent = links[j].titulo;
      linkItem.classList.add('link-title');

      const linkActions = document.createElement('div');
      linkActions.classList.add('link-actions');

      const btnAbrir = document.createElement('button');
      btnAbrir.textContent = 'Gerar';
      btnAbrir.classList.add('open-link');
      btnAbrir.onclick = function() {
        window.location.href = "?codepix=" + links[j].gerarPix;
      };

      const btnEditar = document.createElement('button');
      btnEditar.textContent = 'Recria';
      btnEditar.classList.add('open-link');
      btnEditar.onclick = function() {
        window.location.href = links[j].editarPix;
      };

      const btnCompartilhar = document.createElement('button');
      btnCompartilhar.textContent = 'Compartilhar';
      btnCompartilhar.classList.add('share-link');

      btnCompartilhar.onclick = function() {
        document.getElementById('linkcodificador').value = links[j].compartilharPix;
        document.getElementById('urlpix').value = links[j].paramschaves;
        document.getElementById('salva-meu-pix').value = "https://meupix.github.io" + links[j].editarPix;
        $('#mainContent').addClass('overlay');
        $('#compartilhar').show();
        $('#close-check').show();
        $('#CarregaCompartilhar').show();
        $('#CarregaCompartilhar').html(`<img class="CarrengandoQR" src="pagamentos.files/imagens/loading-compartilhar.png" alt="">`);
        GerarLinkCurto(links[j].compartilharPix, links[j].compartilharPix);
      };
	  
      const btnExcluir = document.createElement('button');
      btnExcluir.textContent = 'Excluir';
      btnExcluir.classList.add('delete-link');
      btnExcluir.onclick = function() {
        excluirLink(links[j].titulo, abaIndex);
      };

      const linkActions2 = document.createElement('div');
      linkActions2.classList.add('link-actions');
      const btnCriaPlaca = document.createElement('button');
      btnCriaPlaca.textContent = 'Cria Placa';
      btnCriaPlaca.classList.add('open-link');
      btnCriaPlaca.onclick = function() {
        window.location.href = "https://meupix.vercel.app/criarplaca?dadospix=" + links[j].gerarPix;
      };

      const btnCriaVenda = document.createElement('button');
      btnCriaVenda.textContent = 'Minhas Vendas';
      btnCriaVenda.classList.add('open-link');
      btnCriaVenda.onclick = function() {
        window.location.href = "?minhavenda=" + links[j].gerarPix;
      };

      const btnlojavirtual = document.createElement('button');
      btnlojavirtual.textContent = 'Criar Loja Virtual';
      btnlojavirtual.classList.add('open-link');
      btnlojavirtual.onclick = function() {
        window.location.href = "https://meupix.vercel.app/lojavirtual/criarconfig?dadospix=" + links[j].gerarPix;
      };

      linkActions.appendChild(btnAbrir);
      linkActions.appendChild(btnEditar);
	    linkActions.appendChild(btnCriaPlaca);
      linkActions.appendChild(btnlojavirtual);
      linkActions2.appendChild(btnCriaVenda);
      linkActions2.appendChild(btnCompartilhar);
      linkActions2.appendChild(btnExcluir);

      itemLista.appendChild(linkItem);
      itemLista.appendChild(linkActions);
      itemLista.appendChild(linkActions2);
      aba.appendChild(itemLista); 
    }
  } else {
    const itemLista = document.createElement('div');
    itemLista.textContent = 'Sua lista est√° vazia...';
    aba.appendChild(itemLista);
  }
}

function limparUploadlogo() {
    var input = document.getElementById('imagem-upload-logo-qr');
    input.value = ''; // Limpa o valor do campo de upload
	var clearlink = document.getElementById('upload-logo-qr');
	clearlink.style.display = 'none'; // Esconder o bot√£o
}

function limparUpload() {
    var input = document.getElementById('imagem-upload');
    input.value = ''; // Limpa o valor do campo de upload
	var clearlink = document.getElementById('clear-upload');
	clearlink.style.display = 'none'; // Esconder o bot√£o
  verificarUpload();
}

function limparLink() {
    var input = document.getElementById('link-imagem');
    input.value = ''; // Limpa o valor do campo de texto
	var clearupload = document.getElementById('clear-link');
	clearupload.style.display = 'none'; // Esconder o bot√£o
  verificarUpload(); // Mostrar cor do fundo
}

function verificarUpload() {
    var inputlogoqr = document.getElementById('imagem-upload-logo-qr');
    var clearlogoqr = document.getElementById('upload-logo-qr');

    var corfundoplaca = document.getElementById('cor-fundo-placa');
    var inputimagem = document.getElementById('link-imagem');
    var clearupload = document.getElementById('clear-link');

    var inputlink = document.getElementById('imagem-upload');
    var clearlink = document.getElementById('clear-upload');

    // Exibir ou ocultar bot√£o de limpar logo QR
    clearlogoqr.style.display = inputlogoqr.value ? 'block' : 'none';

    // Exibir ou ocultar bot√£o de limpar imagem e verificar fundo da placa
    clearupload.style.display = inputimagem.value ? 'block' : 'none';
    clearlink.style.display = inputlink.value ? 'block' : 'none';

    // Se qualquer um dos inputs de imagem estiver preenchido, esconder cor-fundo-placa
    if (inputimagem.value || inputlink.value) {
        corfundoplaca.style.display = 'none';
    } else {
        corfundoplaca.style.display = 'block';
    }
}

async function compartilharPlcaGerada() {
  var paymentInfoSection = document.getElementById('qr-data-placa');
  var today = new Date();
  var date = today.toISOString().slice(0, 10);
  var time = today.toTimeString().slice(0, 8);
  var dateTime = date + '_' + time.replace(/:/g, '-');

  html2canvas(paymentInfoSection, {
    scale: 2, // Aumenta a resolu√ß√£o da captura
    useCORS: true // Habilita o uso de CORS para evitar problemas com imagens de outras origens
  }).then(function(canvas) {
    canvas.toBlob(function(blob) {
      var file = new File([blob], `Placa_Pix_${dateTime}.png`, { type: 'image/png' });

      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        navigator.share({
          files: [file],
          title: 'Placa Pix',
          text: 'Minha Placa Pix:'
        }).then(() => {
          console.log('Compartilhamento bem-sucedido!');
        }).catch((error) => {
          console.error('Erro ao compartilhar:', error);
        });
      } else {
        alert('A API de compartilhamento da Web n√£o √© suportada neste navegador.');
      }
    });
  });
}

function BaixaPlacaPix() {
    var paymentInfoSection = document.getElementById('qr-data-placa');
    var today = new Date();
    var date = today.toISOString().slice(0, 10);
    var time = today.toTimeString().slice(0, 8);
    var dateTime = date + '_' + time.replace(/:/g, '-');
    html2canvas(paymentInfoSection, {
        scale: 2, // Aumenta a resolu√ß√£o da captura
        useCORS: true // Habilita o uso de CORS para evitar problemas com imagens de outras origens
    }).then(function(canvas) {
        var image = canvas.toDataURL('image/png'); // Converte o conte√∫do do canvas para uma URL de dados no formato PNG

        // Cria um link tempor√°rio para download
        var link = document.createElement('a');
        link.href = image;
        link.download = 'placa-pix-' + dateTime + '.png'; // Nome do arquivo que ser√° baixado

        // Adiciona o link ao documento, clica nele e remove-o em seguida
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });
}

function exibirErro(mensagem) {
  document.getElementById('Error').innerText = mensagem;
  const modal = document.getElementById('modal');
  modal.style.display = 'flex';
}

function fechalinks() {
  $('#links-container').hide();
  $('.caixatex').show();
}

 // Limpa os par√¢metros da URL
function limparParametros() {
  const url = window.location.href.split('?')[0];
  window.history.replaceState({}, document.title, url);
}

function QrCodePix(pixkey, description, merchantName, merchantCity, txid, amount) {
   const ChaveDescription = generateKey(pixkey, description);
    const payload = ['000201', ChaveDescription, '520400005303986'];

    if (amount) {
        payload.push(genEMV('54', amount));
    }

    merchantName = merchantName.substring(0, 25).toUpperCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    merchantCity = merchantCity.substring(0, 15).toUpperCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');

    payload.push('5802BR' + genEMV('59', merchantName) + genEMV('60', merchantCity));

    if (txid) {
        payload.push(genEMV('62', genEMV('05', txid)) + '6304');
    }else {
	 payload.push('62070503***6304');
	}

    const pixgerado = payload.join('') + getCRC16(payload.join(''));
    return pixgerado;
}

function generateKey(pixkey, description) {
    const GovEchave = '0014BR.GOV.BCB.PIX' + genEMV('01', pixkey);
    if (description) {
		return genEMV('26', GovEchave + genEMV('02', description));
    } else {
	return genEMV('26', GovEchave);
	}
}

function genEMV(id, parameter) {
    const len = String(parameter.length).padStart(2, "0");
    return id + len + parameter;
}

function getCRC16(payload) {
    const polinomio = 0x1021;
    let resultado = 0xffff;

    const length = payload.length;
    for (let offset = 0; offset < length; offset++) {
        resultado ^= ord(payload[offset]) << 8;
        for (let bitwise = 0; bitwise < 8; bitwise++) {
            if ((resultado <<= 1) & 0x10000) resultado ^= polinomio;
            resultado &= 0xffff;
        }
    }
    return resultado.toString(16).toUpperCase().padStart(4, '0');
}

function ord(char) {
    return char.charCodeAt(0);
}

document.addEventListener("DOMContentLoaded", atualizarManifestoPWA);

// --- GERADOR DE MANIFESTO PWA PERSONALIZADO (LINK DIRETO) ---
function atualizarManifestoPWA() {
    const linkEl = document.getElementById('dynamic-manifest');
    if (!linkEl) return;
    
    // ALTERA√á√ÉO AQUI: Usamos o href completo, sem limpar os par√¢metros (?)
    // Isso garante que o PWA abra exatamente no link que voc√™ est√° acessando agora
    const currentUrl = window.location.href;
    
    const nomeApp = 'Meu Pix';
    
    // Mant√©m a corre√ß√£o da URL absoluta para a imagem para n√£o dar erro
    const iconeApp = 'https://meupix.github.io/pagamentos.files/imagens/favicon.png';

    const manifest = {
        "name": nomeApp,
        "short_name": nomeApp.substring(0, 12),
        "start_url": currentUrl, // O app vai abrir neste link espec√≠fico
        "display": "standalone",
        "background_color": "#ffffff",
        "theme_color": "#ffa200e0",
        "orientation": "portrait",
        "icons": [
            {
                "src": iconeApp,
                "sizes": "192x192",
                "type": "image/png",
                "purpose": "any maskable"
            },
            {
                "src": iconeApp,
                "sizes": "512x512",
                "type": "image/png",
                "purpose": "any maskable"
            }
        ]
    };

    // Transforma o objeto JSON em um arquivo Blob (Arquivo virtual)
    const stringManifest = JSON.stringify(manifest);
    const blob = new Blob([stringManifest], {type: 'application/json'});
    const manifestURL = URL.createObjectURL(blob);
    
    // Atualiza a tag no HTML
    linkEl.setAttribute('href', manifestURL);
    
    // Atualiza tamb√©m a meta tag da Apple
    const appleTitle = document.querySelector('meta[name="apple-mobile-web-app-title"]');
    if (appleTitle) appleTitle.setAttribute("content", nomeApp);
}

function formatPhoneWithCountryCode(value) {
    if (!value) return '';

    // Extrai apenas os d√≠gitos do valor completo
    let numbers = value.replace(/\D/g, '');

    // Se o usu√°rio digitou '55' no in√≠cio, removemos para evitar duplicidade
    if (numbers.startsWith('55')) {
        numbers = numbers.substring(2);
    }
    
    // Limita ao tamanho m√°ximo de um n√∫mero brasileiro (DDD + 9 d√≠gitos)
    if (numbers.length > 11) {
        numbers = numbers.substring(0, 11);
    }

    // Aplica a m√°scara de formata√ß√£o
    let formatted = numbers;
    if (numbers.length > 10) { // Celular com 9¬∫ d√≠gito
        formatted = numbers.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
    } else if (numbers.length > 6) {
        formatted = numbers.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
    } else if (numbers.length > 2) {
        formatted = numbers.replace(/(\d{2})(\d{1,4})/, '($1) $2');
    } else if (numbers.length > 0) {
        formatted = numbers.replace(/(\d*)/, '($1');
    }

    // Retorna sempre com o +55 no in√≠cio se houver algum n√∫mero
    return numbers.length > 0 ? `+55 ${formatted}` : '';
}

function detectarTipoChave(chave) {
    if (!chave) return 'aleatoria';
    const chaveLimpa = chave.trim();
    if (chaveLimpa.includes('@')) {
        return 'email';
    }
    const numeros = chaveLimpa.replace(/\D/g, '');
    if (numeros.length === 10 || (numeros.length > 11 && numeros.startsWith('55'))) {
        return 'celular';
    }
    if (numeros.length === 14) {
        return 'cnpj';
    }
    if (numeros.length === 11) {
        return 'cpf';
    }
    return 'aleatoria';
}

function initPixFormatters() {
    // PARTE 1: CHAVE PIX
    const keyTypeSelector = document.getElementById('ChavesSelector');
    const pixKeyInput = document.getElementById('pixkey');
    const pixKeyLabel = document.getElementById('pixKeyLabel');
    if (keyTypeSelector && pixKeyInput && pixKeyLabel) {
        const keyTypeSettings = {
            'celular': { label: 'Chave Pix (Telefone) <b class="infor">*</b>', placeholder: '+55 (11) 90000-0000', maxlength: 20, type: 'tel', formatter: formatPhoneWithCountryCode },
            'email': { label: 'Chave Pix (Email) <b class="infor">*</b>', placeholder: 'seu-email@provedor.com', maxlength: 77, type: 'email', formatter: (value) => value.trim() },
            'cnpj': { label: 'Chave Pix (CNPJ) <b class="infor">*</b>', placeholder: '00.000.000/0000-00', maxlength: 18, type: 'tel', formatter: formatCNPJ },
            'cpf': { label: 'Chave Pix (CPF) <b class="infor">*</b>', placeholder: '000.000.000-00', maxlength: 14, type: 'tel', formatter: formatCPF },
            'aleatoria': { label: 'Chave Pix (Aleat√≥ria) <b class="infor">*</b>', placeholder: 'Sua chave aleat√≥ria (UUID)', maxlength: 36, type: 'text', formatter: (value) => value.trim() }
        };
        initPixFormatters.settings = keyTypeSettings;
        const updateInputForType = (type) => { 
            const settings = keyTypeSettings[type];
             if (!settings) return;
              pixKeyLabel.innerHTML = settings.label;
               pixKeyInput.placeholder = settings.placeholder;
                pixKeyInput.maxLength = settings.maxlength;
                 pixKeyInput.type = settings.type;
                 };

        keyTypeSelector.addEventListener('change', (e) => {
             updateInputForType(e.target.value);
              if (e.isTrusted) { 
                pixKeyInput.value = '';
                 pixKeyInput.focus();
                 } 
                });

        pixKeyInput.addEventListener('focus', function() {
             if (keyTypeSelector.value === 'celular' && this.value === '') this.value = '+55 ';
        });

        pixKeyInput.addEventListener('blur', function() {
             if (this.value.trim() === '') return;
             const currentType = keyTypeSelector.value;
             const settings = keyTypeSettings[currentType];
             if (settings && settings.formatter) {
             this.value = settings.formatter(this.value);
             }
        });

        pixKeyInput.addEventListener('input', function() {
             if (this.value.trim() === '') return;
             const currentType = keyTypeSelector.value;
             const settings = keyTypeSettings[currentType];
             if (settings && settings.formatter) {
             this.value = settings.formatter(this.value);
             }
        });

        pixKeyInput.addEventListener('input', function() {
             if (this.value.trim() === '' || (keyTypeSelector.value === 'celular' && this.value.trim() === '+55')) {
             this.value = ''; 
             return; 
             }
             const currentType = keyTypeSelector.value;
             const settings = keyTypeSettings[currentType];
             if (settings && settings.formatter) this.value = settings.formatter(this.value);
        });

        updateInputForType(keyTypeSelector.value);
    }
}

  function formatchavepix(raw) { // Fun√ß√£o corrigida e aprimorada
    if (!raw) return '';
    const v = raw.trim();
    // 1. Chave Aleat√≥ria (UUID)
    if (/^[a-f0-9-]{32,36}$/i.test(v)) {
        return v.toLowerCase();
    }
    // 2. E-mail
    if (v.includes('@')) {
        return v.toLowerCase();
    }

    // 3. Telefone (come√ßa com '+', '(', ou tem muitos espa√ßos/h√≠fens)
    if (v.includes('55')) {
    return '+' + v.replace(/\D+/g, '');
    } 

    // 4. CPF ou CNPJ (cont√©m apenas n√∫meros, pontos, tra√ßos ou barras)
    if (/^[\d.\-\/]+$/.test(v)) {
        // Remove tudo que n√£o for d√≠gito para obter o valor puro
        return v.replace(/\D/g, '');
    }

    // 5. Fallback: se n√£o corresponder a nenhum padr√£o, retorna o valor limpo
    return v;
}


function formatCPF(value) {
    const numbers = value.replace(/\D/g, '');
    if (numbers.length <= 11) {
        return numbers
            .replace(/(\d{3})(\d)/, '$1.$2')
            .replace(/(\d{3})(\d)/, '$1.$2')
            .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
    }
    return formatCNPJ(value);
}

function formatarChavePix(chave) {
    if (!chave) return '';

    // 1. E-mail: n√£o precisa de formata√ß√£o
    if (chave.includes('@')) {
        return chave;
    }

    // 2. Telefone: Formata como (+55 XX XXXXX-XXXX)
    if (chave.startsWith('+55')) {
        const numeros = chave.substring(3); // Remove o '+55'
        return `+55 (${numeros.substring(0, 2)}) ${numeros.substring(2, 7)}-${numeros.substring(7)}`;
    }

    // 3. CPF (11 d√≠gitos) ou CNPJ (14 d√≠gitos)
    const numeros = chave.replace(/\D/g, '');
    if (numeros.length === 11) return formatCPF(numeros);
    if (numeros.length === 14) return formatCNPJ(numeros);

    // 4. Chave Aleat√≥ria ou outro tipo: retorna como est√°
    return chave;
}

function formatCNPJ(value) {
    const numbers = value.replace(/\D/g, '');
    return numbers
        .replace(/(\d{2})(\d)/, '$1.$2')
        .replace(/(\d{3})(\d)/, '$1.$2')
        .replace(/(\d{3})(\d)/, '$1/$2')
        .replace(/(\d{4})(\d{1,2})$/, '$1-$2');
}

function copiarchavepix() {
  var spanElement = document.getElementById('chave');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.textContent;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
}

function copiarqrpix() {
  var spanElement = document.getElementById('qrpix');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.textContent;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
}

function copiarLinkCurto() {
  var spanElement = document.getElementById('linkcurto');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.value;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
  
  document.getElementById('textocopiado').innerText = spanElement.value;
  document.getElementById('titulocopiado').innerText = 'Link curto Copiado.';
   telacopiado = document.getElementById('telacopiado');
   telacopiado.style.display = 'flex';
   setTimeout(() => {  telacopiado.style.display = 'none'; }, 2000);
}

function copiaplacagerada() { 
  var spanElement = document.getElementById('link-placa-gerada');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.value;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
  
  document.getElementById('textocopiaplacagerada').innerText = tempInput.value;
  document.getElementById('titulocopiaplacagerada').innerText = 'Link da placa pix Copiado.';
   telacopiado = document.getElementById('telacopiaplacagerada');
   telacopiado.style.display = 'flex';
   setTimeout(() => {  telacopiado.style.display = 'none'; }, 2000);
}

function copiameulinkpix() {
  var spanElement = document.getElementById('salva-meu-pix');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.value;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
  
  document.getElementById('textocopiado').innerText = spanElement.value;
  document.getElementById('titulocopiado').innerText = 'Link Salva seu pix Copiado.';
   telacopiado = document.getElementById('telacopiado');
   telacopiado.style.display = 'flex';
   setTimeout(() => {  telacopiado.style.display = 'none'; }, 2000);
}

function copiaLink() {
  var spanElement = document.getElementById('linkcodificador');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.value;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
  document.getElementById('textocopiado').innerText = spanElement.value;
  document.getElementById('titulocopiado').innerText = 'Link Pix Copiado.';
   telacopiado = document.getElementById('telacopiado');
   telacopiado.style.display = 'flex';
   setTimeout(() => {  telacopiado.style.display = 'none'; }, 2000);
}

function copiaurlpix() {
  var spanElement = document.getElementById('urlpix');
  var tempInput = document.createElement('input');
  tempInput.value = spanElement.value;
  document.body.appendChild(tempInput);
  tempInput.select();
  document.execCommand('copy');
  document.body.removeChild(tempInput);
  document.getElementById('textocopiado').innerText = spanElement.value;
  document.getElementById('titulocopiado').innerText = 'Link dos par√¢mentos Copiado.';
   telacopiado = document.getElementById('telacopiado');
   telacopiado.style.display = 'flex';
   setTimeout(() => {  telacopiado.style.display = 'none'; }, 2000);
}

function amount(input) { //R$ 325.325.232,53
    let valor = input.value.replace(/\D/g, '');
     valor = (parseFloat(valor) / 100).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
     valor = valor.toLocaleString('pt-BR');
     return input.value = valor;
}

function formatarReal(input) { //R$ 325.325.232,53
    valor = input.replace(/\D/g, '');
    valor = (parseFloat(valor) / 100).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    valor = valor.toLocaleString('pt-BR');
	return input.value = valor; 
}

function Voltar() {
const voltar = document.getElementById('voltar').textContent;
	    if (voltar === 'true') {
		  location.href ="#BotaoVoltarPix";
        } else {
         location.href = voltar;
    }
}

let pedidowhatsapp = '';

function EnviarPedido() {
 window.open(pedidowhatsapp, '_blank');
}

function EnviarComprovante() {
const whatsapp = document.getElementById('whatsapp').textContent;
        if (whatsapp === 'true') {
          location.href ="#BotaoEnviarComprovante";
          } else {
		 window.open("https://api.whatsapp.com/send?phone=" + encodeURIComponent(whatsapp) + "&text=Meu comprovante:", '_blank');
    }
}

function AbrirWhatsapp() {
const whatsapp = document.getElementById('whatsapp').textContent;
	    if (whatsapp === 'true') {
		  location.href ="#BotaoAbrirWhatsapp";
        } else {
         window.open("https://api.whatsapp.com/send?phone=" + encodeURIComponent(whatsapp), '_blank');
    }
}

function formatarDocumento(input) {
    let documento = input.value.replace(/\D/g, ''); 

    if (documento.length === 11) {
        documento = documento.replace(/^(\d{3})(\d{3})(\d{3})(\d{2})$/, '$1.$2.$3-$4');
    } else if (documento.length === 14) {
        documento = documento.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/, '$1.$2.$3/$4-$5');
    }
    input.value = documento;
}

function botaovolta(input) {
     volta = input.value;
	 
    if (volta === 't') {
    input.value = 'true';
        return;
    }
}

function formatarTelefone(input) {
     telefone = input.value;
	 
    if (telefone === 't') {
    input.value = 'true';
        return;
    }

    telefone = input.value.replace(/\D/g, '');	
    input.value = telefone;
}

function LinkCPF(cpf) {
  return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '000$2$300');
}

function formatarCPF(cpf) {
  return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '‚Ä¢‚Ä¢‚Ä¢.$2.$3-‚Ä¢‚Ä¢');
}

function formatarCNPJ(cnpj) {
  return cnpj.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
}

function fecharcopia() {
  $('#telacopiado').hide();
}

function backvolta() {
  location.reload();
}
		
async function GerarLinkCurto(linkpix, linkcodificador) {
	
    const ApiLinkCurto = 'https://linkpix.vercel.app/encurtar';
    const headers = { 'Content-Type': 'application/json' };
    const data = { originalUrl: linkpix };

    try {
        const response = await fetch(ApiLinkCurto, {
            method: 'POST',
            headers: headers,
            body: JSON.stringify(data)
        });
        const responseData = await response.json();

        if (responseData.shortUrl) {
		document.getElementById('linkcurto').value = responseData.shortUrl;
		setTimeout(() => { $('.StickyDemo').show(); $('#CarregaCompartilhar').hide();}, 1000);
        } else {
		document.getElementById('linkcurto').value = linkcodificador;
		setTimeout(() => { $('.StickyDemo').show(); $('#CarregaCompartilhar').hide();}, 1000);
        }
		} catch (error) {
		document.getElementById('linkcurto').value = linkcodificador;
		setTimeout(() => { $('.StickyDemo').show(); $('#CarregaCompartilhar').hide();}, 1000);
    }
}

function Compartilhamentos() {
    const linkpix = document.getElementById('linkcurto').value.trim();
    const texto = `Meu Pix: `;
        if (navigator.share) {
          navigator.share({ text: texto, url: linkpix });
        }
}

function LinkCurto() {
    const linkpix = document.getElementById('linkcodificador').value.trim();

    const ProxyApiLinkCurto = 'https://is.gd/create.php?format=json&url=' + encodeURIComponent(linkpix);

        fetch(ProxyApiLinkCurto)
        .then(response => response.json())
        .then(data => {
            if (data.shorturl) {
                const shortenedUrl = data.shorturl;
                copiarLinkEncurtado(shortenedUrl);
            } else {
                alert('Erro ao encurtar a URL. Tente novamente mais tarde.');
            }
        })
        .catch(error => {
            alert('Erro ao encurtar a URL. Tente novamente mais tarde.');
        });
}

function copiarLinkEncurtado(shortenedUrl) {
    const tempInput = document.createElement('input');
    tempInput.value = shortenedUrl;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand('copy');
    document.body.removeChild(tempInput);

    document.getElementById('textocopiado').innerText = shortenedUrl;
    document.getElementById('titulocopiado').innerText = 'Link Curto Copiado.';
    const telacopiado = document.getElementById('telacopiado');
    telacopiado.style.display = 'flex';
    setTimeout(() => { telacopiado.style.display = 'none'; }, 2000);
}

function fecharsalvapix() {
  $('#titulo').val('');
  $('#modal-salvapix').hide();
}

function fecharModal() {
  $('#modal').hide();
}

function fecharModalNomeAgendamento() {
  $('#modalagendamento').hide(); // Exibe o modal

$(window).click(function(event) {
    if ($(event.target).is('#modalagendamento')) {
        $('#modalagendamento').hide(); // Esconde o modal se clicar fora dele
    }
});
}

  function obterDadosDoPedidoPorId(idDoPedido, iddoblog) {
    const historicoJSON = localStorage.getItem(iddoblog);
    if (!historicoJSON) {
        console.error("Nenhum hist√≥rico de pedidos encontrado no localStorage.");
        return null;
    }
    try {
        const historicoDePedidos = JSON.parse(historicoJSON);
        const pedidoEncontrado = historicoDePedidos.find(pedido => pedido.id === idDoPedido);

        if (pedidoEncontrado) {
            return {
                produtos: pedidoEncontrado.produtos,
                pedidowhatsapp: pedidoEncontrado.pedidowhatsapp,
                desconto: pedidoEncontrado.desconto,
                subtotal: pedidoEncontrado.subtotal,
                deliveryFee: pedidoEncontrado.deliveryFee,
                total: pedidoEncontrado.total
            };
        } else {
            console.warn(`Pedido com ID "${idDoPedido}" n√£o encontrado.`);
            return null;
        }
    } catch (error) {
        console.error("Erro ao parsear o JSON do localStorage:", error);
        return null;
    }
}

function fechareditform() {
    $('#modal-editar').hide();
}

function compartilharlink(sociais) {
    const linkpix = document.getElementById('linkcurto').value;
    window.open(sociais + encodeURIComponent(linkpix), '_blank');
}

function closecompartilhar() {
    $('#mainContent').removeClass('overlay');
    $('.StickyDemo').hide();
    $('#compartilhar').hide(); // Exibe o modal
}
	  new ClipboardJS('#copy-qr');
      var copyQR = document.getElementById('copy-qr');
      copyQR.addEventListener('click', function () {
          copyQR.classList.add('copied-icon');
          copyQR.innerHTML = 'QR Copiado';
          setTimeout(function () {
              copyQR.classList.remove('copied-icon');
              copyQR.innerHTML = 'Copiar QR Code';
          }, 1000);
      });
	  
	  new ClipboardJS('#copy-chave');
      var copyChave = document.getElementById('copy-chave');
      copyChave.addEventListener('click', function () {
          copyChave.classList.add('copied-icon');
          copyChave.innerHTML = 'Chave Copiado';
          setTimeout(function () {
              copyChave.classList.remove('copied-icon');
              copyChave.innerHTML = 'Copiar Chave PIX';
          }, 1000);
      });

	var button = document.getElementById("whatswidget-button");
        button.addEventListener("click", openChat);
    var conversationMessageOuter = document.getElementById("whatswidget-conversation-message-outer");
        conversationMessageOuter.addEventListener("click", openChat);
    var chatOpen = !1;
function openChat() {
	    0 == chatOpen ? (document.getElementById("whatswidget-conversation").style.display = "block",
		document.getElementById("whatswidget-conversation").style.opacity = 100,
		chatOpen = !0,
		document.getElementById("whatswidget-conversation-message-outer").style.display = "none") : (document.getElementById("whatswidget-conversation").style.opacity = 0,
		document.getElementById("whatswidget-conversation").style.display = "none",
		chatOpen = !1)
}

</script>

</body>
</html>